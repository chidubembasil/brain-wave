<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrainWave Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* BrainWave Brand Colors */
            --primary-gradient: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            --primary-color: #1e3a8a;
            --primary-dark: #1e40af;
            --secondary-color: #3b82f6;
            --accent-color: #fbbf24;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --info-color: #3b82f6;
            
            /* Neutral Colors */
            --white: #ffffff;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            
            /* Spacing */
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-2xl: 3rem;
            
            /* Border Radius */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--gray-50);
            color: var(--gray-900);
            line-height: 1.6;
        }

        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background: var(--primary-gradient);
            color: var(--white);
            position: fixed;
            height: 100vh;
            left: 0;
            top: 0;
            z-index: 1000;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-xl);
        }

        .sidebar.collapsed {
            width: 80px;
        }

        .sidebar-header {
            padding: var(--spacing-xl);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            transition: opacity 0.3s ease;
        }

        .sidebar.collapsed .logo-text {
            opacity: 0;
            width: 0;
            overflow: hidden;
        }

        .sidebar-toggle {
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.25rem;
            cursor: pointer;
            padding: var(--spacing-sm);
            border-radius: var(--radius-md);
            transition: background 0.2s ease;
        }

        .sidebar-toggle:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .sidebar-nav {
            padding: var(--spacing-lg) 0;
        }

        .nav-item {
            margin: var(--spacing-xs) var(--spacing-md);
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md) var(--spacing-lg);
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            border-radius: var(--radius-lg);
            transition: all 0.2s ease;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .nav-link:hover::before {
            left: 100%;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
            transform: translateX(4px);
        }

        .nav-link.active {
            background: rgba(255, 255, 255, 0.15);
            color: var(--white);
            box-shadow: var(--shadow-md);
        }

        .nav-icon {
            width: 20px;
            text-align: center;
            font-size: 1.1rem;
        }

        .nav-text {
            transition: opacity 0.3s ease;
        }

        .sidebar.collapsed .nav-text {
            opacity: 0;
            width: 0;
            overflow: hidden;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            transition: margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--gray-50);
        }

        .sidebar.collapsed + .main-content {
            margin-left: 80px;
        }

        .top-bar {
            background: var(--white);
            padding: var(--spacing-lg) var(--spacing-xl);
            box-shadow: var(--shadow-sm);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--gray-700);
            font-size: 1.5rem;
            cursor: pointer;
            padding: var(--spacing-sm);
            border-radius: var(--radius-md);
            transition: all 0.2s ease;
        }

        .mobile-menu-btn:hover {
            background: var(--gray-100);
            color: var(--primary-color);
        }

        .page-title {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--gray-900);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .notification-btn {
            position: relative;
            background: none;
            border: none;
            color: var(--gray-500);
            font-size: 1.25rem;
            cursor: pointer;
            padding: var(--spacing-sm);
            border-radius: var(--radius-md);
            transition: all 0.2s ease;
        }

        .notification-btn:hover {
            background: var(--gray-100);
            color: var(--gray-700);
        }

        .notification-badge {
            position: absolute;
            top: 0;
            right: 0;
            width: 8px;
            height: 8px;
            background: var(--danger-color);
            border-radius: 50%;
        }
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s ease;
            position: relative;
        }

        .user-avatar:hover {
            transform: scale(1.05);
        }

        .user-dropdown {
            position: absolute;
            top: 50px;
            right: 0;
            background: var(--white);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            min-width: 200px;
            display: none;
            z-index: 1000;
            overflow: hidden;
        }

        .user-dropdown.show {
            display: block;
        }

        .user-dropdown-header {
            padding: 1rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--white);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .user-dropdown-header h4 {
            margin: 0;
            font-size: 0.95rem;
            font-weight: 600;
        }

        .user-dropdown-header p {
            margin: 0.25rem 0 0 0;
            font-size: 0.75rem;
            opacity: 0.9;
        }

        .user-dropdown-menu {
            padding: 0.5rem 0;
        }

        .user-dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--text-primary);
            text-decoration: none;
            transition: background 0.2s ease;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-size: 0.875rem;
        }

        .user-dropdown-item:hover {
            background: var(--hover-bg);
        }

        .user-dropdown-item i {
            font-size: 1rem;
            width: 20px;
            text-align: center;
        }

        .user-dropdown-divider {
            height: 1px;
            background: var(--border-color);
            margin: 0.5rem 0;
        }

        .content-area {
            padding: var(--spacing-xl);
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-xl);
            margin-bottom: var(--spacing-2xl);
        }

        .stat-card {
            background: var(--white);
            padding: var(--spacing-xl);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--gray-200);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary-gradient);
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }

        .stat-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--white);
        }

        .stat-icon.users { background: var(--info-color); }
        .stat-icon.content { background: var(--success-color); }
        .stat-icon.assessments { background: var(--accent-color); }
        .stat-icon.revenue { background: var(--primary-color); }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--gray-900);
            margin-bottom: var(--spacing-xs);
        }

        .stat-change {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .stat-change.positive {
            color: var(--success-color);
        }

        .stat-change.negative {
            color: var(--danger-color);
        }

        /* Charts and Analytics */
        .analytics-section {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: var(--spacing-xl);
            margin-bottom: var(--spacing-2xl);
        }

        .chart-card {
            background: var(--white);
            padding: var(--spacing-xl);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--gray-200);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
        }

        .chart-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--gray-900);
        }

        .chart-placeholder {
            height: 300px;
            background: var(--gray-100);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-500);
            font-weight: 500;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-2xl);
        }

        .action-card {
            background: var(--white);
            padding: var(--spacing-lg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--gray-200);
            text-decoration: none;
            color: inherit;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .action-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent-color);
        }

        .action-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-lg);
            background: var(--primary-gradient);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            margin-bottom: var(--spacing-md);
        }

        .action-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: var(--spacing-xs);
        }

        .action-description {
            font-size: 0.875rem;
            color: var(--gray-500);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-md) var(--spacing-lg);
            border: none;
            border-radius: var(--radius-lg);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: var(--white);
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--white);
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background: var(--primary-color);
            color: var(--white);
        }

        /* Page Sections */
        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                z-index: 1000;
                box-shadow: var(--shadow-lg);
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .mobile-menu-btn {
                display: block;
            }

            /* Top Bar - Compact */
            .top-bar {
                padding: var(--spacing-sm) var(--spacing-md);
            }

            .page-title {
                font-size: 1.125rem;
            }

            .user-menu {
                gap: var(--spacing-sm);
            }

            .user-avatar {
                width: 36px;
                height: 36px;
                font-size: 0.875rem;
            }

            .notification-btn {
                font-size: 1.125rem;
            }

            /* Content Area - Reduced Padding */
            .content-area {
                padding: var(--spacing-md);
            }

            /* Dashboard Grid - Compact */
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: var(--spacing-md);
                margin-bottom: var(--spacing-lg);
            }

            /* Stat Cards - Compact */
            .stat-card {
                padding: var(--spacing-md);
            }

            .stat-icon {
                width: 40px;
                height: 40px;
                font-size: 1.25rem;
            }

            .stat-value {
                font-size: 1.75rem;
            }

            .stat-title {
                font-size: 0.75rem;
            }

            .stat-change {
                font-size: 0.8125rem;
            }

            /* Analytics Section - Single Column */
            .analytics-section {
                grid-template-columns: 1fr;
                gap: var(--spacing-md);
                margin-bottom: var(--spacing-lg);
            }

            /* Chart Cards - Compact */
            .chart-card {
                padding: var(--spacing-md);
            }

            .chart-title {
                font-size: 1rem;
            }

            .chart-header {
                margin-bottom: var(--spacing-md);
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-sm);
            }

            .chart-placeholder {
                height: 250px;
            }

            /* Section Headers - Compact */
            .section-header {
                margin-bottom: var(--spacing-md);
                padding-bottom: var(--spacing-md);
                flex-direction: column;
                align-items: flex-start;
                gap: var(--spacing-sm);
            }

            .section-header h2 {
                font-size: 1.25rem;
            }

            .section-actions {
                width: 100%;
                flex-direction: column;
                gap: var(--spacing-sm);
            }

            .section-actions button,
            .section-actions .btn {
                width: 100%;
                padding: var(--spacing-sm) var(--spacing-md);
                font-size: 0.875rem;
            }

            /* Stats Row - Compact */
            .stats-row {
                grid-template-columns: 1fr;
                gap: var(--spacing-md);
                margin-bottom: var(--spacing-md);
            }

            .mini-stat-card {
                padding: var(--spacing-md);
            }

            .mini-stat-icon {
                width: 40px;
                height: 40px;
                font-size: 1.125rem;
            }

            .mini-stat-value {
                font-size: 1.25rem;
            }

            .mini-stat-label {
                font-size: 0.8125rem;
            }

            /* Filters Section - Compact */
            .filters-section {
                padding: var(--spacing-md);
                margin-bottom: var(--spacing-md);
            }

            .search-box {
                margin-bottom: var(--spacing-sm);
            }

            .filter-controls {
                gap: var(--spacing-sm);
            }

            .filter-select {
                padding: var(--spacing-xs) var(--spacing-sm);
                font-size: 0.8125rem;
            }

            /* Quick Actions - Compact Grid */
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--spacing-sm);
            }

            .quick-action-btn {
                padding: var(--spacing-md);
                font-size: 0.8125rem;
            }

            .quick-action-btn i {
                font-size: 1.25rem;
            }

            /* Tables - Compact */
            .data-table th,
            .data-table td {
                padding: var(--spacing-sm) var(--spacing-md);
                font-size: 0.8125rem;
            }

            .data-table th {
                font-size: 0.75rem;
            }

            /* Action Buttons - Compact */
            .action-btn,
            .btn-sm {
                padding: var(--spacing-xs) var(--spacing-sm);
                font-size: 0.75rem;
            }

            /* Cards - Compact */
            .card {
                padding: var(--spacing-md);
                margin-bottom: var(--spacing-md);
            }

            .card-header {
                padding: var(--spacing-md);
                margin-bottom: var(--spacing-md);
            }

            .card-body {
                padding: var(--spacing-md);
            }

            .card-title {
                font-size: 1rem;
            }

            /* Forms - Compact */
            .form-group {
                margin-bottom: var(--spacing-md);
            }

            .form-label {
                font-size: 0.875rem;
                margin-bottom: var(--spacing-xs);
            }

            .form-input,
            .form-select,
            .form-textarea {
                padding: var(--spacing-sm) var(--spacing-md);
                font-size: 0.875rem;
            }

            /* Modals - Better Mobile Fit */
            .modal-content {
                width: 95%;
                max-width: 95%;
                margin: var(--spacing-md);
                max-height: 90vh;
            }

            .modal-header {
                padding: var(--spacing-md);
            }

            .modal-body {
                padding: var(--spacing-md);
            }

            .modal-footer {
                padding: var(--spacing-md);
                gap: var(--spacing-sm);
            }

            .modal-title {
                font-size: 1.125rem;
            }

            /* Tab Navigation - Compact */
            .tab-nav {
                gap: var(--spacing-xs);
                overflow-x: auto;
            }

            .tab-btn,
            .content-tab-btn,
            .assessment-tab-btn {
                padding: var(--spacing-sm) var(--spacing-md);
                font-size: 0.8125rem;
                white-space: nowrap;
            }

            /* Lists - Compact */
            .list-item {
                padding: var(--spacing-md);
            }

            /* Badges - Compact */
            .badge {
                padding: var(--spacing-xs) var(--spacing-sm);
                font-size: 0.75rem;
            }

            /* Empty States - Compact */
            .empty-state {
                padding: var(--spacing-xl);
            }

            .empty-state-icon {
                font-size: 2.5rem;
            }

            .empty-state-text {
                font-size: 0.875rem;
            }
        }

        /* Mobile Overlay */
        .mobile-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .mobile-overlay.active {
            display: block;
            opacity: 1;
        }

        @media (max-width: 480px) {
            /* Extra Small Devices - Ultra Compact */
            .top-bar {
                padding: var(--spacing-xs) var(--spacing-sm);
            }

            .page-title {
                font-size: 1rem;
            }

            .content-area {
                padding: var(--spacing-sm);
            }

            .dashboard-grid {
                gap: var(--spacing-sm);
            }

            .stat-card {
                padding: var(--spacing-sm);
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .stat-icon {
                width: 36px;
                height: 36px;
                font-size: 1.125rem;
            }

            .section-header h2 {
                font-size: 1.125rem;
            }

            .chart-card {
                padding: var(--spacing-sm);
            }

            .chart-placeholder {
                height: 200px;
            }

            .mini-stat-card {
                padding: var(--spacing-sm);
            }

            .mini-stat-icon {
                width: 36px;
                height: 36px;
            }

            .mini-stat-value {
                font-size: 1.125rem;
            }

            .filters-section {
                padding: var(--spacing-sm);
            }

            .quick-actions {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 98%;
                margin: var(--spacing-sm);
            }

            .modal-header,
            .modal-body,
            .modal-footer {
                padding: var(--spacing-sm);
            }
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--white);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Fade In Animation */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        /* Content Tab Styles */
        .content-tab-btn.active {
            background: var(--primary-gradient) !important;
            color: var(--white) !important;
            box-shadow: var(--shadow-sm);
        }

        .content-tab-btn:not(.active):hover {
            background: var(--gray-100);
            color: var(--text-primary);
        }

        .content-tab-content {
            display: none;
        }

        .content-tab-content.active {
            display: block;
        }

        .modal {
            display: none;
        }

        .modal.active {
            display: flex !important;
        }

        /* Subscription Modal Specific Styles */
        #subscription-modal.active {
            display: flex !important;
        }

        /* Assessment Tab Styles */
        .assessment-tab-btn.active {
            background: var(--primary-gradient) !important;
            color: var(--white) !important;
            box-shadow: var(--shadow-sm);
        }

        .assessment-tab-btn:not(.active):hover {
            background: var(--gray-100);
            color: var(--text-primary);
        }

        .assessment-tab-content {
            display: none;
        }

        .assessment-tab-content.active {
            display: block;
        }

        /* Section Styles */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xl);
            padding-bottom: var(--spacing-lg);
            border-bottom: 2px solid var(--gray-200);
        }

        .section-header h2 {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--gray-900);
            margin: 0;
        }

        .section-actions {
            display: flex;
            gap: var(--spacing-md);
        }

        /* Mini Stats Row */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .mini-stat-card {
            background: var(--white);
            padding: var(--spacing-lg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            transition: all 0.3s ease;
        }

        .mini-stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .mini-stat-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-lg);
            background: var(--primary-gradient);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .mini-stat-content {
            flex: 1;
        }

        .mini-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: var(--spacing-xs);
        }

        .mini-stat-label {
            font-size: 0.875rem;
            color: var(--gray-500);
            font-weight: 500;
        }

        /* Filters Section */
        .filters-section {
            background: var(--white);
            padding: var(--spacing-lg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            margin-bottom: var(--spacing-xl);
        }

        .search-box {
            position: relative;
            margin-bottom: var(--spacing-md);
        }

        .search-box i {
            position: absolute;
            left: var(--spacing-md);
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-400);
        }

        .search-box input {
            width: 100%;
            padding: var(--spacing-md) var(--spacing-md) var(--spacing-md) 2.5rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }

        .filter-controls {
            display: flex;
            gap: var(--spacing-md);
            flex-wrap: wrap;
        }

        .filter-select {
            padding: var(--spacing-sm) var(--spacing-md);
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            font-size: 0.875rem;
            background: var(--white);
            color: var(--gray-700);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }

        /* Table Styles */
        .table-container {
            background: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            overflow: hidden;
            margin-bottom: var(--spacing-xl);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            background: var(--gray-50);
            padding: var(--spacing-md) var(--spacing-lg);
            text-align: left;
            font-weight: 600;
            color: var(--gray-700);
            font-size: 0.875rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .data-table td {
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 1px solid var(--gray-100);
            font-size: 0.875rem;
        }

        .data-table tr:hover {
            background: var(--gray-50);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .user-avatar-small {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-gradient);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
        }

        .user-name {
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 2px;
        }

        .user-email {
            color: var(--gray-500);
            font-size: 0.75rem;
        }

        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .badge-student {
            background: rgba(59, 130, 246, 0.1);
            color: #1e40af;
        }

        .badge-parent {
            background: rgba(16, 185, 129, 0.1);
            color: #047857;
        }

        .family-code {
            background: var(--gray-100);
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius-md);
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
            color: var(--gray-700);
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-badge.active {
            background: rgba(16, 185, 129, 0.1);
            color: #047857;
        }

        .status-badge.inactive {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
        }

        .status-badge.trial {
            background: rgba(245, 158, 11, 0.1);
            color: #d97706;
        }

        .status-badge.expired {
            background: rgba(107, 114, 128, 0.1);
            color: #4b5563;
        }

        .action-buttons {
            display: flex;
            gap: var(--spacing-xs);
        }

        .btn-icon {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: var(--radius-md);
            background: var(--gray-100);
            color: var(--gray-600);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-icon:hover {
            background: var(--primary-color);
            color: var(--white);
        }

        /* Pagination */
        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-lg);
            background: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
        }

        .pagination-info {
            color: var(--gray-600);
            font-size: 0.875rem;
        }

        .pagination {
            display: flex;
            gap: var(--spacing-xs);
        }

        .pagination-btn {
            width: 36px;
            height: 36px;
            border: 1px solid var(--gray-200);
            background: var(--white);
            color: var(--gray-600);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }

        .pagination-btn:hover:not(:disabled) {
            background: var(--primary-color);
            color: var(--white);
            border-color: var(--primary-color);
        }

        .pagination-btn.active {
            background: var(--primary-color);
            color: var(--white);
            border-color: var(--primary-color);
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Toggle Switch Styles */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        .toggle-switch input:checked + .toggle-slider {
            background-color: #ef4444;
        }

        .toggle-switch input:not(:checked) + .toggle-slider {
            background-color: #10b981;
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        /* Button Animations */
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        /* Content Card Animation */
        .content-card {
            animation: slideInUp 0.4s ease-out;
        }

        /* Smooth Transitions for Buttons */
        .btn, button {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn:active, button:active {
            transform: scale(0.95) !important;
        }

        /* Action Button Hover Effects */
        .action-btn {
            position: relative;
            overflow: hidden;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .action-btn:hover::before {
            width: 300px;
            height: 300px;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Mobile Overlay -->
        <div class="mobile-overlay" id="mobileOverlay"></div>
        
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <img src="logo-dashboard-white.svg" alt="BrainWave Logo" style="width: 100%; height: 100%; object-fit: contain;">
                    </div>
                    <span class="logo-text">BrainWave</span>
                </div>
                <button class="sidebar-toggle" id="sidebarToggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <!-- Scroll Up Button -->
            <button id="scroll-up-btn" style="width: 100%; padding: 0.5rem; background: rgba(255, 255, 255, 0.1); border: none; color: white; cursor: pointer; transition: all 0.3s; border-bottom: 1px solid rgba(255, 255, 255, 0.1);" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'">
                <i class="fas fa-chevron-up"></i>
            </button>
            
            <nav class="sidebar-nav" id="sidebar-nav-container" style="overflow-y: auto; max-height: calc(100vh - 200px); scroll-behavior: smooth;">
                <div class="nav-item">
                    <a href="#" class="nav-link active" data-page="dashboard">
                        <i class="nav-icon fas fa-tachometer-alt"></i>
                        <span class="nav-text">Dashboard</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-page="users">
                        <i class="nav-icon fas fa-users"></i>
                        <span class="nav-text">Users</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-page="content">
                        <i class="nav-icon fas fa-book-open"></i>
                        <span class="nav-text">Books & Videos</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-page="subjects">
                        <i class="nav-icon fas fa-graduation-cap"></i>
                        <span class="nav-text">Subject Management</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-page="assessments">
                        <i class="nav-icon fas fa-clipboard-check"></i>
                        <span class="nav-text">Assessments</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-page="live-classes">
                        <i class="nav-icon fas fa-video"></i>
                        <span class="nav-text">Live Classes</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-page="community">
                        <i class="nav-icon fas fa-bullhorn"></i>
                        <span class="nav-text">Community & Announcements</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-page="analytics">
                        <i class="nav-icon fas fa-chart-bar"></i>
                        <span class="nav-text">Analytics</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" data-page="settings">
                        <i class="nav-icon fas fa-crown"></i>
                        <span class="nav-text">Subscription Management</span>
                    </a>
                </div>
            </nav>
            
            <!-- Scroll Down Button -->
            <button id="scroll-down-btn" style="width: 100%; padding: 0.5rem; background: rgba(255, 255, 255, 0.1); border: none; color: white; cursor: pointer; transition: all 0.3s; border-top: 1px solid rgba(255, 255, 255, 0.1);" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'">
                <i class="fas fa-chevron-down"></i>
            </button>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <header class="top-bar">
                <div style="display: flex; align-items: center; gap: var(--spacing-md);">
                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title" id="pageTitle">Dashboard</h1>
                </div>
                <div class="user-menu">
                    <div class="user-profile-dropdown" style="position: relative;">
                        <div class="user-avatar" onclick="window.toggleProfileDropdown()" style="cursor: pointer;">
                            <i class="fas fa-user"></i>
                        </div>
                        <div id="profile-dropdown" style="display: none; position: absolute; top: 100%; right: 0; margin-top: 0.5rem; background: var(--white); border-radius: 8px; box-shadow: var(--shadow-lg); min-width: 200px; z-index: 1000; border: 1px solid var(--border-color);">
                            <div style="padding: 1rem; border-bottom: 1px solid var(--border-color);">
                                <p style="margin: 0; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;" id="dropdown-admin-name">Admin User</p>
                                <p style="margin: 0.25rem 0 0 0; font-size: 0.75rem; color: var(--text-secondary);" id="dropdown-admin-email">admin@brainwave.com</p>
                            </div>
                            <div style="padding: 0.5rem;">
                                <button onclick="window.openProfileModal()" style="width: 100%; text-align: left; padding: 0.75rem 1rem; background: none; border: none; cursor: pointer; border-radius: 6px; display: flex; align-items: center; gap: 0.75rem; font-size: 0.875rem; color: var(--text-primary); transition: background 0.2s;" onmouseover="this.style.background='var(--hover-bg)'" onmouseout="this.style.background='none'">
                                    <i class="fas fa-user-edit" style="color: var(--primary-color);"></i>
                                    <span>Edit Profile</span>
                                </button>
                                <button onclick="window.openUpgradeModal()" style="width: 100%; text-align: left; padding: 0.75rem 1rem; background: none; border: none; cursor: pointer; border-radius: 6px; display: flex; align-items: center; gap: 0.75rem; font-size: 0.875rem; color: var(--accent-color); transition: background 0.2s;" onmouseover="this.style.background='#FEF3C7'" onmouseout="this.style.background='none'">
                                    <i class="fas fa-crown" style="color: var(--accent-color);"></i>
                                    <span>Upgrade Plan</span>
                                </button>
                                <button onclick="window.logoutAdmin()" style="width: 100%; text-align: left; padding: 0.75rem 1rem; background: none; border: none; cursor: pointer; border-radius: 6px; display: flex; align-items: center; gap: 0.75rem; font-size: 0.875rem; color: var(--danger-color); transition: background 0.2s;" onmouseover="this.style.background='#FEE2E2'" onmouseout="this.style.background='none'">
                                    <i class="fas fa-sign-out-alt"></i>
                                    <span>Logout</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Dashboard Section -->
                <section id="dashboard-section" class="page-section active fade-in">
                    <!-- Statistics Cards -->
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <span class="stat-title">Total Users</span>
                                <div class="stat-icon users">
                                    <i class="fas fa-users"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="totalUsers">1,234</div>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span>+12% from last month</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <span class="stat-title">Content Items</span>
                                <div class="stat-icon content">
                                    <i class="fas fa-book"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="totalContent">567</div>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span>+8% from last month</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <span class="stat-title">Assessments</span>
                                <div class="stat-icon assessments">
                                    <i class="fas fa-clipboard-check"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="totalAssessments">89</div>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span>+15% from last month</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <span class="stat-title">Revenue</span>
                                <div class="stat-icon revenue">
                                    <i class="fas fa-dollar-sign"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="totalRevenue">$12,345</div>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span>+23% from last month</span>
                            </div>
                        </div>
                    </div>

                    <!-- Analytics Section -->
                    <div class="analytics-section">
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="chart-title">User Growth</h3>
                                <select class="btn btn-secondary">
                                    <option>Last 7 days</option>
                                    <option>Last 30 days</option>
                                    <option>Last 90 days</option>
                                </select>
                            </div>
                            <div class="chart-placeholder">
                                <i class="fas fa-chart-line" style="font-size: 3rem; margin-right: 1rem;"></i>
                                Chart will be implemented here
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="chart-title">Recent Activity</h3>
                            </div>
                            <div style="height: 300px; overflow-y: auto;">
                                <div style="padding: 1rem 0; border-bottom: 1px solid var(--gray-200);">
                                    <div style="display: flex; align-items: center; gap: 1rem;">
                                        <div style="width: 8px; height: 8px; background: var(--success-color); border-radius: 50%;"></div>
                                        <div>
                                            <div style="font-weight: 600; color: var(--gray-900);">New user registered</div>
                                            <div style="font-size: 0.875rem; color: var(--gray-500);">John Doe joined as a student</div>
                                            <div style="font-size: 0.75rem; color: var(--gray-400);">2 minutes ago</div>
                                        </div>
                                    </div>
                                </div>
                                <div style="padding: 1rem 0; border-bottom: 1px solid var(--gray-200);">
                                    <div style="display: flex; align-items: center; gap: 1rem;">
                                        <div style="width: 8px; height: 8px; background: var(--info-color); border-radius: 50%;"></div>
                                        <div>
                                            <div style="font-weight: 600; color: var(--gray-900);">Content uploaded</div>
                                            <div style="font-size: 0.875rem; color: var(--gray-500);">Mathematics Chapter 5 added</div>
                                            <div style="font-size: 0.75rem; color: var(--gray-400);">1 hour ago</div>
                                        </div>
                                    </div>
                                </div>
                                <div style="padding: 1rem 0; border-bottom: 1px solid var(--gray-200);">
                                    <div style="display: flex; align-items: center; gap: 1rem;">
                                        <div style="width: 8px; height: 8px; background: var(--warning-color); border-radius: 50%;"></div>
                                        <div>
                                            <div style="font-weight: 600; color: var(--gray-900);">Assessment completed</div>
                                            <div style="font-size: 0.875rem; color: var(--gray-500);">Physics Quiz by 25 students</div>
                                            <div style="font-size: 0.75rem; color: var(--gray-400);">3 hours ago</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <div class="action-card" data-page="users">
                            <div class="action-icon">
                                <i class="fas fa-users-cog"></i>
                            </div>
                            <div class="action-title">Manage Users</div>
                            <div class="action-description">View, edit, and manage all user accounts</div>
                        </div>

                        <div class="action-card" data-page="content">
                            <div class="action-icon">
                                <i class="fas fa-upload"></i>
                            </div>
                            <div class="action-title">Upload Content</div>
                            <div class="action-description">Add new books, videos, or materials</div>
                        </div>

                        <div class="action-card" data-page="assessments">
                            <div class="action-icon">
                                <i class="fas fa-plus-circle"></i>
                            </div>
                            <div class="action-title">Create Assessment</div>
                            <div class="action-description">Design quizzes and exams</div>
                        </div>

                        <div class="action-card" data-page="live-classes">
                            <div class="action-icon">
                                <i class="fas fa-video"></i>
                            </div>
                            <div class="action-title">Schedule Class</div>
                            <div class="action-description">Set up live teaching sessions</div>
                        </div>
                    </div>
                </section>

                <!-- Other sections will be added by JavaScript -->
                <section id="users-section" class="page-section">
                    <div class="fade-in">
                        <div class="section-header">
                            <h2>User Management</h2>
                            <div class="section-actions">
                                <button class="btn btn-secondary" onclick="exportUsers()">
                                    <i class="fas fa-download"></i> Export Users
                                </button>
                                <button class="btn btn-primary" onclick="window.showStudentCodeModal()">
                                    <i class="fas fa-id-card"></i> Generate Student Code
                                </button>
                            </div>
                        </div>

                        <!-- User Statistics -->
                        <div class="stats-row">
                            <div class="mini-stat-card">
                                <div class="mini-stat-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="mini-stat-content">
                                    <div class="mini-stat-value">1,234</div>
                                    <div class="mini-stat-label">Total Users</div>
                                </div>
                            </div>
                            <div class="mini-stat-card">
                                <div class="mini-stat-icon">
                                    <i class="fas fa-user-graduate"></i>
                                </div>
                                <div class="mini-stat-content">
                                    <div class="mini-stat-value">987</div>
                                    <div class="mini-stat-label">Students</div>
                                </div>
                            </div>
                            <div class="mini-stat-card">
                                <div class="mini-stat-icon">
                                    <i class="fas fa-user-friends"></i>
                                </div>
                                <div class="mini-stat-content">
                                    <div class="mini-stat-value">247</div>
                                    <div class="mini-stat-label">Parents</div>
                                </div>
                            </div>
                        </div>

                        <!-- Filters and Search -->
                        <div class="filters-section">
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" placeholder="Search users by name, email, or family code..." id="userSearch">
                            </div>
                            <div class="filter-controls">
                                <select class="filter-select" id="userTypeFilter">
                                    <option value="">All User Types</option>
                                    <option value="student">Students</option>
                                    <option value="parent">Parents</option>
                                </select>
                                <select class="filter-select" id="statusFilter">
                                    <option value="">All Status</option>
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                    <option value="trial">Trial</option>
                                    <option value="expired">Expired</option>
                                </select>
                                <select class="filter-select" id="planFilter">
                                    <option value="">All Plans</option>
                                    <option value="individual">Individual</option>
                                    <option value="family">Family Plan</option>
                                </select>
                            </div>
                        </div>

                        <!-- Users Table -->
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>
                                            <input type="checkbox" id="selectAll">
                                        </th>
                                        <th>User</th>
                                        <th>Type</th>
                                        <th>Family Code</th>
                                        <th>Plan</th>
                                        <th>Status</th>
                                        <th>Expiry</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody">
                                    <!-- Sample data - will be populated by JavaScript -->
                                    <tr>
                                        <td><input type="checkbox" class="user-checkbox" data-user-id="1"></td>
                                        <td>
                                            <div class="user-info">
                                                <div class="user-avatar-small">
                                                    <i class="fas fa-user"></i>
                                                </div>
                                                <div>
                                                    <div class="user-name">John Doe</div>
                                                    <div class="user-email">john.doe@email.com</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td><span class="badge badge-student">Student</span></td>
                                        <td><code class="family-code">BW-2024-ABC123</code></td>
                                        <td>Individual</td>
                                        <td><span class="status-badge active">Active</span></td>
                                        <td>2024-03-15</td>
                                        <td>
                                            <div class="action-buttons">
                                                <button class="btn-icon" onclick="editUser(1)" title="Edit">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="btn-icon" onclick="toggleUserStatus(1)" title="Toggle Status">
                                                    <i class="fas fa-power-off"></i>
                                                </button>
                                                <button class="btn-icon" onclick="viewUserDetails(1)" title="View Details">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" class="user-checkbox" data-user-id="2"></td>
                                        <td>
                                            <div class="user-info">
                                                <div class="user-avatar-small">
                                                    <i class="fas fa-user"></i>
                                                </div>
                                                <div>
                                                    <div class="user-name">Jane Smith</div>
                                                    <div class="user-email">jane.smith@email.com</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td><span class="badge badge-parent">Parent</span></td>
                                        <td><code class="family-code">BW-2024-ABC123</code></td>
                                        <td>Family Plan</td>
                                        <td><span class="status-badge active">Active</span></td>
                                        <td>2024-04-20</td>
                                        <td>
                                            <div class="action-buttons">
                                                <button class="btn-icon" onclick="editUser(2)" title="Edit">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="btn-icon" onclick="toggleUserStatus(2)" title="Toggle Status">
                                                    <i class="fas fa-power-off"></i>
                                                </button>
                                                <button class="btn-icon" onclick="viewUserDetails(2)" title="View Details">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Pagination -->
                        <div class="pagination-container">
                            <div class="pagination-info" id="pagination-info">
                                Showing 1-10 of 1,234 users
                            </div>
                            <div class="pagination" id="pagination-controls">
                                <button class="pagination-btn" id="prev-page-btn" onclick="window.adminDashboard.previousPage()">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <span id="page-numbers"></span>
                                <button class="pagination-btn" id="next-page-btn" onclick="window.adminDashboard.nextPage()">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="content-section" class="page-section">
                    <div class="fade-in">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <div>
                                <h2>Books & Videos Management</h2>
                                <p style="color: var(--text-secondary); margin: 0.5rem 0 0 0;">Manage educational books and videos with Google Drive and YouTube links</p>
                            </div>
                        </div>

                        <!-- Content Stats -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="books-count">0</div>
                                    <div class="stat-label">Total Books</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                                    <i class="fas fa-video"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="videos-count">0</div>
                                    <div class="stat-label">Total Videos</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #3b82f6, #2563eb);">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="subjects-count">12</div>
                                    <div class="stat-label">Subjects</div>
                                </div>
                            </div>
                        </div>

                        <!-- Content Tabs -->
                        <div style="display: flex; background: var(--card-bg); border-radius: 12px; padding: 0.5rem; margin-bottom: 2rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color);">
                            <button class="content-tab-btn active" onclick="switchContentTab('books')" style="flex: 1; padding: 1rem 1.5rem; background: var(--primary-gradient); color: var(--white); border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; gap: 0.5rem; box-shadow: var(--shadow-sm);">
                                <i class="fas fa-book"></i>
                                Books & E-books
                            </button>
                            <button class="content-tab-btn" onclick="switchContentTab('videos')" style="flex: 1; padding: 1rem 1.5rem; background: none; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; gap: 0.5rem; color: var(--text-secondary);">
                                <i class="fas fa-video"></i>
                                Videos
                            </button>
                        </div>

                        <!-- Books Tab -->
                        <div id="books-content-tab" class="content-tab-content active">
                            <div style="background: var(--card-bg); border-radius: 12px; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); overflow: hidden;">
                                <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color); background: linear-gradient(135deg, var(--gray-50) 0%, var(--white) 100%); display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h3 style="margin: 0; color: var(--text-primary); font-size: 1.25rem; display: flex; align-items: center; gap: 0.5rem;">
                                            <i class="fas fa-book" style="color: #10b981;"></i>
                                            Books & E-books
                                        </h3>
                                        <p style="margin: 0.25rem 0 0 0; font-size: 0.875rem; color: var(--text-secondary);">Upload and manage book content from Google Drive</p>
                                    </div>
                                    <button class="btn btn-primary" onclick="openContentModal('book')" style="background: linear-gradient(135deg, #10b981, #059669); box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-2px) scale(1.02)'; this.style.boxShadow='0 6px 20px rgba(16, 185, 129, 0.4)'" onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 4px 12px rgba(16, 185, 129, 0.3)'">
                                        <i class="fas fa-plus" style="animation: pulse 2s infinite;"></i>
                                        Add Book
                                    </button>
                                </div>
                                
                                <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color);">
                                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 1rem; align-items: end;">
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Search Books</label>
                                            <div style="position: relative;">
                                                <i class="fas fa-search" style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
                                                <input type="text" id="book-search" placeholder="Search by title, author, or subject..." style="width: 100%; padding: 0.75rem 0.75rem 0.75rem 2.5rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                                            </div>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Class Level</label>
                                            <select id="book-class-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Classes</option>
                                                <option value="SS1">SS1</option>
                                                <option value="SS2">SS2</option>
                                                <option value="SS3">SS3</option>
                                                <option value="JAMB">JAMB</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Subject</label>
                                            <select id="book-subject-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Subjects</option>
                                                <option value="Mathematics">Mathematics</option>
                                                <option value="English Language">English Language</option>
                                                <option value="Citizenship and Heritage Studies">Citizenship and Heritage Studies</option>
                                                <option value="Physics">Physics</option>
                                                <option value="Chemistry">Chemistry</option>
                                                <option value="Biology">Biology</option>
                                                <option value="Economics">Economics</option>
                                                <option value="Literature-in-English">Literature-in-English</option>
                                                <option value="Government">Government</option>
                                                <option value="Commerce">Commerce</option>
                                                <option value="Accounts">Accounts</option>
                                                <option value="CRS">CRS</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div id="books-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem; padding: 1.5rem;">
                                    <div class="empty-state" style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: var(--text-secondary);">
                                        <i class="fas fa-book" style="font-size: 3rem; margin-bottom: 1rem; color: var(--border-color);"></i>
                                        <h3 style="margin: 0 0 0.5rem 0;">No books yet</h3>
                                        <p style="margin: 0;">Click "Add Book" to get started</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Videos Tab -->
                        <div id="videos-content-tab" class="content-tab-content" style="display: none;">
                            <div style="background: var(--card-bg); border-radius: 12px; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); overflow: hidden;">
                                <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color); background: linear-gradient(135deg, var(--gray-50) 0%, var(--white) 100%); display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h3 style="margin: 0; color: var(--text-primary); font-size: 1.25rem; display: flex; align-items: center; gap: 0.5rem;">
                                            <i class="fas fa-video" style="color: #ef4444;"></i>
                                            Educational Videos
                                        </h3>
                                        <p style="margin: 0.25rem 0 0 0; font-size: 0.875rem; color: var(--text-secondary);">Upload and manage video content from YouTube</p>
                                    </div>
                                    <button class="btn btn-primary" onclick="openContentModal('video')" style="background: linear-gradient(135deg, #ef4444, #dc2626); box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-2px) scale(1.02)'; this.style.boxShadow='0 6px 20px rgba(239, 68, 68, 0.4)'" onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 4px 12px rgba(239, 68, 68, 0.3)'">
                                        <i class="fas fa-plus" style="animation: pulse 2s infinite;"></i>
                                        Add Video
                                    </button>
                                </div>
                                
                                <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color);">
                                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 1rem; align-items: end;">
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Search Videos</label>
                                            <div style="position: relative;">
                                                <i class="fas fa-search" style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
                                                <input type="text" id="video-search" placeholder="Search by title, topic, or subject..." style="width: 100%; padding: 0.75rem 0.75rem 0.75rem 2.5rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                                            </div>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Class Level</label>
                                            <select id="video-class-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Classes</option>
                                                <option value="SS1">SS1</option>
                                                <option value="SS2">SS2</option>
                                                <option value="SS3">SS3</option>
                                                <option value="JAMB">JAMB</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Subject</label>
                                            <select id="video-subject-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Subjects</option>
                                                <option value="Mathematics">Mathematics</option>
                                                <option value="English Language">English Language</option>
                                                <option value="Citizenship and Heritage Studies">Citizenship and Heritage Studies</option>
                                                <option value="Physics">Physics</option>
                                                <option value="Chemistry">Chemistry</option>
                                                <option value="Biology">Biology</option>
                                                <option value="Economics">Economics</option>
                                                <option value="Literature-in-English">Literature-in-English</option>
                                                <option value="Government">Government</option>
                                                <option value="Commerce">Commerce</option>
                                                <option value="Accounts">Accounts</option>
                                                <option value="CRS">CRS</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div id="videos-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem; padding: 1.5rem;">
                                    <div class="empty-state" style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: var(--text-secondary);">
                                        <i class="fas fa-video" style="font-size: 3rem; margin-bottom: 1rem; color: var(--border-color);"></i>
                                        <h3 style="margin: 0 0 0.5rem 0;">No videos yet</h3>
                                        <p style="margin: 0;">Click "Add Video" to get started</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="subjects-section" class="page-section">
                    <div class="fade-in">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <div>
                                <h2>Subject Management</h2>
                                <p style="color: var(--text-secondary); margin: 0.5rem 0 0 0;">Manage subjects across different class levels and streams</p>
                            </div>
                            <button class="btn btn-primary" onclick="window.adminDashboard.showAddSubjectModal()">
                                <i class="fas fa-plus"></i>
                                Add Subject
                            </button>
                        </div>
                        
                        <div class="filters-bar" style="background: var(--card-bg); padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem; box-shadow: var(--shadow-sm);">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; align-items: end;">
                                <div class="filter-group">
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-primary);">Search Subjects</label>
                                    <div style="position: relative;">
                                        <i class="fas fa-search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
                                        <input type="text" placeholder="Search by subject name..." id="searchSubjectInput" style="width: 100%; padding: 12px 12px 12px 40px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--input-bg);">
                                    </div>
                                </div>
                                <div class="filter-group">
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-primary);">Class Level</label>
                                    <select id="classSubjectFilter" style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--input-bg);">
                                        <option value="">All Classes</option>
                                        <option value="SS1">SS1</option>
                                        <option value="SS2">SS2</option>
                                        <option value="SS3">SS3</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-primary);">Stream</label>
                                    <select id="streamSubjectFilter" style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--input-bg);">
                                        <option value="">All Streams</option>
                                        <option value="General">General</option>
                                        <option value="Science">Science</option>
                                        <option value="Humanities">Humanities</option>
                                        <option value="Business">Business</option>
                                        <option value="JAMB">JAMB</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <button class="btn btn-secondary" onclick="window.adminDashboard.applySubjectFilters()">
                                        <i class="fas fa-filter"></i>
                                        Filter
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="subjects-grid" id="subjectsGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem;">
                            
                            <!-- ========== SS1 - SS3 SUBJECTS ========== -->
                            <div style="grid-column: 1 / -1; margin-bottom: 1rem;">
                                <h2 style="color: var(--primary-color); font-size: 1.5rem; border-bottom: 3px solid var(--primary-color); padding-bottom: 0.75rem; margin-bottom: 0;">
                                    <i class="fas fa-school"></i> SS1 - SS3 Subjects
                                </h2>
                            </div>

                            <!-- GENERAL SUBJECTS SECTION -->
                            <div style="grid-column: 1 / -1; margin-top: 1.5rem; margin-bottom: 0.5rem;">
                                <h3 style="color: #1e3a8a; font-size: 1.2rem; border-left: 4px solid #1e3a8a; padding-left: 1rem; margin: 0;">
                                     General Subjects (Core for All Streams)
                                </h3>
                            </div>
                            
                            <!-- Mathematics Subject -->
                            <div class="subject-card" data-stream="General" data-class="SS1,SS2,SS3" style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, var(--primary-color), var(--accent-color)); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-calculator"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">Mathematics</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">Core mathematics covering algebra, geometry, calculus, and statistics for all senior secondary classes.</p>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: var(--primary-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">General Subject</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">SS1, SS2, SS3</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 12 Books</span>
                                    <span><i class="fas fa-video"></i> 45 Videos</span>
                                    <span><i class="fas fa-users"></i> 2,456 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('mathematics')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                    <i class="fas fa-eye"></i> View Content
                                </button>
                                <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('mathematics')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('mathematics')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                                </div>
                            </div>

                            <!-- English Language Subject -->
                            <div class="subject-card" data-stream="General" data-class="SS1,SS2,SS3" style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #e74c3c, #c0392b); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-book-open"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">English Language</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">Comprehensive English language studies including grammar, literature, composition, and oral communication.</p>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: var(--primary-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">General Subject</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">SS1, SS2, SS3</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 8 Books</span>
                                    <span><i class="fas fa-video"></i> 32 Videos</span>
                                    <span><i class="fas fa-users"></i> 2,234 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('english')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                    <i class="fas fa-eye"></i> View Content
                                </button>
                                <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('english')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('english')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                                </div>
                            </div>

                            <!-- Citizenship and Heritage Studies Subject -->
                            <div class="subject-card" data-stream="General" data-class="SS1,SS2,SS3" style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #27ae60, #2ecc71); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-balance-scale"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">Citizenship and Heritage Studies</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">Study of citizenship, rights, responsibilities, and civic duties in society.</p>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: var(--primary-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">General Subject</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">SS1, SS2, SS3</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 6 Books</span>
                                    <span><i class="fas fa-video"></i> 24 Videos</span>
                                    <span><i class="fas fa-users"></i> 1,987 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('civic')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('civic')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('civic')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>

                            <!-- SCIENCE STREAM SECTION -->
                            <div style="grid-column: 1 / -1; margin-top: 2rem; margin-bottom: 0.5rem;">
                                <h3 style="color: #9b59b6; font-size: 1.2rem; border-left: 4px solid #9b59b6; padding-left: 1rem; margin: 0;">
                                     Science Stream Subjects
                                </h3>
                            </div>
                            
                            <!-- Physics Subject -->
                            <div class="subject-card" data-stream="Science" data-class="SS1,SS2,SS3" style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #9b59b6, #8e44ad); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-atom"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">Physics</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">Study of matter, energy, motion, and forces. Covers mechanics, thermodynamics, waves, and modern physics.</p>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #9b59b6; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Science Stream</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">SS1, SS2, SS3</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 15 Books</span>
                                    <span><i class="fas fa-video"></i> 67 Videos</span>
                                    <span><i class="fas fa-users"></i> 1,876 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('physics')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('physics')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('physics')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>

                            <!-- Chemistry Subject -->
                            <div class="subject-card" data-stream="Science" data-class="SS1,SS2,SS3" style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #3498db, #2980b9); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-flask"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">Chemistry</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">Study of matter, its properties, composition, structure, and the changes it undergoes during chemical reactions.</p>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #3498db; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Science Stream</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">SS1, SS2, SS3</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 13 Books</span>
                                    <span><i class="fas fa-video"></i> 58 Videos</span>
                                    <span><i class="fas fa-users"></i> 1,654 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('chemistry')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('chemistry')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('chemistry')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>

                            <!-- Biology Subject -->
                            <div class="subject-card" data-stream="Science,Humanities,Business" data-class="SS1,SS2,SS3" style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #27ae60, #2ecc71); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-dna"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">Biology</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">Study of living organisms, their structure, function, growth, evolution, and distribution.</p>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #27ae60; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Multi-Stream</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">SS1, SS2, SS3</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 11 Books</span>
                                    <span><i class="fas fa-video"></i> 52 Videos</span>
                                    <span><i class="fas fa-users"></i> 2,123 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('biology')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('biology')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('biology')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>

                            <!-- Economics Subject (Multi-stream) -->
                            <div class="subject-card" data-stream="Science,Humanities,Business" data-class="SS1,SS2,SS3" style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #f39c12, #e67e22); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-chart-line"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">Economics</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">Study of production, distribution, and consumption of goods and services in society.</p>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #f39c12; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Multi-Stream</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">SS1, SS2, SS3</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 9 Books</span>
                                    <span><i class="fas fa-video"></i> 28 Videos</span>
                                    <span><i class="fas fa-users"></i> 1,834 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('economics')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('economics')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('economics')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>

                            <!-- ARTS STREAM SECTION -->
                            <div style="grid-column: 1 / -1; margin-top: 2rem; margin-bottom: 0.5rem;">
                                <h3 style="color: #8e44ad; font-size: 1.2rem; border-left: 4px solid #8e44ad; padding-left: 1rem; margin: 0;">
                                     Humanities Stream Subjects
                                </h3>
                            </div>
                            
                            <!-- Literature-in-English Subject -->
                            <div class="subject-card" data-stream="Humanities" data-class="SS1,SS2,SS3" style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #8e44ad, #9b59b6); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-feather-alt"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">Literature-in-English</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">Study of literary works including poetry, prose, and drama from various periods and cultures.</p>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #8e44ad; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Humanities Stream</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">SS1, SS2, SS3</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 7 Books</span>
                                    <span><i class="fas fa-video"></i> 35 Videos</span>
                                    <span><i class="fas fa-users"></i> 1,456 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('literature')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('literature')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('literature')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>

                            <!-- Government Subject -->
                            <div class="subject-card" data-stream="Humanities" data-class="SS1,SS2,SS3" style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #34495e, #2c3e50); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-university"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">Government</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">Study of political systems, governance, public administration, and political theory.</p>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #34495e; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Humanities Stream</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">SS1, SS2, SS3</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 8 Books</span>
                                    <span><i class="fas fa-video"></i> 31 Videos</span>
                                    <span><i class="fas fa-users"></i> 1,298 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('government')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('government')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('government')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>

                            <!-- COMMERCE STREAM SECTION -->
                            <div style="grid-column: 1 / -1; margin-top: 2rem; margin-bottom: 0.5rem;">
                                <h3 style="color: #e67e22; font-size: 1.2rem; border-left: 4px solid #e67e22; padding-left: 1rem; margin: 0;">
                                     Business Stream Subjects
                                </h3>
                            </div>
                            
                            <!-- Commerce Subject -->
                            <div class="subject-card" data-stream="Business" data-class="SS1,SS2,SS3" style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #e67e22, #d35400); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-handshake"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">Commerce</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">Study of trade, business activities, marketing, and commercial practices.</p>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #e67e22; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Business Stream</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">SS1, SS2, SS3</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 10 Books</span>
                                    <span><i class="fas fa-video"></i> 42 Videos</span>
                                    <span><i class="fas fa-users"></i> 1,567 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('commerce')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('commerce')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('commerce')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>

                            <!-- Accounts Subject -->
                            <div class="subject-card" data-stream="Business" data-class="SS1,SS2,SS3" style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #16a085, #1abc9c); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-calculator"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">Accounts</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">Study of financial accounting, bookkeeping, and financial statement preparation.</p>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #16a085; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Business Stream</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">SS1, SS2, SS3</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 9 Books</span>
                                    <span><i class="fas fa-video"></i> 38 Videos</span>
                                    <span><i class="fas fa-users"></i> 1,345 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('accounts')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('accounts')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('accounts')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>

                            <!-- CRS Subject (Humanities) -->
                            <div class="subject-card" data-stream="Humanities" data-class="SS1,SS2,SS3" style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #c0392b, #e74c3c); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-cross"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">Christian Religious Studies (CRS)</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">Study of Christian teachings, Bible studies, and religious principles.</p>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #c0392b; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Humanities Stream</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">SS1, SS2, SS3</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 6 Books</span>
                                    <span><i class="fas fa-video"></i> 22 Videos</span>
                                    <span><i class="fas fa-users"></i> 987 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('crs')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('crs')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('crs')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>

                            <!-- ========== JAMB SUBJECTS ========== -->
                            <div style="grid-column: 1 / -1; margin-top: 3rem; margin-bottom: 1rem;">
                                <h2 style="color: var(--primary-color); font-size: 1.5rem; border-bottom: 3px solid var(--primary-color); padding-bottom: 0.75rem; margin-bottom: 0.5rem;">
                                    <i class="fas fa-graduation-cap"></i> JAMB University Entrance Subjects
                                </h2>
                                <p style="color: var(--text-secondary); margin: 0.5rem 0 0 0; font-size: 0.95rem;">
                                    Subject combinations for JAMB university entrance examinations
                                </p>
                            </div>

                            <!-- JAMB Science Combination -->
                            <div class="subject-card" data-stream="JAMB" data-class="JAMB" data-department="Science" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-md); border: 2px solid #9b59b6; transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #9b59b6, #8e44ad); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-atom"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">JAMB - Science Combination</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">JAMB subject combination for Science students preparing for university entrance.</p>
                                    </div>
                                </div>
                                <div style="background: white; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                                    <h4 style="margin: 0 0 0.5rem 0; color: var(--primary-color); font-size: 0.9rem;">Required Subjects:</h4>
                                    <ul style="margin: 0; padding-left: 1.5rem; color: var(--text-secondary); font-size: 0.85rem;">
                                        <li><strong>English Language</strong> (Compulsory)</li>
                                        <li>Choose 3 from: <strong>Mathematics, Physics, Chemistry, Biology, Economics</strong></li>
                                    </ul>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #9b59b6; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">JAMB</span>
                                    <span style="background: var(--info-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Science</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 25 Books</span>
                                    <span><i class="fas fa-video"></i> 120 Videos</span>
                                    <span><i class="fas fa-users"></i> 3,456 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('jamb-science')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('jamb-science')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('jamb-science')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>

                            <!-- JAMB Humanities Combination -->
                            <div class="subject-card" data-stream="JAMB" data-class="JAMB" data-department="Humanities" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-md); border: 2px solid #8e44ad; transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #8e44ad, #9b59b6); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-feather-alt"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">JAMB - Humanities Combination</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">JAMB subject combination for Humanities students preparing for university entrance.</p>
                                    </div>
                                </div>
                                <div style="background: white; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                                    <h4 style="margin: 0 0 0.5rem 0; color: var(--primary-color); font-size: 0.9rem;">Required Subjects:</h4>
                                    <ul style="margin: 0; padding-left: 1.5rem; color: var(--text-secondary); font-size: 0.85rem;">
                                        <li><strong>English Language</strong> (Compulsory)</li>
                                        <li><strong>Mathematics</strong> (Compulsory)</li>
                                        <li>Choose 2 from: <strong>Literature-in-English, Government, Economics, CRS</strong></li>
                                    </ul>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #8e44ad; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">JAMB</span>
                                    <span style="background: var(--info-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Humanities</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 18 Books</span>
                                    <span><i class="fas fa-video"></i> 95 Videos</span>
                                    <span><i class="fas fa-users"></i> 2,876 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('jamb-arts')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('jamb-arts')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('jamb-arts')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>

                            <!-- JAMB Business Combination -->
                            <div class="subject-card" data-stream="JAMB" data-class="JAMB" data-department="Commerce" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-md); border: 2px solid #e67e22; transition: all 0.3s ease;">
                                <div style="display: flex; align-items: flex-start; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #e67e22, #d35400); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                                        <i class="fas fa-handshake"></i>
                                    </div>
                                    <div style="flex: 1;">
                                        <h3 style="margin: 0 0 0.5rem 0; color: var(--text-primary); font-size: 1.1rem;">JAMB - Business Combination</h3>
                                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.4;">JAMB subject combination for Business students preparing for university entrance.</p>
                                    </div>
                                </div>
                                <div style="background: white; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                                    <h4 style="margin: 0 0 0.5rem 0; color: var(--primary-color); font-size: 0.9rem;">Required Subjects:</h4>
                                    <ul style="margin: 0; padding-left: 1.5rem; color: var(--text-secondary); font-size: 0.85rem;">
                                        <li><strong>English Language</strong> (Compulsory)</li>
                                        <li>Choose 3 from: <strong>Mathematics, Economics, Commerce, Accounts</strong></li>
                                    </ul>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="background: #e67e22; color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">JAMB</span>
                                    <span style="background: var(--info-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Business</span>
                                    <span style="background: var(--success-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;">Active</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                    <span><i class="fas fa-book"></i> 20 Books</span>
                                    <span><i class="fas fa-video"></i> 105 Videos</span>
                                    <span><i class="fas fa-users"></i> 2,654 Students</span>
                                </div>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button class="btn btn-sm" onclick="window.adminDashboard.viewSubjectContent('jamb-commercial')" style="background: var(--primary-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-eye"></i> View Content
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.editSubject('jamb-commercial')" style="background: var(--warning-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="btn btn-sm" onclick="window.adminDashboard.deleteSubject('jamb-commercial')" style="background: var(--danger-color); color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">
                                        <i class="fas fa-trash"></i> Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="assessments-section" class="page-section">
                    <div class="fade-in">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <div>
                                <h2>Assessment Management</h2>
                                <p style="color: var(--text-secondary); margin: 0.5rem 0 0 0;">Create and manage quizzes, assignments, and mock exams</p>
                            </div>
                        </div>

                        <!-- Assessment Stats -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #3b82f6, #2563eb);">
                                    <i class="fas fa-clipboard-list"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="quizzes-count">0</div>
                                    <div class="stat-label">Total Quizzes</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                    <i class="fas fa-tasks"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="assignments-count">0</div>
                                    <div class="stat-label">Assignments</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="exams-count">0</div>
                                    <div class="stat-label">Mock Exams</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                                    <i class="fas fa-question-circle"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="questions-count">0</div>
                                    <div class="stat-label">Total Questions</div>
                                </div>
                            </div>
                        </div>

                        <!-- Assessment Tabs -->
                        <div style="display: flex; background: var(--card-bg); border-radius: 12px; padding: 0.5rem; margin-bottom: 2rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color);">
                            <button class="assessment-tab-btn active" onclick="switchAssessmentTab('quizzes')" style="flex: 1; padding: 1rem 1.5rem; background: var(--primary-gradient); color: var(--white); border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; gap: 0.5rem; box-shadow: var(--shadow-sm);">
                                <i class="fas fa-clipboard-list"></i>
                                Quizzes
                            </button>
                            <button class="assessment-tab-btn" onclick="switchAssessmentTab('assignments')" style="flex: 1; padding: 1rem 1.5rem; background: none; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; gap: 0.5rem; color: var(--text-secondary);">
                                <i class="fas fa-tasks"></i>
                                Assignments
                            </button>
                            <button class="assessment-tab-btn" onclick="switchAssessmentTab('exams')" style="flex: 1; padding: 1rem 1.5rem; background: none; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; gap: 0.5rem; color: var(--text-secondary);">
                                <i class="fas fa-file-alt"></i>
                                Mock Exams
                            </button>
                        </div>

                        <!-- Quizzes Tab -->
                        <div id="quizzes-assessment-tab" class="assessment-tab-content active">
                            <div style="background: var(--card-bg); border-radius: 12px; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); overflow: hidden;">
                                <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color); background: var(--gray-50); display: flex; justify-content: space-between; align-items: center;">
                                    <h3 style="margin: 0; color: var(--text-primary); font-size: 1.25rem;">Quizzes</h3>
                                    <button class="btn btn-primary" onclick="(function(){const m=document.getElementById('assessment-modal');if(m){m.style.display='flex';m.classList.add('active');document.getElementById('assessment-modal-title').textContent='Create Quiz';document.getElementById('assessment-type').value='quiz';document.getElementById('assessment-form').reset();}})()">
                                        <i class="fas fa-plus"></i>
                                        Create Quiz
                                    </button>
                                </div>
                                
                                <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color);">
                                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 1rem; align-items: end;">
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Search Quizzes</label>
                                            <div style="position: relative;">
                                                <i class="fas fa-search" style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
                                                <input type="text" id="quiz-search" placeholder="Search by title or subject..." style="width: 100%; padding: 0.75rem 0.75rem 0.75rem 2.5rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                                            </div>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Class Level</label>
                                            <select id="quiz-class-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Classes</option>
                                                <option value="SS1">SS1</option>
                                                <option value="SS2">SS2</option>
                                                <option value="SS3">SS3</option>
                                                <option value="JAMB">JAMB</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Stream</label>
                                            <select id="quiz-stream-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Streams</option>
                                                <option value="Science">Science</option>
                                                <option value="Business">Business</option>
                                                <option value="Humanities">Humanities</option>
                                                <option value="General">General</option>
                                                <option value="JAMB">JAMB</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Subject</label>
                                            <select id="quiz-subject-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Subjects</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div id="quizzes-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem; padding: 1.5rem;">
                                    <div class="empty-state" style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: var(--text-secondary);">
                                        <i class="fas fa-clipboard-list" style="font-size: 3rem; margin-bottom: 1rem; color: var(--border-color);"></i>
                                        <h3 style="margin: 0 0 0.5rem 0;">No quizzes yet</h3>
                                        <p style="margin: 0;">Click "Create Quiz" to get started</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Assignments Tab -->
                        <div id="assignments-assessment-tab" class="assessment-tab-content">
                            <div style="background: var(--card-bg); border-radius: 12px; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); overflow: hidden;">
                                <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color); background: var(--gray-50); display: flex; justify-content: space-between; align-items: center;">
                                    <h3 style="margin: 0; color: var(--text-primary); font-size: 1.25rem;">Assignments</h3>
                                    <button class="btn btn-primary" onclick="(function(){const m=document.getElementById('assessment-modal');if(m){m.style.display='flex';m.classList.add('active');document.getElementById('assessment-modal-title').textContent='Create Assignment';document.getElementById('assessment-type').value='assignment';document.getElementById('assessment-form').reset();}})()">
                                        <i class="fas fa-plus"></i>
                                        Create Assignment
                                    </button>
                                </div>
                                
                                <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color);">
                                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 1rem; align-items: end;">
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Search Assignments</label>
                                            <div style="position: relative;">
                                                <i class="fas fa-search" style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
                                                <input type="text" id="assignment-search" placeholder="Search by title or subject..." style="width: 100%; padding: 0.75rem 0.75rem 0.75rem 2.5rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                                            </div>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Class Level</label>
                                            <select id="assignment-class-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Classes</option>
                                                <option value="SS1">SS1</option>
                                                <option value="SS2">SS2</option>
                                                <option value="SS3">SS3</option>
                                                <option value="JAMB">JAMB</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Stream</label>
                                            <select id="assignment-stream-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Streams</option>
                                                <option value="Science">Science</option>
                                                <option value="Business">Business</option>
                                                <option value="Humanities">Humanities</option>
                                                <option value="General">General</option>
                                                <option value="JAMB">JAMB</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Subject</label>
                                            <select id="assignment-subject-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Subjects</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div id="assignments-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem; padding: 1.5rem;">
                                    <div class="empty-state" style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: var(--text-secondary);">
                                        <i class="fas fa-tasks" style="font-size: 3rem; margin-bottom: 1rem; color: var(--border-color);"></i>
                                        <h3 style="margin: 0 0 0.5rem 0;">No assignments yet</h3>
                                        <p style="margin: 0;">Click "Create Assignment" to get started</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Mock Exams Tab -->
                        <div id="exams-assessment-tab" class="assessment-tab-content">
                            <div style="background: var(--card-bg); border-radius: 12px; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); overflow: hidden;">
                                <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color); background: var(--gray-50); display: flex; justify-content: space-between; align-items: center;">
                                    <h3 style="margin: 0; color: var(--text-primary); font-size: 1.25rem;">Mock Exams</h3>
                                    <button class="btn btn-primary" onclick="(function(){const m=document.getElementById('assessment-modal');if(m){m.style.display='flex';m.classList.add('active');document.getElementById('assessment-modal-title').textContent='Create Mock Exam';document.getElementById('assessment-type').value='exam';document.getElementById('assessment-form').reset();}})()">
                                        <i class="fas fa-plus"></i>
                                        Create Mock Exam
                                    </button>
                                </div>
                                
                                <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color);">
                                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 1rem; align-items: end;">
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Search Exams</label>
                                            <div style="position: relative;">
                                                <i class="fas fa-search" style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
                                                <input type="text" id="exam-search" placeholder="Search by title or subject..." style="width: 100%; padding: 0.75rem 0.75rem 0.75rem 2.5rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                                            </div>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Class Level</label>
                                            <select id="exam-class-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Classes</option>
                                                <option value="SS1">SS1</option>
                                                <option value="SS2">SS2</option>
                                                <option value="SS3">SS3</option>
                                                <option value="JAMB">JAMB</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Stream</label>
                                            <select id="exam-stream-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Streams</option>
                                                <option value="Science">Science</option>
                                                <option value="Business">Business</option>
                                                <option value="Humanities">Humanities</option>
                                                <option value="General">General</option>
                                                <option value="JAMB">JAMB</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Subject</label>
                                            <select id="exam-subject-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                                <option value="">All Subjects</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div id="exams-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem; padding: 1.5rem;">
                                    <div class="empty-state" style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: var(--text-secondary);">
                                        <i class="fas fa-file-alt" style="font-size: 3rem; margin-bottom: 1rem; color: var(--border-color);"></i>
                                        <h3 style="margin: 0 0 0.5rem 0;">No mock exams yet</h3>
                                        <p style="margin: 0;">Click "Create Mock Exam" to get started</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="live-classes-section" class="page-section">
                    <div class="fade-in">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <div>
                                <h2>Live Class Management</h2>
                                <p style="color: var(--text-secondary); margin: 0.5rem 0 0 0;">Schedule and manage live classes for students</p>
                            </div>
                            <button class="btn btn-primary" onclick="window.adminDashboard.openLiveClassModal()">
                                <i class="fas fa-plus"></i>
                                Schedule Live Class
                            </button>
                        </div>

                        <!-- Live Class Stats -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                                    <i class="fas fa-video"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="live-classes-count">0</div>
                                    <div class="stat-label">Total Classes</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="upcoming-classes-count">0</div>
                                    <div class="stat-label">Upcoming</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #3b82f6, #2563eb);">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="completed-classes-count">0</div>
                                    <div class="stat-label">Completed</div>
                                </div>
                            </div>
                        </div>

                        <!-- Filters -->
                        <div style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color);">
                            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 1rem; align-items: end;">
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Search Classes</label>
                                    <div style="position: relative;">
                                        <i class="fas fa-search" style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
                                        <input type="text" id="liveclass-search" placeholder="Search by title or subject..." style="width: 100%; padding: 0.75rem 0.75rem 0.75rem 2.5rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                                    </div>
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Class Level</label>
                                    <select id="liveclass-class-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                        <option value="">All Classes</option>
                                        <option value="SS1">SS1</option>
                                        <option value="SS2">SS2</option>
                                        <option value="SS3">SS3</option>
                                        <option value="JAMB">JAMB</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Subject</label>
                                    <select id="liveclass-subject-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                        <option value="">All Subjects</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Status</label>
                                    <select id="liveclass-status-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                        <option value="">All Status</option>
                                        <option value="upcoming">Upcoming</option>
                                        <option value="completed">Completed</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Live Classes Grid -->
                        <div id="live-classes-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem;">
                            <div class="empty-state" style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: var(--text-secondary);">
                                <i class="fas fa-video" style="font-size: 3rem; margin-bottom: 1rem; color: var(--border-color);"></i>
                                <h3 style="margin: 0 0 0.5rem 0;">No live classes scheduled</h3>
                                <p style="margin: 0;">Click "Schedule Live Class" to get started</p>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="analytics-section" class="page-section">
                    <div class="fade-in">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <div>
                                <h2>Reports & Analytics</h2>
                                <p style="color: var(--text-secondary); margin: 0.5rem 0 0 0;">View student performance and attendance reports</p>
                            </div>
                            <button class="btn btn-primary" onclick="window.adminDashboard.generateReports()">
                                <i class="fas fa-sync"></i>
                                Refresh Reports
                            </button>
                        </div>

                        <!-- Report Stats -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #3b82f6, #2563eb);">
                                    <i class="fas fa-clipboard-list"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="avg-quiz-percent">0%</div>
                                    <div class="stat-label">Avg Quiz Score</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                    <i class="fas fa-tasks"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="avg-assignment-percent">0%</div>
                                    <div class="stat-label">Avg Assignment Score</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="avg-exam-percent">0%</div>
                                    <div class="stat-label">Avg Mock Exam Score</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                                    <i class="fas fa-user-check"></i>
                                </div>
                                <div class="stat-info">
                                    <div class="stat-number" id="avg-attendance-percent">0%</div>
                                    <div class="stat-label">Avg Attendance</div>
                                </div>
                            </div>
                        </div>

                        <!-- Report Filters -->
                        <div style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color);">
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 1rem; align-items: end;">
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Class Level</label>
                                    <select id="report-class-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                        <option value="">All Classes</option>
                                        <option value="SS1">SS1</option>
                                        <option value="SS2">SS2</option>
                                        <option value="SS3">SS3</option>
                                        <option value="JAMB">JAMB</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Stream</label>
                                    <select id="report-stream-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                        <option value="">All Streams</option>
                                        <option value="General">General</option>
                                        <option value="Science">Science</option>
                                        <option value="Humanities">Humanities</option>
                                        <option value="Business">Business</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Subject</label>
                                    <select id="report-subject-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                        <option value="">All Subjects</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">Report Type</label>
                                    <select id="report-type-filter" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white); cursor: pointer;">
                                        <option value="">All Reports</option>
                                        <option value="quiz">Quiz Reports</option>
                                        <option value="assignment">Assignment Reports</option>
                                        <option value="exam">Mock Exam Reports</option>
                                        <option value="attendance">Attendance Reports</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Student Scores Spreadsheet -->
                        <div style="background: var(--card-bg); border-radius: 12px; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); overflow: hidden; margin-bottom: 2rem;">
                            <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color); background: var(--gray-50); display: flex; justify-content: space-between; align-items: center;">
                                <h3 style="margin: 0; color: var(--text-primary); font-size: 1.25rem;">
                                    <i class="fas fa-table"></i> Student Scores Spreadsheet
                                </h3>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button class="btn btn-secondary" onclick="window.adminDashboard.exportSpreadsheet()">
                                        <i class="fas fa-download"></i> Export
                                    </button>
                                    <button class="btn btn-primary" onclick="window.adminDashboard.addStudentRow()">
                                        <i class="fas fa-plus"></i> Add Student
                                    </button>
                                    <button class="btn" onclick="window.adminDashboard.deleteAllStudents()" style="background: var(--danger-color); color: white;">
                                        <i class="fas fa-trash-alt"></i> Delete All
                                    </button>
                                </div>
                            </div>

                            <!-- Spreadsheet Filters -->
                            <div style="padding: 1rem; border-bottom: 1px solid var(--border-color); background: var(--white);">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.75rem;">
                                    <div style="position: relative;">
                                        <i class="fas fa-search" style="position: absolute; left: 0.75rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary); font-size: 0.875rem;"></i>
                                        <input type="text" id="spreadsheet-search" placeholder="Search by name..." style="width: 100%; padding: 0.5rem 0.5rem 0.5rem 2rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.875rem;">
                                    </div>
                                    <select id="spreadsheet-class-filter" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; background: var(--white);">
                                        <option value="">All Classes</option>
                                        <option value="SS1">SS1</option>
                                        <option value="SS2">SS2</option>
                                        <option value="SS3">SS3</option>
                                        <option value="JAMB">JAMB</option>
                                    </select>
                                    <select id="spreadsheet-stream-filter" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; background: var(--white);">
                                        <option value="">All Streams</option>
                                        <option value="Science">Science</option>
                                        <option value="Humanities">Humanities</option>
                                        <option value="Business">Business</option>
                                    </select>
                                    <select id="spreadsheet-subject-filter" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; background: var(--white);">
                                        <option value="">All Subjects</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Spreadsheet Table -->
                            <div style="overflow-x: auto; max-height: 600px; overflow-y: auto;">
                                <table id="scores-spreadsheet" style="width: 100%; border-collapse: collapse; font-size: 0.875rem;">
                                    <thead style="position: sticky; top: 0; background: var(--gray-50); z-index: 10;">
                                        <tr id="spreadsheet-header-row">
                                            <th style="padding: 0.75rem; text-align: left; border-bottom: 2px solid var(--border-color); font-weight: 600; white-space: nowrap;">Student Name</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600; white-space: nowrap;">Class</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600; white-space: nowrap;">Stream</th>
                                            <!-- Subject headers will be dynamically generated -->
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600; white-space: nowrap;">Attendance</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600; white-space: nowrap; background: var(--primary-color); color: white;">Average</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600; white-space: nowrap; background: var(--success-color); color: white;">Grade</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600; white-space: nowrap; width: 100px;">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="spreadsheet-body">
                                        <tr>
                                            <td colspan="13" style="padding: 3rem; text-align: center; color: var(--text-secondary);">
                                                <i class="fas fa-table" style="font-size: 2rem; margin-bottom: 0.5rem; display: block; color: var(--border-color);"></i>
                                                No student data yet. Click "Add Student" to get started.
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Leaderboard Table -->
                        <div style="background: var(--card-bg); border-radius: 12px; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); overflow: hidden; margin-bottom: 2rem;">
                            <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color); background: linear-gradient(135deg, #f59e0b, #d97706); color: white;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h3 style="margin: 0; font-size: 1.25rem;">
                                            <i class="fas fa-trophy"></i> Top Performers Leaderboard
                                        </h3>
                                        <p style="margin: 0.5rem 0 0 0; font-size: 0.875rem; opacity: 0.9;">Students ranked by average score</p>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                                        <select id="leaderboard-class-filter" onchange="window.adminDashboard.renderLeaderboard()" style="padding: 0.5rem; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; font-size: 0.875rem; background: white; color: black; cursor: pointer; font-weight: 600;">
                                            <option value="">All Classes</option>
                                            <option value="SS1">SS1</option>
                                            <option value="SS2">SS2</option>
                                            <option value="SS3">SS3</option>
                                            <option value="JAMB">JAMB</option>
                                        </select>
                                        <button onclick="window.adminDashboard.autoGenerateLeaderboardBadges()" style="padding: 0.5rem 1rem; background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; cursor: pointer; font-size: 0.875rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem;">
                                            <i class="fas fa-magic"></i> Auto Generate
                                        </button>
                                        <button onclick="window.adminDashboard.clearLeaderboard()" style="padding: 0.5rem 1rem; background: #ef4444; color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; cursor: pointer; font-size: 0.875rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem;">
                                            <i class="fas fa-trash-alt"></i> Clear All
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div style="overflow-x: auto;">
                                <table style="width: 100%; border-collapse: collapse; font-size: 0.875rem;">
                                    <thead style="background: var(--gray-50);">
                                        <tr>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600; width: 60px;">Rank</th>
                                            <th style="padding: 0.75rem; text-align: left; border-bottom: 2px solid var(--border-color); font-weight: 600;">Student Name</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Class</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Stream</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Average Score</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Attendance</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Badge</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600; width: 80px;">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="leaderboard-body">
                                        <tr>
                                            <td colspan="7" style="padding: 3rem; text-align: center; color: var(--text-secondary);">
                                                <i class="fas fa-trophy" style="font-size: 2rem; margin-bottom: 0.5rem; display: block; color: var(--border-color);"></i>
                                                Leaderboard will be populated from student scores
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Badges & Achievements Table -->
                        <div style="background: var(--card-bg); border-radius: 12px; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); overflow: hidden;">
                            <div style="padding: 1.5rem; border-bottom: 1px solid var(--border-color); background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h3 style="margin: 0; font-size: 1.25rem;">
                                            <i class="fas fa-medal"></i> Student Badges & Achievements
                                        </h3>
                                        <p style="margin: 0.5rem 0 0 0; font-size: 0.875rem; opacity: 0.9;">Earned badges based on performance</p>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                                        <select id="badges-class-filter" onchange="window.adminDashboard.renderBadges()" style="padding: 0.5rem; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; font-size: 0.875rem; background: white; color: black; cursor: pointer; font-weight: 600;">
                                            <option value="">All Classes</option>
                                            <option value="SS1">SS1</option>
                                            <option value="SS2">SS2</option>
                                            <option value="SS3">SS3</option>
                                            <option value="JAMB">JAMB</option>
                                        </select>
                                        <button onclick="window.adminDashboard.autoGenerateBadges()" style="padding: 0.5rem 1rem; background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; cursor: pointer; font-size: 0.875rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem;">
                                            <i class="fas fa-magic"></i> Auto Generate
                                        </button>
                                        <button onclick="window.adminDashboard.clearBadges()" style="padding: 0.5rem 1rem; background: #ef4444; color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; cursor: pointer; font-size: 0.875rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem;">
                                            <i class="fas fa-trash-alt"></i> Clear All
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div style="overflow-x: auto;">
                                <table style="width: 100%; border-collapse: collapse; font-size: 0.875rem;">
                                    <thead style="background: var(--gray-50);">
                                        <tr>
                                            <th style="padding: 0.75rem; text-align: left; border-bottom: 2px solid var(--border-color); font-weight: 600;">Student Name</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Class</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Performance Badge</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Attendance Badge</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Subject Excellence</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Total Badges</th>
                                            <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600; width: 80px;">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="badges-body">
                                        <tr>
                                            <td colspan="6" style="padding: 3rem; text-align: center; color: var(--text-secondary);">
                                                <i class="fas fa-medal" style="font-size: 2rem; margin-bottom: 0.5rem; display: block; color: var(--border-color);"></i>
                                                Badges will be awarded based on student performance
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="settings-section" class="page-section">
                    <div class="fade-in">
                        <!-- Users Management Section -->
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <div>
                                <h2>Subscription Management</h2>
                                <p style="color: var(--text-secondary); margin: 0.5rem 0 0 0;">Manage user subscriptions, plans, and account status</p>
                            </div>
                            <div style="display: flex; gap: 0.75rem;">
                                <button class="btn btn-secondary" onclick="refreshUsersTable()" title="Sync users from signups and refresh table">
                                    <i class="fas fa-sync-alt"></i>
                                    Sync Users
                                </button>
                                <button class="btn btn-primary" onclick="openSubscriptionModal()">
                                    <i class="fas fa-crown"></i>
                                    Manage Subscription
                                </button>
                            </div>
                        </div>

                        <!-- Users Filter -->
                            <div style="background: var(--card-bg); border-radius: 12px; padding: 1rem; margin-bottom: 1.5rem; border: 1px solid var(--border-color);">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem;">
                                    <div style="position: relative;">
                                        <i class="fas fa-search" style="position: absolute; left: 0.75rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary); font-size: 0.875rem;"></i>
                                        <input type="text" id="users-search" placeholder="Search users..." onkeyup="filterUsers()" style="width: 100%; padding: 0.5rem 0.5rem 0.5rem 2rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.875rem;">
                                    </div>
                                    <select id="users-status-filter" onchange="filterUsers()" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; background: var(--white);">
                                        <option value="">All Status</option>
                                        <option value="bootcamp">Free Bootcamp</option>
                                        <option value="active">Active Subscription</option>
                                        <option value="expired">Expired/Locked</option>
                                    </select>
                                    <select id="users-plan-filter" onchange="filterUsers()" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; background: var(--white);">
                                        <option value="">All Plans</option>
                                        <option value="none">No Plan</option>
                                        <option value="30">30-Day Plan</option>
                                        <option value="60">60-Day Plan</option>
                                        <option value="90">90-Day Plan</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Users Table -->
                            <div style="background: var(--card-bg); border-radius: 12px; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); overflow: hidden;">
                                <div style="overflow-x: auto;">
                                    <table style="width: 100%; border-collapse: collapse; font-size: 0.875rem;">
                                        <thead style="background: var(--gray-50);">
                                            <tr>
                                                <th style="padding: 0.75rem; text-align: left; border-bottom: 2px solid var(--border-color); font-weight: 600;">User Name</th>
                                                <th style="padding: 0.75rem; text-align: left; border-bottom: 2px solid var(--border-color); font-weight: 600;">Email</th>
                                                <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Role</th>
                                                <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Status</th>
                                                <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Payment Status</th>
                                                <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Plan</th>
                                                <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Plan Type</th>
                                                <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Expiry Date</th>
                                                <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid var(--border-color); font-weight: 600;">Account Lock</th>
                                            </tr>
                                        </thead>
                                        <tbody id="users-table-body">
                                            <tr>
                                                <td colspan="8" style="padding: 3rem; text-align: center; color: var(--text-secondary);">
                                                    <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 0.5rem; display: block; color: var(--border-color);"></i>
                                                    No users yet. Click "Add User" to get started.
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Community & Announcements Section -->
                <section id="community-page" class="page-section" style="display: none;">
                    <div class="section-container">
                        <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <div>
                                <h2><i class="fas fa-bullhorn" style="color: var(--primary-color); margin-right: 0.5rem;"></i>Community & Announcements</h2>
                                <p style="color: var(--text-secondary); margin: 0.5rem 0 0 0;">Manage community links and broadcast announcements to users</p>
                            </div>
                        </div>

                        <!-- Community Links Section -->
                        <div style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                                <h3 style="margin: 0; font-size: 1.25rem; color: var(--text-primary);">
                                    <i class="fas fa-link" style="color: var(--info-color); margin-right: 0.5rem;"></i>
                                    Community Links
                                </h3>
                                <button onclick="window.saveCommunityLinks()" class="btn btn-primary" style="padding: 0.5rem 1rem; font-size: 0.875rem;">
                                    <i class="fas fa-save"></i> Save Links
                                </button>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                <!-- WhatsApp Group -->
                                <div style="background: var(--white); padding: 1.5rem; border-radius: 8px; border: 2px solid var(--border-color);">
                                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">
                                        <i class="fab fa-whatsapp" style="font-size: 2rem; color: #25D366; margin-right: 0.75rem;"></i>
                                        <div>
                                            <h4 style="margin: 0; font-size: 1rem;">WhatsApp Group</h4>
                                            <p style="margin: 0.25rem 0 0 0; font-size: 0.75rem; color: var(--text-secondary);">Community discussion group</p>
                                        </div>
                                    </div>
                                    <input type="url" id="whatsapp-link" placeholder="https://chat.whatsapp.com/..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; margin-bottom: 0.5rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <input type="checkbox" id="whatsapp-enabled" style="width: 18px; height: 18px; cursor: pointer;">
                                        <label for="whatsapp-enabled" style="font-size: 0.875rem; cursor: pointer;">Enable WhatsApp link</label>
                                    </div>
                                </div>

                                <!-- Telegram Channel -->
                                <div style="background: var(--white); padding: 1.5rem; border-radius: 8px; border: 2px solid var(--border-color);">
                                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">
                                        <i class="fab fa-telegram" style="font-size: 2rem; color: #0088cc; margin-right: 0.75rem;"></i>
                                        <div>
                                            <h4 style="margin: 0; font-size: 1rem;">Telegram Channel</h4>
                                            <p style="margin: 0.25rem 0 0 0; font-size: 0.75rem; color: var(--text-secondary);">Updates and announcements</p>
                                        </div>
                                    </div>
                                    <input type="url" id="telegram-link" placeholder="https://t.me/..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; margin-bottom: 0.5rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <input type="checkbox" id="telegram-enabled" style="width: 18px; height: 18px; cursor: pointer;">
                                        <label for="telegram-enabled" style="font-size: 0.875rem; cursor: pointer;">Enable Telegram link</label>
                                    </div>
                                </div>
                            </div>

                            <!-- Target Users Section -->
                            <div style="margin-top: 1.5rem; padding: 1.5rem; background: var(--white); border-radius: 8px; border: 2px solid var(--border-color);">
                                <h4 style="margin: 0 0 1rem 0; font-size: 1rem; color: var(--text-primary); display: flex; align-items: center; gap: 0.5rem;">
                                    <i class="fas fa-users" style="color: var(--primary-color);"></i>
                                    Send Links to Specific Users
                                </h4>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                                    <!-- User Type -->
                                    <div>
                                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">
                                            <i class="fas fa-user-tag"></i> User Type
                                        </label>
                                        <select id="community-user-type" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; background: var(--white);">
                                            <option value="all">All Users</option>
                                            <option value="students">Students Only</option>
                                            <option value="parents">Parents Only</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Class Level -->
                                    <div>
                                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">
                                            <i class="fas fa-graduation-cap"></i> Class Level
                                        </label>
                                        <select id="community-class-level" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; background: var(--white);">
                                            <option value="all">All Classes</option>
                                            <option value="SS1">SS1</option>
                                            <option value="SS2">SS2</option>
                                            <option value="SS3">SS3</option>
                                            <option value="JAMB">JAMB</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Subscription Status -->
                                    <div>
                                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">
                                            <i class="fas fa-crown"></i> Subscription
                                        </label>
                                        <select id="community-subscription" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; background: var(--white);">
                                            <option value="all">All Subscribers</option>
                                            <option value="active">Active Only</option>
                                            <option value="bootcamp">Bootcamp Only</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Target Count Display -->
                                <div id="community-user-count" style="padding: 0.75rem; background: #F3F4F6; border-radius: 6px; margin-bottom: 1rem; text-align: center; font-size: 0.875rem; color: var(--text-secondary);">
                                    <i class="fas fa-users"></i> <span id="community-target-count">0</span> users will receive the community links
                                </div>
                                
                                <!-- Send Button -->
                                <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                                    <button onclick="window.sendCommunityLinks()" class="btn btn-primary" style="padding: 0.75rem 1.5rem;">
                                        <i class="fas fa-share-alt"></i> Send Community Links
                                    </button>
                                </div>
                            </div>

                            <div style="margin-top: 1rem; padding: 1rem; background: #EFF6FF; border-left: 4px solid var(--info-color); border-radius: 6px;">
                                <p style="margin: 0; font-size: 0.875rem; color: var(--text-primary);">
                                    <i class="fas fa-info-circle" style="color: var(--info-color); margin-right: 0.5rem;"></i>
                                    <strong>Tip:</strong> Save the links first, then select target users and click "Send Community Links" to notify them.
                                </p>
                            </div>
                        </div>

                        <!-- Broadcast Announcements Section -->
                        <div style="background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color);">
                            <div style="margin-bottom: 1.5rem;">
                                <h3 style="margin: 0; font-size: 1.25rem; color: var(--text-primary);">
                                    <i class="fas fa-megaphone" style="color: var(--warning-color); margin-right: 0.5rem;"></i>
                                    Broadcast Message
                                </h3>
                                <p style="margin: 0.5rem 0 0 0; font-size: 0.875rem; color: var(--text-secondary);">Send messages to specific user groups</p>
                            </div>

                            <div style="background: var(--white); padding: 1.5rem; border-radius: 8px; border: 2px solid var(--border-color);">
                                <!-- Message Input -->
                                <div style="margin-bottom: 1rem;">
                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">
                                        <i class="fas fa-comment-alt"></i> Broadcast Message *
                                    </label>
                                    <textarea id="broadcast-message" rows="4" placeholder="Type your message here..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; resize: vertical;"></textarea>
                                </div>

                                <!-- Filters -->
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                                    <!-- User Type -->
                                    <div>
                                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">
                                            <i class="fas fa-users"></i> Send To (User Type)
                                        </label>
                                        <select id="broadcast-user-type" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; background: var(--white);">
                                            <option value="all">All Users</option>
                                            <option value="students">Students Only</option>
                                            <option value="parents">Parents Only</option>
                                        </select>
                                    </div>

                                    <!-- Class Level -->
                                    <div>
                                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); font-size: 0.875rem;">
                                            <i class="fas fa-graduation-cap"></i> Class Level
                                        </label>
                                        <select id="broadcast-class-level" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; background: var(--white);">
                                            <option value="all">All Classes</option>
                                            <option value="SS1">SS1</option>
                                            <option value="SS2">SS2</option>
                                            <option value="SS3">SS3</option>
                                            <option value="JAMB">JAMB</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Recipient Count -->
                                <div id="broadcast-user-count" style="padding: 0.75rem; background: #F3F4F6; border-radius: 6px; margin-bottom: 1rem; text-align: center; font-size: 0.875rem; color: var(--text-secondary);">
                                    <i class="fas fa-users"></i> <span id="broadcast-target-count">0</span> users will receive this message
                                </div>

                                <!-- Send Button -->
                                <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                                    <button onclick="window.sendBroadcastMessage()" class="btn btn-primary" style="padding: 0.75rem 1.5rem;">
                                        <i class="fas fa-paper-plane"></i> Send Message
                                    </button>
                                </div>
                            </div>

                            <!-- Sent Messages History -->
                            <div style="margin-top: 1.5rem;">
                                <h4 style="margin: 0 0 1rem 0; font-size: 1rem; color: var(--text-primary); display: flex; align-items: center; gap: 0.5rem;">
                                    <i class="fas fa-history" style="color: var(--info-color);"></i>
                                    Sent Messages History
                                </h4>
                                <div id="announcements-list" style="display: flex; flex-direction: column; gap: 1rem;">
                                    <div style="text-align: center; padding: 2rem; color: var(--text-secondary); background: var(--white); border-radius: 8px; border: 2px solid var(--border-color);">
                                        <i class="fas fa-inbox" style="font-size: 2rem; margin-bottom: 0.5rem; display: block; color: var(--border-color);"></i>
                                        <p style="margin: 0; font-size: 0.875rem;">No messages sent yet.</p>
                                    </div>
                                </div>
                            </div>

                            <div style="margin-top: 1rem; padding: 1rem; background: #FEF3C7; border-left: 4px solid var(--warning-color); border-radius: 6px;">
                                <p style="margin: 0; font-size: 0.875rem; color: var(--text-primary);">
                                    <i class="fas fa-info-circle" style="color: var(--warning-color); margin-right: 0.5rem;"></i>
                                    <strong>Tip:</strong> Messages will be sent to all users matching the selected criteria. Make sure your message is clear and relevant.
                                </p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Profile Edit Modal -->
    <div id="profile-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div class="modal-content" style="background: var(--white); border-radius: 12px; padding: 2rem; max-width: 500px; width: 90%; box-shadow: var(--shadow-xl);">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border-color);">
                <h3 style="margin: 0; font-size: 1.5rem; color: var(--text-primary);">
                    <i class="fas fa-user-edit" style="color: var(--primary-color); margin-right: 0.5rem;"></i>
                    Edit Profile
                </h3>
                <button id="profile-modal-close-btn" onclick="window.closeProfileModal()" style="background: none; border: none; font-size: 1.5rem; color: var(--text-secondary); cursor: pointer; padding: 0.25rem; border-radius: 4px; transition: all 0.2s;">&times;</button>
            </div>
            <form id="profile-form">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Admin Name *</label>
                    <input type="text" id="profile-name" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;" placeholder="Enter admin name">
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Phone Number *</label>
                    <input type="tel" id="profile-phone" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;" placeholder="Enter phone number">
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Email Address *</label>
                    <input type="email" id="profile-email" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;" placeholder="Enter email address">
                </div>

                <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" onclick="window.closeProfileModal()" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Student Code Generation Modal -->
    <div id="student-code-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div class="modal-content" style="background: var(--white); border-radius: 12px; padding: 2rem; max-width: 500px; width: 90%; box-shadow: var(--shadow-xl);">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border-color);">
                <h3 style="margin: 0; font-size: 1.5rem; color: var(--text-primary);">
                    <i class="fas fa-id-card" style="color: var(--primary-color); margin-right: 0.5rem;"></i>
                    Generate Student Code
                </h3>
                <button onclick="window.closeStudentCodeModal()" style="background: none; border: none; font-size: 1.5rem; color: var(--text-secondary); cursor: pointer; padding: 0.25rem; border-radius: 4px; transition: all 0.2s;">&times;</button>
            </div>
            <form id="student-code-form">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Select Student *</label>
                    <select id="student-select" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                        <option value="">-- Select a student --</option>
                    </select>
                </div>

                <div id="existing-code-display" style="display: none; margin-bottom: 1rem; padding: 1rem; background: #FEF3C7; border-left: 4px solid #fbbf24; border-radius: 6px;">
                    <p style="margin: 0 0 0.5rem 0; font-weight: 600; color: #92400e; font-size: 0.875rem;">Existing Code:</p>
                    <p id="existing-code-value" style="margin: 0; font-size: 1.25rem; font-weight: 700; color: #1e3a8a; font-family: monospace;"></p>
                </div>

                <div style="margin-bottom: 1.5rem; padding: 1rem; background: #EFF6FF; border-left: 4px solid var(--info-color); border-radius: 6px;">
                    <p style="margin: 0; font-size: 0.875rem; color: var(--text-primary);">
                        <i class="fas fa-info-circle" style="color: var(--info-color); margin-right: 0.5rem;"></i>
                        <strong>Note:</strong> This will generate a unique code for the student. Parents can use this code to link the student's account.
                    </p>
                </div>

                <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" onclick="window.closeStudentCodeModal()" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-magic"></i> Generate Code
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Announcement Modal -->
    <div id="announcement-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div class="modal-content" style="background: var(--white); border-radius: 12px; padding: 2rem; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: var(--shadow-xl);">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border-color);">
                <h3 style="margin: 0; font-size: 1.5rem; color: var(--text-primary);">
                    <i class="fas fa-megaphone" style="color: var(--warning-color); margin-right: 0.5rem;"></i>
                    Create Announcement
                </h3>
                <button id="announcement-modal-close-btn" style="background: none; border: none; font-size: 1.5rem; color: var(--text-secondary); cursor: pointer; padding: 0.25rem; border-radius: 4px; transition: all 0.2s;">&times;</button>
            </div>
            <form id="announcement-form">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Title *</label>
                    <input type="text" id="announcement-title" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;" placeholder="e.g., Important Update">
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Message *</label>
                    <textarea id="announcement-message" required rows="5" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; resize: vertical;" placeholder="Enter your announcement message..."></textarea>
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Target Audience *</label>
                    <select id="announcement-target" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="all">All Users</option>
                        <option value="SS1">SS1 Students Only</option>
                        <option value="SS2">SS2 Students Only</option>
                        <option value="SS3">SS3 Students Only</option>
                        <option value="JAMB">JAMB Students Only</option>
                        <option value="active">Active Subscribers Only</option>
                        <option value="bootcamp">Bootcamp Users Only</option>
                    </select>
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Priority</label>
                    <select id="announcement-priority" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="normal">Normal</option>
                        <option value="high">High Priority</option>
                        <option value="urgent">Urgent</option>
                    </select>
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" id="announcement-pinned" style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="font-size: 0.875rem; font-weight: 600;">Pin this announcement (stays at top)</span>
                    </label>
                </div>

                <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" id="announcement-modal-cancel-btn" class="btn btn-secondary">Cancel</button>
                    <button type="submit" id="announcement-modal-save-btn" class="btn btn-primary">
                        <i class="fas fa-paper-plane"></i> Send Announcement
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Content Modal -->
    <div id="content-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div class="modal-content" style="background: var(--white); border-radius: 12px; padding: 2rem; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: var(--shadow-xl);">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border-color);">
                <h3 id="content-modal-title" style="margin: 0; font-size: 1.5rem; color: var(--text-primary);">Add Content</h3>
                <button id="content-modal-close-btn" style="background: none; border: none; font-size: 1.5rem; color: var(--text-secondary); cursor: pointer; padding: 0.25rem; border-radius: 4px; transition: all 0.2s;">&times;</button>
            </div>
            <form id="content-form">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Content Type</label>
                    <select id="content-type" onchange="updateContentFormFields()" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="book">Book/E-book</option>
                        <option value="video">Video</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Title *</label>
                    <input type="text" id="content-title" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Description *</label>
                    <textarea id="content-description" required rows="3" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; resize: vertical;"></textarea>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Class Level *</label>
                    <select id="content-class" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="">Select Class</option>
                        <option value="SS1">SS1</option>
                        <option value="SS2">SS2</option>
                        <option value="SS3">SS3</option>
                        <option value="JAMB">JAMB</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Subject *</label>
                    <div style="display: flex; gap: 0.5rem; align-items: flex-end;">
                        <select id="content-subject" required style="flex: 1; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                            <option value="">Select Subject</option>
                            <optgroup label="General Subjects">
                                <option value="Mathematics">Mathematics</option>
                                <option value="English Language">English Language</option>
                                <option value="Citizenship and Heritage Studies">Citizenship and Heritage Studies</option>
                            </optgroup>
                            <optgroup label="Science Stream">
                                <option value="Physics">Physics</option>
                                <option value="Chemistry">Chemistry</option>
                            </optgroup>
                            <optgroup label="Multi-Stream">
                                <option value="Biology">Biology</option>
                                <option value="Economics">Economics</option>
                            </optgroup>
                            <optgroup label="Humanities Stream">
                                <option value="Literature-in-English">Literature-in-English</option>
                                <option value="Government">Government</option>
                                <option value="CRS">CRS</option>
                            </optgroup>
                            <optgroup label="Business Stream">
                                <option value="Commerce">Commerce</option>
                                <option value="Accounts">Accounts</option>
                            </optgroup>
                        </select>
                        <button type="button" onclick="window.adminDashboard.openAddSubjectFromContent()" style="padding: 0.75rem 1rem; background: var(--success-color); color: white; border: none; border-radius: 8px; font-size: 0.875rem; cursor: pointer; white-space: nowrap; transition: all 0.2s; display: flex; align-items: center; gap: 0.5rem;" onmouseover="this.style.background='#059669'" onmouseout="this.style.background='var(--success-color)'">
                            <i class="fas fa-plus"></i> Add Subject
                        </button>
                    </div>
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.25rem; display: block;">Can't find your subject? Click "Add Subject" to create a new one.</small>
                </div>
                
                <div id="book-link-field" style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Google Drive Link *</label>
                    <input type="url" id="book-link" placeholder="https://drive.google.com/file/d/..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.25rem; display: block;">Paste the shareable Google Drive link</small>
                </div>
                
                <div id="video-link-field" style="margin-bottom: 1rem; display: none;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">YouTube Link *</label>
                    <input type="url" id="video-link" placeholder="https://youtube.com/watch?v=..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.25rem; display: block;">Paste the full YouTube video URL</small>
                </div>
                
                <div id="video-duration-field" style="margin-bottom: 1rem; display: none;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Duration (optional)</label>
                    <input type="text" id="video-duration" placeholder="e.g., 15 min" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Access Level *</label>
                    <select id="content-access-level" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="bootcamp">Bootcamp (Free 7-day trial)</option>
                        <option value="paid">Paid Members Only</option>
                    </select>
                    <p style="font-size: 0.75rem; color: var(--text-secondary); margin: 0.5rem 0 0 0;">
                        <i class="fas fa-info-circle"></i> Bootcamp content is accessible to all students. Paid content requires payment.
                    </p>
                </div>
                
                <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" id="content-modal-cancel-btn" class="btn btn-secondary">Cancel</button>
                    <button type="submit" id="content-modal-save-btn" class="btn btn-primary">Save Content</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Assessment Modal -->
    <div id="assessment-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div class="modal-content" style="background: var(--white); border-radius: 12px; padding: 2rem; max-width: 700px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: var(--shadow-xl);">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border-color);">
                <h3 id="assessment-modal-title" style="margin: 0; font-size: 1.5rem; color: var(--text-primary);">Create Assessment</h3>
                <button id="assessment-modal-close-btn" style="background: none; border: none; font-size: 1.5rem; color: var(--text-secondary); cursor: pointer; padding: 0.25rem; border-radius: 4px; transition: all 0.2s;">&times;</button>
            </div>
            <form id="assessment-form">
                <input type="hidden" id="assessment-type" value="quiz">
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Title *</label>
                    <input type="text" id="assessment-title" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Description</label>
                    <textarea id="assessment-description" rows="2" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; resize: vertical;"></textarea>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Class Level *</label>
                        <select id="assessment-class" required onchange="updateAssessmentStreams()" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                            <option value="">Select Class</option>
                            <option value="SS1">SS1</option>
                            <option value="SS2">SS2</option>
                            <option value="SS3">SS3</option>
                            <option value="JAMB">JAMB</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Stream *</label>
                        <select id="assessment-stream" required onchange="updateAssessmentSubjects()" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                            <option value="">Select Stream</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Subject *</label>
                        <select id="assessment-subject" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                            <option value="">Select Subject</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Duration (minutes) *</label>
                        <input type="number" id="assessment-duration" required min="1" placeholder="e.g., 30" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Total Marks *</label>
                        <input type="number" id="assessment-marks" required min="1" placeholder="e.g., 100" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                    </div>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Access Level *</label>
                    <select id="assessment-access-level" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="bootcamp">Bootcamp (Free 7-day trial)</option>
                        <option value="paid">Paid Members Only</option>
                    </select>
                    <p style="font-size: 0.75rem; color: var(--text-secondary); margin: 0.5rem 0 0 0;">
                        <i class="fas fa-info-circle"></i> Bootcamp content is accessible to all students. Paid content requires payment.
                    </p>
                </div>

                <!-- Due Date and Time Section -->
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Due Date & Time *</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div>
                            <label style="display: block; margin-bottom: 0.25rem; font-size: 0.875rem; color: var(--text-secondary);">Due Date</label>
                            <input type="date" id="assessment-due-date" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.25rem; font-size: 0.875rem; color: var(--text-secondary);">Due Time</label>
                            <input type="time" id="assessment-due-time" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                        </div>
                    </div>
                    <p style="font-size: 0.75rem; color: var(--text-secondary); margin: 0.5rem 0 0 0;">
                        <i class="fas fa-clock"></i> Students must submit their work before this deadline. Late submissions may not be accepted.
                    </p>
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                        <label style="font-weight: 600; color: var(--text-primary);">Questions *</label>
                        <button type="button" id="add-question-btn" class="btn btn-secondary" style="padding: 0.5rem 1rem; font-size: 0.875rem;">
                            <i class="fas fa-plus"></i> Add Question
                        </button>
                    </div>
                    <div id="questions-container" style="max-height: 300px; overflow-y: auto; border: 2px solid var(--border-color); border-radius: 8px; padding: 1rem;">
                        <p style="text-align: center; color: var(--text-secondary); margin: 0;">No questions added yet. Click "Add Question" to start.</p>
                    </div>
                </div>
                
                <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" id="assessment-modal-cancel-btn" class="btn btn-secondary">Cancel</button>
                    <button type="submit" id="assessment-modal-save-btn" class="btn btn-primary">Save Assessment</button>
                </div>
            </form>
        </div>
    </div>

    <!-- View Assessment Modal -->
    <div id="view-assessment-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10001; align-items: center; justify-content: center;">
        <div class="modal-content" style="background: var(--white); border-radius: 12px; padding: 2rem; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: var(--shadow-xl);">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border-color);">
                <h3 id="view-assessment-title" style="margin: 0; font-size: 1.5rem; color: var(--text-primary);">Assessment Details</h3>
                <button onclick="closeViewAssessmentModal()" style="background: none; border: none; font-size: 1.5rem; color: var(--text-secondary); cursor: pointer; padding: 0.25rem; border-radius: 4px; transition: all 0.2s;">&times;</button>
            </div>
            
            <div id="view-assessment-content">
                <!-- Content will be populated by JavaScript -->
            </div>
            
            <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem; padding-top: 1rem; border-top: 2px solid var(--border-color);">
                <button onclick="window.adminDashboard.closeViewAssessmentModal()" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <!-- Live Class Modal -->
    <div id="liveclass-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div class="modal-content" style="background: var(--white); border-radius: 12px; padding: 2rem; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: var(--shadow-xl);">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border-color);">
                <h3 id="liveclass-modal-title" style="margin: 0; font-size: 1.5rem; color: var(--text-primary);">Schedule Live Class</h3>
                <button onclick="window.adminDashboard.closeLiveClassModal()" style="background: none; border: none; font-size: 1.5rem; color: var(--text-secondary); cursor: pointer; padding: 0.25rem; border-radius: 4px; transition: all 0.2s;">&times;</button>
            </div>
            <form id="liveclass-form" onsubmit="window.adminDashboard.saveLiveClass(event)">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Class Title *</label>
                    <input type="text" id="liveclass-title" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Description</label>
                    <textarea id="liveclass-description" rows="2" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; resize: vertical;"></textarea>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Class Level *</label>
                        <select id="liveclass-class" required onchange="window.adminDashboard.updateLiveClassSubjects()" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                            <option value="">Select Class</option>
                            <option value="SS1">SS1</option>
                            <option value="SS2">SS2</option>
                            <option value="SS3">SS3</option>
                            <option value="JAMB">JAMB</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Subject *</label>
                        <select id="liveclass-subject" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                            <option value="">Select Subject</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Date *</label>
                        <input type="date" id="liveclass-date" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Time *</label>
                        <input type="time" id="liveclass-time" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                    </div>
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Duration (minutes) *</label>
                    <input type="number" id="liveclass-duration" required min="15" placeholder="e.g., 60" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Meeting Link *</label>
                    <input type="url" id="liveclass-link" required placeholder="https://zoom.us/j/... or Google Meet link" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.25rem; display: block;">Zoom, Google Meet, or any video conferencing link</small>
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Access Level *</label>
                    <select id="liveclass-access-level" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="bootcamp">Bootcamp (Free 7-day trial)</option>
                        <option value="paid">Paid Members Only</option>
                    </select>
                    <p style="font-size: 0.75rem; color: var(--text-secondary); margin: 0.5rem 0 0 0;">
                        <i class="fas fa-info-circle"></i> Bootcamp content is accessible to all students. Paid content requires payment.
                    </p>
                </div>
                
                <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" onclick="window.adminDashboard.closeLiveClassModal()" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Schedule Class</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Plan Modal -->
    <div id="plan-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div class="modal-content" style="background: var(--white); border-radius: 12px; padding: 2rem; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: var(--shadow-xl);">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border-color);">
                <h3 id="plan-modal-title" style="margin: 0; font-size: 1.5rem; color: var(--text-primary);">Create Subscription Plan</h3>
                <button onclick="window.adminDashboard.closePlanModal()" style="background: none; border: none; font-size: 1.5rem; color: var(--text-secondary); cursor: pointer; padding: 0.25rem; border-radius: 4px; transition: all 0.2s;">&times;</button>
            </div>
            <form id="plan-form" onsubmit="window.adminDashboard.savePlan(event)">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Plan Name *</label>
                    <input type="text" id="plan-name" required placeholder="e.g., Basic Plan, Premium Plan" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Duration (Days) *</label>
                    <select id="plan-duration" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="">Select Duration</option>
                        <option value="30">30 Days (1 Month)</option>
                        <option value="60">60 Days (2 Months)</option>
                        <option value="90">90 Days (3 Months)</option>
                    </select>
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Plan Type *</label>
                    <select id="plan-type" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="Individual" selected>Individual</option>
                        <option value="Family">Family</option>
                    </select>
                    <small style="display: block; margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.75rem;">
                        <i class="fas fa-info-circle"></i> Individual: For single student. Family: For multiple children.
                    </small>
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Price () *</label>
                    <input type="number" id="plan-price" required min="0" placeholder="e.g., 5000" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Description</label>
                    <textarea id="plan-description" rows="3" placeholder="Describe the plan features..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; resize: vertical;"></textarea>
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Features (one per line)</label>
                    <textarea id="plan-features" rows="4" placeholder="Access to all courses&#10;Live class sessions&#10;Mock exams&#10;24/7 support" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; resize: vertical;"></textarea>
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" id="plan-popular" style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="font-weight: 600; color: var(--text-primary);">Mark as Popular/Recommended</span>
                    </label>
                </div>
                
                <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" onclick="window.adminDashboard.closePlanModal()" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Plan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- User Modal -->
    <div id="user-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div class="modal-content" style="background: var(--white); border-radius: 12px; padding: 2rem; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: var(--shadow-xl);">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border-color);">
                <h3 id="user-modal-title" style="margin: 0; font-size: 1.5rem; color: var(--text-primary);">Add User</h3>
                <button onclick="window.adminDashboard.closeUserModal()" style="background: none; border: none; font-size: 1.5rem; color: var(--text-secondary); cursor: pointer; padding: 0.25rem; border-radius: 4px; transition: all 0.2s;">&times;</button>
            </div>
            <form id="user-form" onsubmit="window.adminDashboard.saveUser(event)">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Full Name *</label>
                    <input type="text" id="user-name" required placeholder="e.g., John Doe" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Email *</label>
                    <input type="email" id="user-email" required placeholder="e.g., john@example.com" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Phone Number</label>
                    <input type="tel" id="user-phone" placeholder="e.g., +234 800 000 0000" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Subscription Plan</label>
                    <select id="user-plan" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="">Free Bootcamp (7 Days)</option>
                        <option value="30">30-Day Plan</option>
                        <option value="60">60-Day Plan</option>
                        <option value="90">90-Day Plan</option>
                    </select>
                    <small style="color: var(--text-secondary); font-size: 0.75rem; display: block; margin-top: 0.25rem;">Leave empty for free 7-day bootcamp</small>
                </div>

                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">User Type *</label>
                    <select id="user-type" onchange="window.adminDashboard.toggleUserTypeFields()" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="parent">Parent/Guardian</option>
                        <option value="child">Child/Student</option>
                    </select>
                </div>

                <!-- Parent Fields -->
                <div id="parent-fields" style="display: block;">
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Number of Children</label>
                        <input type="number" id="user-children-count" min="0" value="0" placeholder="e.g., 2" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                        <small style="color: var(--text-secondary); font-size: 0.75rem; display: block; margin-top: 0.25rem;">You can add children accounts later</small>
                    </div>
                </div>

                <!-- Child Fields -->
                <div id="child-fields" style="display: none;">
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Parent/Guardian</label>
                        <select id="user-parent" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                            <option value="">Select Parent (Optional)</option>
                        </select>
                    </div>

                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Class Level</label>
                        <select id="user-class" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                            <option value="">Select Class</option>
                            <option value="SS1">SS1</option>
                            <option value="SS2">SS2</option>
                            <option value="SS3">SS3</option>
                            <option value="JAMB">JAMB</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" onclick="window.adminDashboard.closeUserModal()" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save User</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Question Modal -->
    <div id="question-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10001; align-items: center; justify-content: center;">
        <div class="modal-content" style="background: var(--white); border-radius: 12px; padding: 2rem; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: var(--shadow-xl);">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border-color);">
                <h3 style="margin: 0; font-size: 1.25rem; color: var(--text-primary);">Add Question</h3>
                <button onclick="closeQuestionModal()" style="background: none; border: none; font-size: 1.5rem; color: var(--text-secondary); cursor: pointer; padding: 0.25rem; border-radius: 4px; transition: all 0.2s;">&times;</button>
            </div>
            <form id="question-form" onsubmit="return saveQuestionForm(event)">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Question Text *</label>
                    <textarea id="question-text" required rows="3" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; resize: vertical;"></textarea>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.75rem; font-weight: 600; color: var(--text-primary);">Options *</label>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="radio" name="correct-answer" value="A" id="option-a-radio" required>
                            <label for="option-a-radio" style="margin: 0; font-size: 0.875rem;">A:</label>
                            <input type="text" id="option-a" required placeholder="Option A" style="flex: 1; padding: 0.5rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem;">
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="radio" name="correct-answer" value="B" id="option-b-radio" required>
                            <label for="option-b-radio" style="margin: 0; font-size: 0.875rem;">B:</label>
                            <input type="text" id="option-b" required placeholder="Option B" style="flex: 1; padding: 0.5rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem;">
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="radio" name="correct-answer" value="C" id="option-c-radio" required>
                            <label for="option-c-radio" style="margin: 0; font-size: 0.875rem;">C:</label>
                            <input type="text" id="option-c" required placeholder="Option C" style="flex: 1; padding: 0.5rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem;">
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="radio" name="correct-answer" value="D" id="option-d-radio" required>
                            <label for="option-d-radio" style="margin: 0; font-size: 0.875rem;">D:</label>
                            <input type="text" id="option-d" required placeholder="Option D" style="flex: 1; padding: 0.5rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem;">
                        </div>
                    </div>
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.5rem; display: block;">Select the correct answer by clicking the radio button</small>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Marks *</label>
                    <input type="number" id="question-marks" required min="1" value="1" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>
                
                <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" onclick="closeQuestionModal()" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Question</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Subscription Management Modal -->
    <div id="subscription-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div class="modal-content" style="background: var(--white); border-radius: 12px; padding: 2rem; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: var(--shadow-xl);">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border-color);">
                <h3 id="subscription-modal-title" style="margin: 0; font-size: 1.5rem; color: var(--text-primary);">Manage Subscription</h3>
                <button onclick="closeSubscriptionModal()" style="background: none; border: none; font-size: 1.5rem; color: var(--text-secondary); cursor: pointer; padding: 0.25rem; border-radius: 4px; transition: all 0.2s;">&times;</button>
            </div>
            <form id="subscription-form" onsubmit="saveSubscription(event)">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">User Email *</label>
                    <input type="email" id="subscription-email" required placeholder="Enter user email" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Full Name *</label>
                    <input type="text" id="subscription-name" required placeholder="Enter full name" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">User Role *</label>
                    <select id="subscription-role" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="">Select Role</option>
                        <option value="student">Student</option>
                        <option value="parent">Parent</option>
                    </select>
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.25rem; display: block;">
                        <i class="fas fa-info-circle"></i> Select whether this subscription is for a student or parent account.
                    </small>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Subscription Plan *</label>
                    <select id="subscription-plan" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="">Select Plan</option>
                        <option value="bootcamp">7-Day Free Bootcamp</option>
                        <option value="30">30-Day Plan</option>
                        <option value="60">60-Day Plan</option>
                        <option value="90">90-Day Plan</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Plan Type *</label>
                    <select id="subscription-plan-type" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="Individual" selected>Individual</option>
                        <option value="Family">Family</option>
                    </select>
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.25rem; display: block;">
                        <i class="fas fa-info-circle"></i> Individual: Single user. Family: Multiple users.
                    </small>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Payment Status *</label>
                    <select id="subscription-payment-status" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem; background: var(--white);">
                        <option value="bootcamp">Bootcamp (Free 7-day trial)</option>
                        <option value="paid">Paid Member</option>
                    </select>
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.25rem; display: block;">
                        <i class="fas fa-info-circle"></i> Bootcamp users can only access free content. Paid members access all content.
                    </small>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary);">Expiry Date (Optional)</label>
                    <input type="date" id="subscription-expiry" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.875rem;">
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.25rem; display: block;">
                        <i class="fas fa-magic"></i> Auto-calculated if left empty: Bootcamp = 7 days, Paid = No expiry, Time-based = Plan days. You can override by selecting a custom date.
                    </small>
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: 600; color: var(--text-primary); cursor: pointer;">
                        <input type="checkbox" id="subscription-locked" style="width: 18px; height: 18px;">
                        Lock Account
                    </label>
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.25rem; display: block;">Locked accounts cannot access the platform</small>
                </div>
                
                <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" onclick="closeSubscriptionModal()" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Subscription</button>
                </div>
            </form>
        </div>
    </div>

    <script src="admin.js"></script>
    
    <!-- Profile Management Script -->
    <script>
        console.log(' Profile Management Script Loading...');
        
        // Toggle profile dropdown
        window.toggleProfileDropdown = function() {
            const dropdown = document.getElementById('profile-dropdown');
            if (dropdown) {
                dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
            }
        };
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('profile-dropdown');
            const avatar = document.querySelector('.user-avatar');
            
            if (dropdown && avatar && !avatar.contains(event.target) && !dropdown.contains(event.target)) {
                dropdown.style.display = 'none';
            }
        });
        
        // Load admin profile
        function loadAdminProfile() {
            const adminProfile = JSON.parse(localStorage.getItem('brainwave_admin_profile') || '{}');
            
            // Set default values if not exists
            if (!adminProfile.name) {
                adminProfile.name = 'Admin User';
                adminProfile.email = 'admin@brainwave.com';
                adminProfile.phone = '+234 000 000 0000';
                localStorage.setItem('brainwave_admin_profile', JSON.stringify(adminProfile));
            }
            
            // Update dropdown display
            const dropdownName = document.getElementById('dropdown-admin-name');
            const dropdownEmail = document.getElementById('dropdown-admin-email');
            
            if (dropdownName) dropdownName.textContent = adminProfile.name;
            if (dropdownEmail) dropdownEmail.textContent = adminProfile.email;
            
            return adminProfile;
        }
        
        // Open profile modal
        window.openProfileModal = function() {
            const modal = document.getElementById('profile-modal');
            const dropdown = document.getElementById('profile-dropdown');
            
            // Close dropdown
            if (dropdown) dropdown.style.display = 'none';
            
            // Load current profile data
            const profile = loadAdminProfile();
            
            // Populate form
            document.getElementById('profile-name').value = profile.name || '';
            document.getElementById('profile-phone').value = profile.phone || '';
            document.getElementById('profile-email').value = profile.email || '';
            
            // Show modal
            if (modal) {
                modal.style.display = 'flex';
                console.log(' Profile modal opened');
            }
        };
        
        // Close profile modal
        window.closeProfileModal = function() {
            const modal = document.getElementById('profile-modal');
            if (modal) {
                modal.style.display = 'none';
                console.log(' Profile modal closed');
            }
        };
        
        // Save profile
        window.saveAdminProfile = function(event) {
            event.preventDefault();
            
            const name = document.getElementById('profile-name').value.trim();
            const phone = document.getElementById('profile-phone').value.trim();
            const email = document.getElementById('profile-email').value.trim();
            
            if (!name || !phone || !email) {
                alert('Please fill in all fields');
                return;
            }
            
            // Validate email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('Please enter a valid email address');
                return;
            }
            
            // Save to localStorage
            const profile = {
                name: name,
                phone: phone,
                email: email,
                updatedAt: new Date().toISOString()
            };
            
            localStorage.setItem('brainwave_admin_profile', JSON.stringify(profile));
            
            // Update dropdown display
            document.getElementById('dropdown-admin-name').textContent = name;
            document.getElementById('dropdown-admin-email').textContent = email;
            
            console.log(' Admin profile saved:', profile);
            alert('Profile updated successfully!');
            
            closeProfileModal();
        };
        
        // Logout function
        window.logoutAdmin = function() {
            if (confirm('Are you sure you want to logout?')) {
                console.log(' Admin logging out...');
                // Redirect to login page
                window.location.href = 'admin-login.html';
            }
        };
        
        // Upgrade plan function
        window.openUpgradeModal = function() {
            const dropdown = document.getElementById('profile-dropdown');
            
            // Close dropdown
            if (dropdown) dropdown.style.display = 'none';
            
            // Prepare payment data for admin
            const paymentData = {
                type: 'upgrade',
                childName: 'Admin Account',
                currentPlan: 'admin',
                parentName: 'Admin User',
                parentEmail: 'admin@brainwave.com'
            };
            
            // Store payment data in session storage
            sessionStorage.setItem('brainwave_payment_data', JSON.stringify(paymentData));
            
            // Redirect to payment gateway
            window.location.href = 'payment-gateway.html';
        };
        
        // Setup profile form submission
        window.addEventListener('DOMContentLoaded', function() {
            const profileForm = document.getElementById('profile-form');
            if (profileForm) {
                profileForm.addEventListener('submit', saveAdminProfile);
            }
            
            // Load profile on page load
            loadAdminProfile();
            
            console.log(' Profile management setup complete');
        });
        
        console.log(' Profile Management script loaded');
    </script>
    
    <!-- Student Code Generation Script -->
    <script>
        console.log(' Student Code Generation Script Loading...');
        
        // Generate unique student code
        function generateStudentCode() {
            const prefix = 'BW';
            const timestamp = Date.now().toString().slice(-6);
            const random = Math.random().toString(36).substring(2, 6).toUpperCase();
            return `${prefix}-${timestamp}-${random}`;
        }
        
        // Show student code modal
        window.showStudentCodeModal = function() {
            const modal = document.getElementById('student-code-modal');
            const studentSelect = document.getElementById('student-select');
            
            // Load students
            const users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
            const students = users.filter(u => u.role === 'student');
            
            if (students.length === 0) {
                alert('No students found. Please add students first.');
                return;
            }
            
            // Populate dropdown
            studentSelect.innerHTML = '<option value="">-- Select a student --</option>' +
                students.map(s => `<option value="${s.id}">${s.name} (${s.email})</option>`).join('');
            
            // Reset form
            document.getElementById('existing-code-display').style.display = 'none';
            
            // Show modal
            if (modal) {
                modal.style.display = 'flex';
                console.log(' Student code modal opened');
            }
        };
        
        // Close student code modal
        window.closeStudentCodeModal = function() {
            const modal = document.getElementById('student-code-modal');
            if (modal) {
                modal.style.display = 'none';
                console.log(' Student code modal closed');
            }
        };
        
        // Handle student selection change
        window.addEventListener('DOMContentLoaded', function() {
            const studentSelect = document.getElementById('student-select');
            if (studentSelect) {
                studentSelect.addEventListener('change', function() {
                    const studentId = parseInt(this.value);
                    if (!studentId) {
                        document.getElementById('existing-code-display').style.display = 'none';
                        return;
                    }
                    
                    const users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
                    const student = users.find(u => u.id === studentId);
                    
                    if (student && student.studentCode) {
                        document.getElementById('existing-code-value').textContent = student.studentCode;
                        document.getElementById('existing-code-display').style.display = 'block';
                    } else {
                        document.getElementById('existing-code-display').style.display = 'none';
                    }
                });
            }
            
            // Handle form submission
            const codeForm = document.getElementById('student-code-form');
            if (codeForm) {
                codeForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const studentId = parseInt(document.getElementById('student-select').value);
                    if (!studentId) {
                        alert('Please select a student');
                        return;
                    }
                    
                    // Get users
                    let users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
                    const studentIndex = users.findIndex(u => u.id === studentId);
                    
                    if (studentIndex === -1) {
                        alert('Student not found');
                        return;
                    }
                    
                    const student = users[studentIndex];
                    
                    // Check if already has code
                    if (student.studentCode) {
                        if (!confirm(`This student already has a code: ${student.studentCode}\n\nDo you want to generate a new code? This will replace the existing one.`)) {
                            return;
                        }
                    }
                    
                    // Generate new code
                    const newCode = generateStudentCode();
                    users[studentIndex].studentCode = newCode;
                    users[studentIndex].codeGeneratedAt = new Date().toISOString();
                    users[studentIndex].codeGeneratedBy = 'admin';
                    
                    // Save to localStorage
                    localStorage.setItem('brainwave_users', JSON.stringify(users));
                    
                    console.log(' Student code generated:', newCode, 'for student:', student.name);
                    
                    alert(`Student Code Generated Successfully!\n\nStudent: ${student.name}\nCode: ${newCode}\n\nThis code can be used by parents to link the student's account.`);
                    
                    closeStudentCodeModal();
                    
                    // Refresh users table if visible
                    if (window.adminDashboard && typeof window.adminDashboard.loadUsersData === 'function') {
                        window.adminDashboard.loadUsersData();
                    }
                });
            }
            
            console.log(' Student code generation setup complete');
        });
        
        // Quick generate code for specific user (from actions column)
        window.quickGenerateCode = function(userId) {
            let users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
            const userIndex = users.findIndex(u => u.id === userId);
            
            if (userIndex === -1) {
                alert('User not found');
                return;
            }
            
            const user = users[userIndex];
            
            if (user.role !== 'student') {
                alert('Only students can have student codes');
                return;
            }
            
            // Check if already has code
            if (user.studentCode) {
                if (!confirm(`This student already has a code: ${user.studentCode}\n\nDo you want to generate a new code?`)) {
                    return;
                }
            }
            
            // Generate new code
            const newCode = generateStudentCode();
            users[userIndex].studentCode = newCode;
            users[userIndex].codeGeneratedAt = new Date().toISOString();
            users[userIndex].codeGeneratedBy = 'admin';
            
            // Save to localStorage
            localStorage.setItem('brainwave_users', JSON.stringify(users));
            
            console.log(' Quick code generated:', newCode, 'for user:', user.name);
            
            alert(`Student Code Generated!\n\nStudent: ${user.name}\nCode: ${newCode}\n\nParents can use this code to link the account.`);
            
            // Refresh users table
            if (window.adminDashboard && typeof window.adminDashboard.loadUsersData === 'function') {
                window.adminDashboard.loadUsersData();
            }
        };
        
        // View student code
        window.viewStudentCode = function(userId) {
            const users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
            const user = users.find(u => u.id === userId);
            
            if (!user) {
                alert('User not found');
                return;
            }
            
            if (!user.studentCode) {
                alert('This student does not have a code yet.\n\nClick "Generate Code" to create one.');
                return;
            }
            
            alert(`Student Code\n\nStudent: ${user.name}\nCode: ${user.studentCode}\n\nGenerated: ${user.codeGeneratedAt ? new Date(user.codeGeneratedAt).toLocaleString() : 'N/A'}`);
        };
        
        console.log(' Student Code Generation script loaded');
    </script>
    
    <!-- Sidebar Scroll Script -->
    <script>
        console.log(' Sidebar Scroll Script Loading...');
        
        window.addEventListener('DOMContentLoaded', function() {
            const scrollUpBtn = document.getElementById('scroll-up-btn');
            const scrollDownBtn = document.getElementById('scroll-down-btn');
            const navContainer = document.getElementById('sidebar-nav-container');
            
            if (scrollUpBtn && scrollDownBtn && navContainer) {
                // Scroll up
                scrollUpBtn.addEventListener('click', function() {
                    navContainer.scrollBy({
                        top: -150,
                        behavior: 'smooth'
                    });
                });
                
                // Scroll down
                scrollDownBtn.addEventListener('click', function() {
                    navContainer.scrollBy({
                        top: 150,
                        behavior: 'smooth'
                    });
                });
                
                // Show/hide buttons based on scroll position
                function updateScrollButtons() {
                    const isAtTop = navContainer.scrollTop === 0;
                    const isAtBottom = navContainer.scrollTop + navContainer.clientHeight >= navContainer.scrollHeight - 5;
                    
                    scrollUpBtn.style.opacity = isAtTop ? '0.3' : '1';
                    scrollUpBtn.style.cursor = isAtTop ? 'not-allowed' : 'pointer';
                    
                    scrollDownBtn.style.opacity = isAtBottom ? '0.3' : '1';
                    scrollDownBtn.style.cursor = isAtBottom ? 'not-allowed' : 'pointer';
                }
                
                // Update on scroll
                navContainer.addEventListener('scroll', updateScrollButtons);
                
                // Initial update
                updateScrollButtons();
                
                console.log(' Sidebar scroll buttons setup complete');
            }
        });
        
        console.log(' Sidebar Scroll script loaded');
    </script>
    
    <!-- Content Modal Fix Script -->
    <script>
        console.log(' Content Modal Fix Loading...');
        
        // Wait for DOM and AdminDashboard to be ready
        window.addEventListener('DOMContentLoaded', function() {
            console.log(' DOM loaded, setting up content modal fixes...');
            
            // Fix 1: Populate subject dropdown on page load
            function populateSubjectDropdown() {
                console.log(' Populating subject dropdown...');
                
                if (window.adminDashboard && window.adminDashboard.updateContentSubjectDropdown) {
                    window.adminDashboard.updateContentSubjectDropdown();
                    console.log(' Subject dropdown populated via AdminDashboard');
                } else {
                    // Fallback: populate manually
                    const subjectSelect = document.getElementById('content-subject');
                    if (!subjectSelect) {
                        console.error(' Subject dropdown not found');
                        return;
                    }
                    
                    // Load subjects from storage
                    const subjects = JSON.parse(localStorage.getItem('brainwave_subjects') || '[]');
                    console.log(' Found', subjects.length, 'subjects in storage');
                    
                    // Clear existing options except first
                    const firstOption = subjectSelect.querySelector('option[value=""]');
                    subjectSelect.innerHTML = '';
                    if (firstOption) {
                        subjectSelect.appendChild(firstOption.cloneNode(true));
                    } else {
                        const defaultOption = document.createElement('option');
                        defaultOption.value = '';
                        defaultOption.textContent = 'Select Subject';
                        subjectSelect.appendChild(defaultOption);
                    }
                    
                    if (subjects.length === 0) {
                        // Add default subjects
                        const defaultSubjects = [
                            { group: 'General Subjects', subjects: ['Mathematics', 'English Language', 'Citizenship and Heritage Studies'] },
                            { group: 'Science Stream', subjects: ['Physics', 'Chemistry', 'Biology'] },
                            { group: 'Humanities Stream', subjects: ['Literature-in-English', 'Government', 'CRS'] },
                            { group: 'Business Stream', subjects: ['Commerce', 'Accounts', 'Economics'] }
                        ];
                        
                        defaultSubjects.forEach(group => {
                            const optgroup = document.createElement('optgroup');
                            optgroup.label = group.group;
                            
                            group.subjects.forEach(subjectName => {
                                const option = document.createElement('option');
                                option.value = subjectName;
                                option.textContent = subjectName;
                                optgroup.appendChild(option);
                            });
                            
                            subjectSelect.appendChild(optgroup);
                        });
                        console.log(' Added default subjects');
                    } else {
                        // Group subjects by stream
                        const subjectGroups = {
                            'General': [],
                            'Science': [],
                            'Humanities': [],
                            'Business': [],
                            'Multi-Stream': [],
                            'JAMB': []
                        };
                        
                        subjects.forEach(subject => {
                            const stream = subject.stream || 'General';
                            if (subjectGroups[stream]) {
                                subjectGroups[stream].push(subject);
                            } else {
                                subjectGroups['General'].push(subject);
                            }
                        });
                        
                        // Add grouped subjects
                        Object.keys(subjectGroups).forEach(stream => {
                            if (subjectGroups[stream].length > 0) {
                                const optgroup = document.createElement('optgroup');
                                optgroup.label = `${stream} ${stream === 'General' ? 'Subjects' : 'Stream'}`;
                                
                                subjectGroups[stream].forEach(subject => {
                                    const option = document.createElement('option');
                                    option.value = subject.name;
                                    option.textContent = subject.name;
                                    optgroup.appendChild(option);
                                });
                                
                                subjectSelect.appendChild(optgroup);
                            }
                        });
                        console.log(' Added custom subjects from storage');
                    }
                }
            }
            
            // Populate on load
            setTimeout(populateSubjectDropdown, 500);
            
            // Fix 2: Ensure modal buttons work
            function setupModalButtons() {
                console.log(' Setting up modal buttons...');
                
                const modal = document.getElementById('content-modal');
                if (!modal) {
                    console.error(' Content modal not found');
                    return;
                }
                
                // Fix X button (close button in header)
                const closeBtn = document.getElementById('content-modal-close-btn');
                if (closeBtn) {
                    closeBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        console.log(' Close button clicked');
                        closeContentModal();
                    });
                    console.log(' Close button handler attached');
                } else {
                    console.error(' Close button not found');
                }
                
                // Fix Cancel button
                const cancelBtn = document.getElementById('content-modal-cancel-btn');
                if (cancelBtn) {
                    cancelBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        console.log(' Cancel button clicked');
                        closeContentModal();
                    });
                    console.log(' Cancel button handler attached');
                } else {
                    console.error(' Cancel button not found');
                }
                
                // Fix form submission
                const form = document.getElementById('content-form');
                if (form) {
                    form.addEventListener('submit', function(e) {
                        e.preventDefault();
                        console.log(' Form submitted');
                        
                        if (window.adminDashboard && window.adminDashboard.saveContent) {
                            window.adminDashboard.saveContent(e);
                        } else {
                            saveContent(e);
                        }
                    });
                    console.log(' Form submission handler attached');
                } else {
                    console.error(' Form not found');
                }
                
                // Fix modal backdrop click
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        console.log(' Clicked outside modal');
                        closeContentModal();
                    }
                });
                
                console.log(' Modal buttons setup complete');
            }
            
            setTimeout(setupModalButtons, 500);
            
            // Fix 3: Override openContentModal to populate subjects
            const originalOpenContentModal = window.openContentModal;
            window.openContentModal = function(type) {
                console.log(' Opening content modal for:', type);
                
                // Call original function
                if (originalOpenContentModal) {
                    originalOpenContentModal(type);
                } else if (window.adminDashboard && window.adminDashboard.openContentModal) {
                    window.adminDashboard.openContentModal(type);
                }
                
                // Ensure subjects are populated
                setTimeout(populateSubjectDropdown, 100);
            };
            
            console.log(' Content modal fixes applied successfully!');
        });
        
        // Fallback saveContent function
        function saveContent(event) {
            if (event) event.preventDefault();
            
            console.log(' Fallback saveContent called');
            
            const type = document.getElementById('content-type').value;
            const title = document.getElementById('content-title').value;
            const description = document.getElementById('content-description').value;
            const classLevel = document.getElementById('content-class').value;
            const subject = document.getElementById('content-subject').value;
            
            if (!title || !description || !classLevel || !subject) {
                alert('Please fill in all required fields');
                return;
            }
            
            if (type === 'book') {
                const link = document.getElementById('book-link').value;
                if (!link) {
                    alert('Please provide a book link');
                    return;
                }
                
                const bookData = {
                    id: Date.now(),
                    title,
                    description,
                    classLevel,
                    subject,
                    link,
                    createdAt: new Date().toISOString()
                };
                
                const books = JSON.parse(localStorage.getItem('brainwave_books') || '[]');
                books.push(bookData);
                localStorage.setItem('brainwave_books', JSON.stringify(books));
                
                console.log(' Book saved:', bookData);
                alert('Book added successfully!');
                
            } else if (type === 'video') {
                const link = document.getElementById('video-link').value;
                if (!link) {
                    alert('Please provide a video link');
                    return;
                }
                
                const duration = document.getElementById('video-duration').value || 'N/A';
                
                const videoData = {
                    id: Date.now(),
                    title,
                    description,
                    classLevel,
                    subject,
                    link,
                    duration,
                    createdAt: new Date().toISOString()
                };
                
                const videos = JSON.parse(localStorage.getItem('brainwave_videos') || '[]');
                videos.push(videoData);
                localStorage.setItem('brainwave_videos', JSON.stringify(videos));
                
                console.log(' Video saved:', videoData);
                alert('Video added successfully!');
            }
            
            closeContentModal();
            
            // Trigger re-render if available
            if (window.adminDashboard) {
                if (type === 'book' && window.adminDashboard.renderBooks) {
                    window.adminDashboard.renderBooks();
                } else if (type === 'video' && window.adminDashboard.renderVideos) {
                    window.adminDashboard.renderVideos();
                }
            }
        }
        
        console.log(' Content modal fix script loaded');
        
        // Also setup immediately (in case DOMContentLoaded already fired)
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
            console.log(' DOM already ready, setting up immediately...');
            setTimeout(function() {
                const modal = document.getElementById('content-modal');
                const form = document.getElementById('content-form');
                const closeBtn = document.getElementById('content-modal-close-btn');
                const cancelBtn = document.getElementById('content-modal-cancel-btn');
                
                if (closeBtn) {
                    closeBtn.onclick = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log(' Close clicked (immediate)');
                        if (modal) {
                            modal.style.display = 'none';
                            if (form) form.reset();
                        }
                    };
                }
                
                if (cancelBtn) {
                    cancelBtn.onclick = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log(' Cancel clicked (immediate)');
                        if (modal) {
                            modal.style.display = 'none';
                            if (form) form.reset();
                        }
                    };
                }
                
                if (form) {
                    form.onsubmit = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log(' Save clicked (immediate)');
                        if (window.adminDashboard && window.adminDashboard.saveContent) {
                            window.adminDashboard.saveContent(e);
                        } else {
                            saveContent(e);
                        }
                        return false;
                    };
                }
                
                console.log(' Immediate setup complete');
            }, 100);
        }
    </script>
    
    <!-- Assessment Modal Fix Script -->
    <script>
        console.log(' Assessment Modal Fix Loading...');
        
        window.addEventListener('DOMContentLoaded', function() {
            console.log(' Setting up assessment modal fixes...');
            
            // Populate assessment subject dropdown
            function populateAssessmentSubjects() {
                const subjectSelect = document.getElementById('assessment-subject');
                if (!subjectSelect) return;
                
                const subjects = JSON.parse(localStorage.getItem('brainwave_subjects') || '[]');
                
                // Clear existing options except first
                subjectSelect.innerHTML = '<option value="">Select Subject</option>';
                
                if (subjects.length === 0) {
                    // Add default subjects
                    const defaultSubjects = ['Mathematics', 'English Language', 'Physics', 'Chemistry', 'Biology', 'Economics', 'Literature-in-English', 'Government', 'Commerce', 'Accounts'];
                    defaultSubjects.forEach(subject => {
                        const option = document.createElement('option');
                        option.value = subject;
                        option.textContent = subject;
                        subjectSelect.appendChild(option);
                    });
                } else {
                    subjects.forEach(subject => {
                        const option = document.createElement('option');
                        option.value = subject.name;
                        option.textContent = subject.name;
                        subjectSelect.appendChild(option);
                    });
                }
                
                console.log(' Assessment subjects populated');
            }

            // Function to update streams based on class level
            function updateAssessmentStreams() {
                const classSelect = document.getElementById('assessment-class');
                const streamSelect = document.getElementById('assessment-stream');
                const subjectSelect = document.getElementById('assessment-subject');
                
                if (!classSelect || !streamSelect || !subjectSelect) return;
                
                const selectedClass = classSelect.value;
                
                // Clear streams and subjects
                streamSelect.innerHTML = '<option value="">Select Stream</option>';
                subjectSelect.innerHTML = '<option value="">Select Subject</option>';
                
                if (!selectedClass) return;
                
                // Define streams for each class level
                const classStreams = {
                    'SS1': ['Science', 'Business', 'Humanities', 'General'],
                    'SS2': ['Science', 'Business', 'Humanities', 'General'],
                    'SS3': ['Science', 'Business', 'Humanities', 'General'],
                    'JAMB': ['JAMB', 'General']
                };
                
                const streams = classStreams[selectedClass] || [];
                
                streams.forEach(stream => {
                    const option = document.createElement('option');
                    option.value = stream;
                    option.textContent = stream;
                    streamSelect.appendChild(option);
                });
                
                console.log(' Assessment streams updated for class:', selectedClass);
            }

            // Function to update subjects based on stream selection
            function updateAssessmentSubjects() {
                const classSelect = document.getElementById('assessment-class');
                const streamSelect = document.getElementById('assessment-stream');
                const subjectSelect = document.getElementById('assessment-subject');
                
                if (!classSelect || !streamSelect || !subjectSelect) return;
                
                const selectedClass = classSelect.value;
                const selectedStream = streamSelect.value;
                
                // Clear subjects
                subjectSelect.innerHTML = '<option value="">Select Subject</option>';
                
                if (!selectedClass || !selectedStream) return;
                
                // Define subjects for each stream
                const streamSubjects = {
                    'Science': ['Mathematics', 'Physics', 'Chemistry', 'Biology', 'Economics', 'English Language'],
                    'Business': ['Mathematics', 'Economics', 'Commerce', 'Accounts', 'English Language', 'Government'],
                    'Humanities': ['English Language', 'Literature-in-English', 'Government', 'Christian Religious Studies', 'Biology', 'Economics'],
                    'General': ['Mathematics', 'English Language', 'Citizenship and Heritage Studies'],
                    'JAMB': ['Mathematics', 'English Language', 'Physics', 'Chemistry', 'Biology', 'Economics', 'Literature-in-English', 'Government', 'Commerce', 'Accounts', 'Christian Religious Studies']
                };
                
                const subjects = streamSubjects[selectedStream] || [];
                
                subjects.forEach(subject => {
                    const option = document.createElement('option');
                    option.value = subject;
                    option.textContent = subject;
                    subjectSelect.appendChild(option);
                });
                
                console.log(' Assessment subjects updated for stream:', selectedStream);
            }

            // Make functions globally available
            window.updateAssessmentStreams = updateAssessmentStreams;
            window.updateAssessmentSubjects = updateAssessmentSubjects;
            
            // Setup assessment modal buttons
            function setupAssessmentButtons() {
                console.log(' Setting up assessment modal buttons...');
                
                const modal = document.getElementById('assessment-modal');
                const form = document.getElementById('assessment-form');
                const closeBtn = document.getElementById('assessment-modal-close-btn');
                const cancelBtn = document.getElementById('assessment-modal-cancel-btn');
                const addQuestionBtn = document.getElementById('add-question-btn');
                
                if (closeBtn) {
                    closeBtn.onclick = function(e) {
                        e.preventDefault();
                        console.log(' Assessment close clicked');
                        closeAssessmentModal();
                    };
                    console.log(' Assessment close button attached');
                }
                
                if (cancelBtn) {
                    cancelBtn.onclick = function(e) {
                        e.preventDefault();
                        console.log(' Assessment cancel clicked');
                        closeAssessmentModal();
                    };
                    console.log(' Assessment cancel button attached');
                }
                
                if (addQuestionBtn) {
                    addQuestionBtn.onclick = function(e) {
                        e.preventDefault();
                        console.log(' Add question clicked');
                        if (window.adminDashboard && window.adminDashboard.addQuestion) {
                            window.adminDashboard.addQuestion();
                        } else {
                            addQuestion();
                        }
                    };
                    console.log(' Add question button attached');
                }
                
                if (form) {
                    form.onsubmit = function(e) {
                        e.preventDefault();
                        console.log(' Assessment save clicked');
                        
                        if (window.adminDashboard && window.adminDashboard.saveAssessment) {
                            window.adminDashboard.saveAssessment(e);
                        } else {
                            saveAssessment(e);
                        }
                        return false;
                    };
                    console.log(' Assessment form submission attached');
                }
                
                // Modal backdrop click
                if (modal) {
                    modal.addEventListener('click', function(e) {
                        if (e.target === modal) {
                            console.log(' Clicked outside assessment modal');
                            closeAssessmentModal();
                        }
                    });
                }
                
                console.log(' Assessment modal buttons setup complete');
            }
            
            setTimeout(function() {
                populateAssessmentSubjects();
                setupAssessmentButtons();
            }, 600);
            
            // Override openAssessmentModal
            const originalOpenAssessmentModal = window.openAssessmentModal;
            window.openAssessmentModal = function(type) {
                console.log(' Opening assessment modal for:', type);
                
                if (originalOpenAssessmentModal) {
                    originalOpenAssessmentModal(type);
                } else if (window.adminDashboard && window.adminDashboard.openAssessmentModal) {
                    window.adminDashboard.openAssessmentModal(type);
                } else {
                    // Fallback
                    const modal = document.getElementById('assessment-modal');
                    const title = document.getElementById('assessment-modal-title');
                    const typeField = document.getElementById('assessment-type');
                    const form = document.getElementById('assessment-form');
                    
                    if (modal) {
                        modal.style.display = 'flex';
                        if (title) {
                            const titles = {
                                quiz: 'Create Quiz',
                                assignment: 'Create Assignment',
                                exam: 'Create Mock Exam'
                            };
                            title.textContent = titles[type] || 'Create Assessment';
                        }
                        if (typeField) typeField.value = type;
                        if (form) form.reset();
                        
                        // Clear questions
                        const questionsContainer = document.getElementById('questions-container');
                        if (questionsContainer) {
                            questionsContainer.innerHTML = '<p style="text-align: center; color: var(--text-secondary); margin: 0;">No questions added yet. Click "Add Question" to start.</p>';
                        }
                    }
                }
                
                setTimeout(populateAssessmentSubjects, 100);
            };
            
            console.log(' Assessment modal fixes applied!');
        });
        
        // Fallback functions
        function closeAssessmentModal() {
            if (window.adminDashboard && window.adminDashboard.closeAssessmentModal) {
                window.adminDashboard.closeAssessmentModal();
            } else {
                const modal = document.getElementById('assessment-modal');
                if (modal) {
                    modal.style.display = 'none';
                    const form = document.getElementById('assessment-form');
                    if (form) form.reset();
                }
            }
        }
        
        function addQuestion() {
            if (window.adminDashboard && window.adminDashboard.addQuestion) {
                window.adminDashboard.addQuestion();
            } else {
                alert('Please add questions through the admin dashboard');
            }
        }
        
        function saveAssessment(event) {
            if (event) event.preventDefault();
            
            console.log(' Fallback saveAssessment called');
            
            const type = document.getElementById('assessment-type').value;
            const title = document.getElementById('assessment-title').value;
            const description = document.getElementById('assessment-description').value;
            const classLevel = document.getElementById('assessment-class').value;
            const stream = document.getElementById('assessment-stream').value;
            const subject = document.getElementById('assessment-subject').value;
            const duration = parseInt(document.getElementById('assessment-duration').value);
            const totalMarks = parseInt(document.getElementById('assessment-marks').value);
            const accessLevel = document.getElementById('assessment-access-level').value;
            const dueDate = document.getElementById('assessment-due-date').value;
            const dueTime = document.getElementById('assessment-due-time').value;
            
            if (!title || !classLevel || !stream || !subject || !duration || !totalMarks || !dueDate || !dueTime) {
                alert('Please fill in all required fields including stream, due date and time');
                return;
            }
            
            // Validate due date is in the future
            const dueDateTimeString = `${dueDate}T${dueTime}`;
            const dueDateTime = new Date(dueDateTimeString);
            const currentDateTime = new Date();
            
            if (dueDateTime <= currentDateTime) {
                alert('Due date and time must be in the future');
                return;
            }
            
            // Get questions from temp storage or container
            let questions = [];
            if (window.adminDashboard && window.adminDashboard.tempQuestions) {
                questions = window.adminDashboard.tempQuestions;
            }
            
            if (questions.length === 0) {
                alert('Please add at least one question');
                return;
            }
            
            const assessmentData = {
                id: Date.now(),
                type,
                title,
                description,
                classLevel,
                stream,
                subject,
                duration,
                totalMarks,
                questions,
                accessLevel: accessLevel || 'bootcamp',
                dueDate: dueDate,
                dueTime: dueTime,
                dueDateTimeISO: dueDateTime.toISOString(),
                status: 'available',
                createdAt: new Date().toISOString()
            };
            
            // Save to appropriate storage
            const storageKey = `brainwave_${type}s`;
            const items = JSON.parse(localStorage.getItem(storageKey) || '[]');
            items.push(assessmentData);
            localStorage.setItem(storageKey, JSON.stringify(items));
            
            console.log(` ${type} saved:`, assessmentData);
            alert(`${type.charAt(0).toUpperCase() + type.slice(1)} created successfully!`);
            
            closeAssessmentModal();
            
            // Trigger re-render if available
            if (window.adminDashboard) {
                if (type === 'quiz' && window.adminDashboard.renderQuizzes) {
                    window.adminDashboard.renderQuizzes();
                } else if (type === 'assignment' && window.adminDashboard.renderAssignments) {
                    window.adminDashboard.renderAssignments();
                } else if (type === 'exam' && window.adminDashboard.renderExams) {
                    window.adminDashboard.renderExams();
                }
                if (window.adminDashboard.updateAssessmentCounts) {
                    window.adminDashboard.updateAssessmentCounts();
                }
            }
        }
        
        console.log(' Assessment modal fix script loaded');
    </script>
    
    <!-- Community & Announcements Script -->
    <script>
        console.log(' Community & Announcements Script Loading...');
        
        window.addEventListener('DOMContentLoaded', function() {
            console.log(' Setting up community & announcements...');
            
            // Load community links on page load
            window.loadCommunityLinks = function() {
                const links = JSON.parse(localStorage.getItem('brainwave_community_links') || '{}');
                
                const whatsappLink = document.getElementById('whatsapp-link');
                const whatsappEnabled = document.getElementById('whatsapp-enabled');
                const telegramLink = document.getElementById('telegram-link');
                const telegramEnabled = document.getElementById('telegram-enabled');
                
                if (whatsappLink && links.whatsapp) {
                    whatsappLink.value = links.whatsapp.url || '';
                    if (whatsappEnabled) whatsappEnabled.checked = links.whatsapp.enabled || false;
                }
                
                if (telegramLink && links.telegram) {
                    telegramLink.value = links.telegram.url || '';
                    if (telegramEnabled) telegramEnabled.checked = links.telegram.enabled || false;
                }
                
                console.log(' Community links loaded');
            };
            
            // Save community links
            window.saveCommunityLinks = function() {
                const whatsappLink = document.getElementById('whatsapp-link').value;
                const whatsappEnabled = document.getElementById('whatsapp-enabled').checked;
                const telegramLink = document.getElementById('telegram-link').value;
                const telegramEnabled = document.getElementById('telegram-enabled').checked;
                
                const links = {
                    whatsapp: {
                        url: whatsappLink,
                        enabled: whatsappEnabled
                    },
                    telegram: {
                        url: telegramLink,
                        enabled: telegramEnabled
                    },
                    updatedAt: new Date().toISOString()
                };
                
                localStorage.setItem('brainwave_community_links', JSON.stringify(links));
                
                console.log(' Community links saved:', links);
                alert('Community links saved successfully!');
            };
            
            // Load announcements (broadcast messages history)
            window.loadAnnouncements = function() {
                const announcements = JSON.parse(localStorage.getItem('brainwave_announcements') || '[]');
                const container = document.getElementById('announcements-list');
                
                if (!container) return;
                
                if (announcements.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: var(--text-secondary); background: var(--white); border-radius: 8px; border: 2px solid var(--border-color);">
                            <i class="fas fa-inbox" style="font-size: 2rem; margin-bottom: 0.5rem; display: block; color: var(--border-color);"></i>
                            <p style="margin: 0; font-size: 0.875rem;">No messages sent yet.</p>
                        </div>
                    `;
                    return;
                }
                
                // Sort by date (newest first)
                announcements.sort((a, b) => {
                    return new Date(b.sentAt || b.createdAt) - new Date(a.sentAt || a.createdAt);
                });
                
                container.innerHTML = announcements.map(broadcast => {
                    const date = new Date(broadcast.sentAt || broadcast.createdAt).toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    
                    const userTypeText = broadcast.userType === 'all' ? 'All Users' : (broadcast.userType === 'students' ? 'Students' : 'Parents');
                    const classText = broadcast.classLevel === 'all' ? 'All Classes' : broadcast.classLevel;
                    
                    return `
                        <div style="background: var(--white); border-radius: 8px; padding: 1.25rem; border-left: 4px solid var(--primary-color); box-shadow: var(--shadow-sm);">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <i class="fas fa-comment-dots" style="font-size: 1.5rem; color: var(--primary-color); margin-top: 0.25rem;"></i>
                                <div style="flex: 1;">
                                    <p style="margin: 0 0 0.75rem 0; color: var(--text-primary); line-height: 1.6; font-size: 0.95rem;">${broadcast.message}</p>
                                    
                                    <div style="display: flex; gap: 1.5rem; flex-wrap: wrap; font-size: 0.8rem; color: var(--text-secondary);">
                                        <span><i class="fas fa-users"></i> ${userTypeText}</span>
                                        <span><i class="fas fa-graduation-cap"></i> ${classText}</span>
                                        <span><i class="fas fa-paper-plane"></i> ${broadcast.recipientCount} recipients</span>
                                        <span><i class="fas fa-clock"></i> ${date}</span>
                                    </div>
                                </div>
                                <button onclick="deleteAnnouncement(${broadcast.id})" style="padding: 0.4rem 0.8rem; background: var(--danger-color); color: white; border: none; border-radius: 6px; font-size: 0.75rem; cursor: pointer;">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
                
                console.log(' Broadcast messages loaded:', announcements.length);
            };
            
            // Open announcement modal
            window.openAnnouncementModal = function() {
                const modal = document.getElementById('announcement-modal');
                const form = document.getElementById('announcement-form');
                
                if (modal) {
                    modal.style.display = 'flex';
                    if (form) form.reset();
                    console.log(' Announcement modal opened');
                }
            };
            
            // Close announcement modal
            window.closeAnnouncementModal = function() {
                const modal = document.getElementById('announcement-modal');
                const form = document.getElementById('announcement-form');
                
                if (modal) {
                    modal.style.display = 'none';
                    if (form) form.reset();
                    console.log(' Announcement modal closed');
                }
            };
            
            // Setup announcement modal buttons
            setTimeout(function() {
                const closeBtn = document.getElementById('announcement-modal-close-btn');
                const cancelBtn = document.getElementById('announcement-modal-cancel-btn');
                const form = document.getElementById('announcement-form');
                
                if (closeBtn) {
                    closeBtn.onclick = function(e) {
                        e.preventDefault();
                        closeAnnouncementModal();
                    };
                }
                
                if (cancelBtn) {
                    cancelBtn.onclick = function(e) {
                        e.preventDefault();
                        closeAnnouncementModal();
                    };
                }
                
                if (form) {
                    form.onsubmit = function(e) {
                        e.preventDefault();
                        saveAnnouncement();
                        return false;
                    };
                }
                
                console.log(' Announcement modal buttons setup');
            }, 700);
            
            // Save announcement
            window.saveAnnouncement = function() {
                const title = document.getElementById('announcement-title').value;
                const message = document.getElementById('announcement-message').value;
                const target = document.getElementById('announcement-target').value;
                const priority = document.getElementById('announcement-priority').value;
                const pinned = document.getElementById('announcement-pinned').checked;
                
                if (!title || !message) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                const announcement = {
                    id: Date.now(),
                    title,
                    message,
                    target,
                    priority,
                    pinned,
                    createdAt: new Date().toISOString()
                };
                
                const announcements = JSON.parse(localStorage.getItem('brainwave_announcements') || '[]');
                announcements.push(announcement);
                localStorage.setItem('brainwave_announcements', JSON.stringify(announcements));
                
                console.log(' Announcement saved:', announcement);
                alert('Announcement sent successfully!');
                
                closeAnnouncementModal();
                loadAnnouncements();
            };
            
            // Delete announcement
            window.deleteAnnouncement = function(id) {
                if (!confirm('Are you sure you want to delete this announcement?')) return;
                
                let announcements = JSON.parse(localStorage.getItem('brainwave_announcements') || '[]');
                announcements = announcements.filter(a => a.id !== id);
                localStorage.setItem('brainwave_announcements', JSON.stringify(announcements));
                
                console.log(' Announcement deleted:', id);
                alert('Announcement deleted successfully!');
                loadAnnouncements();
            };
            
            // Edit announcement
            window.editAnnouncement = function(id) {
                const announcements = JSON.parse(localStorage.getItem('brainwave_announcements') || '[]');
                const announcement = announcements.find(a => a.id === id);
                
                if (!announcement) {
                    alert('Announcement not found');
                    return;
                }
                
                document.getElementById('announcement-title').value = announcement.title;
                document.getElementById('announcement-message').value = announcement.message;
                document.getElementById('announcement-target').value = announcement.target;
                document.getElementById('announcement-priority').value = announcement.priority;
                document.getElementById('announcement-pinned').checked = announcement.pinned;
                
                openAnnouncementModal();
                
                // Update save function to edit instead
                const form = document.getElementById('announcement-form');
                form.onsubmit = function(e) {
                    e.preventDefault();
                    
                    announcement.title = document.getElementById('announcement-title').value;
                    announcement.message = document.getElementById('announcement-message').value;
                    announcement.target = document.getElementById('announcement-target').value;
                    announcement.priority = document.getElementById('announcement-priority').value;
                    announcement.pinned = document.getElementById('announcement-pinned').checked;
                    announcement.updatedAt = new Date().toISOString();
                    
                    const index = announcements.findIndex(a => a.id === id);
                    announcements[index] = announcement;
                    localStorage.setItem('brainwave_announcements', JSON.stringify(announcements));
                    
                    alert('Announcement updated successfully!');
                    closeAnnouncementModal();
                    loadAnnouncements();
                    
                    return false;
                };
            };
            
            // Calculate target users for community links
            window.calculateCommunityTargetUsers = function() {
                const userType = document.getElementById('community-user-type').value;
                const classLevel = document.getElementById('community-class-level').value;
                const subscription = document.getElementById('community-subscription').value;
                
                // Get all users from localStorage
                const users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
                
                let filteredUsers = users.filter(user => {
                    // Filter by user type
                    if (userType === 'students' && user.role !== 'student') return false;
                    if (userType === 'parents' && user.role !== 'parent') return false;
                    
                    // Filter by class level
                    if (classLevel !== 'all' && user.classLevel !== classLevel) return false;
                    
                    // Filter by subscription status
                    if (subscription === 'active' && user.status !== 'active') return false;
                    if (subscription === 'bootcamp' && user.status !== 'bootcamp') return false;
                    
                    return true;
                });
                
                const count = filteredUsers.length;
                document.getElementById('community-target-count').textContent = count;
                
                console.log(' Community target users calculated:', count);
                return count;
            };
            
            // Send community links to selected users
            window.sendCommunityLinks = function() {
                const userType = document.getElementById('community-user-type').value;
                const classLevel = document.getElementById('community-class-level').value;
                const subscription = document.getElementById('community-subscription').value;
                
                // Get community links
                const links = JSON.parse(localStorage.getItem('brainwave_community_links') || '{}');
                
                // Check if links are configured
                if (!links.whatsapp && !links.telegram) {
                    alert('Please save community links first before sending.');
                    return;
                }
                
                // Calculate recipients
                const recipientCount = calculateCommunityTargetUsers();
                
                if (recipientCount === 0) {
                    alert('No users match the selected filters. Please adjust your filters.');
                    return;
                }
                
                // Build message
                let message = 'Join our community:\n';
                if (links.whatsapp && links.whatsapp.enabled && links.whatsapp.url) {
                    message += `\n WhatsApp: ${links.whatsapp.url}`;
                }
                if (links.telegram && links.telegram.enabled && links.telegram.url) {
                    message += `\n Telegram: ${links.telegram.url}`;
                }
                
                if (!confirm(`Send community links to ${recipientCount} user(s)?\n\n${message}`)) {
                    return;
                }
                
                // Create notification for community links
                const notification = {
                    id: Date.now(),
                    type: 'community_links',
                    title: 'Join Our Community',
                    message: message,
                    links: {
                        whatsapp: links.whatsapp && links.whatsapp.enabled ? links.whatsapp.url : null,
                        telegram: links.telegram && links.telegram.enabled ? links.telegram.url : null
                    },
                    filters: {
                        userType: userType,
                        classLevel: classLevel,
                        subscription: subscription
                    },
                    sentAt: new Date().toISOString(),
                    sentBy: 'admin',
                    recipientCount: recipientCount,
                    read: false
                };
                
                // Save to localStorage
                const notifications = JSON.parse(localStorage.getItem('brainwave_community_notifications') || '[]');
                notifications.push(notification);
                localStorage.setItem('brainwave_community_notifications', JSON.stringify(notifications));
                
                console.log(' Community links sent:', notification);
                alert(`Community links sent successfully to ${recipientCount} user(s)!`);
                
                // Reset filters
                document.getElementById('community-user-type').value = 'all';
                document.getElementById('community-class-level').value = 'all';
                document.getElementById('community-subscription').value = 'all';
                document.getElementById('community-target-count').textContent = '0';
            };
            
            // Auto-calculate when community filters change
            setTimeout(function() {
                const communityFilters = ['community-user-type', 'community-class-level', 'community-subscription'];
                communityFilters.forEach(filterId => {
                    const element = document.getElementById(filterId);
                    if (element) {
                        element.addEventListener('change', function() {
                            calculateCommunityTargetUsers();
                        });
                    }
                });
                console.log(' Community links filters setup');
            }, 900);
            
            // Calculate target users for broadcast message
            window.calculateBroadcastTargetUsers = function() {
                const userType = document.getElementById('broadcast-user-type').value;
                const classLevel = document.getElementById('broadcast-class-level').value;
                
                // Get all users from localStorage
                const users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
                
                let filteredUsers = users.filter(user => {
                    // Filter by user type
                    if (userType === 'students' && user.role !== 'student') return false;
                    if (userType === 'parents' && user.role !== 'parent') return false;
                    
                    // Filter by class level
                    if (classLevel !== 'all' && user.classLevel !== classLevel) return false;
                    
                    return true;
                });
                
                const count = filteredUsers.length;
                document.getElementById('broadcast-target-count').textContent = count;
                
                console.log(' Broadcast target users calculated:', count);
                return count;
            };
            
            // Send broadcast message
            window.sendBroadcastMessage = function() {
                const message = document.getElementById('broadcast-message').value;
                const userType = document.getElementById('broadcast-user-type').value;
                const classLevel = document.getElementById('broadcast-class-level').value;
                
                if (!message || message.trim() === '') {
                    alert('Please enter a message to broadcast');
                    return;
                }
                
                // Calculate recipients
                const recipientCount = calculateBroadcastTargetUsers();
                
                if (recipientCount === 0) {
                    alert('No users match the selected criteria. Please adjust your filters.');
                    return;
                }
                
                // Confirm before sending
                const userTypeText = userType === 'all' ? 'All Users' : (userType === 'students' ? 'Students' : 'Parents');
                const classText = classLevel === 'all' ? 'All Classes' : classLevel;
                
                if (!confirm(`Send message to ${recipientCount} user(s)?\n\nTarget: ${userTypeText} - ${classText}\n\nMessage: ${message.substring(0, 100)}${message.length > 100 ? '...' : ''}`)) {
                    return;
                }
                
                // Create broadcast message object
                const broadcast = {
                    id: Date.now(),
                    message: message,
                    userType: userType,
                    classLevel: classLevel,
                    recipientCount: recipientCount,
                    sentAt: new Date().toISOString(),
                    sentBy: 'admin'
                };
                
                // Save to announcements list
                const announcements = JSON.parse(localStorage.getItem('brainwave_announcements') || '[]');
                announcements.unshift(broadcast); // Add to beginning
                localStorage.setItem('brainwave_announcements', JSON.stringify(announcements));
                
                console.log(' Broadcast message sent:', broadcast);
                alert(`Message sent successfully to ${recipientCount} user(s)!`);
                
                // Clear form
                document.getElementById('broadcast-message').value = '';
                document.getElementById('broadcast-user-type').value = 'all';
                document.getElementById('broadcast-class-level').value = 'all';
                document.getElementById('broadcast-target-count').textContent = '0';
                
                // Reload messages history
                loadAnnouncements();
            };
            
            // Auto-calculate when broadcast filters change
            setTimeout(function() {
                const broadcastFilters = ['broadcast-user-type', 'broadcast-class-level'];
                broadcastFilters.forEach(filterId => {
                    const element = document.getElementById(filterId);
                    if (element) {
                        element.addEventListener('change', function() {
                            calculateBroadcastTargetUsers();
                        });
                    }
                });
                console.log(' Broadcast filters setup');
            }, 1000);
            
            console.log(' Community & Announcements setup complete');
        });
        
        console.log(' Community & Announcements script loaded');
    </script>
    
    <script>
        console.log(' Assessment modal fix script loaded');
        
        // IMMEDIATE SETUP for assessment buttons (don't wait for DOMContentLoaded)
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
            console.log(' Setting up assessment buttons immediately...');
            setTimeout(function() {
                const closeBtn = document.getElementById('assessment-modal-close-btn');
                const cancelBtn = document.getElementById('assessment-modal-cancel-btn');
                const addQuestionBtn = document.getElementById('add-question-btn');
                const form = document.getElementById('assessment-form');
                
                if (closeBtn) {
                    closeBtn.onclick = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log(' Assessment close clicked (immediate)');
                        const modal = document.getElementById('assessment-modal');
                        if (modal) {
                            modal.style.display = 'none';
                            if (form) form.reset();
                            const questionsContainer = document.getElementById('questions-container');
                            if (questionsContainer) {
                                questionsContainer.innerHTML = '<p style="text-align: center; color: var(--text-secondary); margin: 0;">No questions added yet. Click "Add Question" to start.</p>';
                            }
                            if (window.adminDashboard && window.adminDashboard.tempQuestions) {
                                window.adminDashboard.tempQuestions = [];
                            }
                        }
                    };
                    console.log(' Assessment close button immediate setup');
                }
                
                if (cancelBtn) {
                    cancelBtn.onclick = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log(' Assessment cancel clicked (immediate)');
                        const modal = document.getElementById('assessment-modal');
                        if (modal) {
                            modal.style.display = 'none';
                            if (form) form.reset();
                            const questionsContainer = document.getElementById('questions-container');
                            if (questionsContainer) {
                                questionsContainer.innerHTML = '<p style="text-align: center; color: var(--text-secondary); margin: 0;">No questions added yet. Click "Add Question" to start.</p>';
                            }
                            if (window.adminDashboard && window.adminDashboard.tempQuestions) {
                                window.adminDashboard.tempQuestions = [];
                            }
                        }
                    };
                    console.log(' Assessment cancel button immediate setup');
                }
                
                if (addQuestionBtn) {
                    addQuestionBtn.onclick = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log(' Add question clicked (immediate)');
                        if (window.adminDashboard && window.adminDashboard.addQuestion) {
                            window.adminDashboard.addQuestion();
                        } else {
                            alert('Please ensure the admin dashboard is fully loaded');
                        }
                    };
                    console.log(' Add question button immediate setup');
                }
                
                if (form) {
                    form.onsubmit = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log(' Assessment save clicked (immediate)');
                        
                        if (window.adminDashboard && window.adminDashboard.saveAssessment) {
                            window.adminDashboard.saveAssessment(e);
                        } else {
                            saveAssessment(e);
                        }
                        return false;
                    };
                    console.log(' Assessment form immediate setup');
                }
                
                console.log(' Assessment immediate setup complete');
            }, 150);
        }
    </script>
    
    <!-- Assessment Tab Switching Fix -->
    <script>
        console.log(' Assessment Tab Switch Fix Loading...');
        
        window.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                const assessmentTabButtons = document.querySelectorAll('.assessment-tab-btn');
                console.log(' Found', assessmentTabButtons.length, 'assessment tab buttons');
                
                assessmentTabButtons.forEach((btn, index) => {
                    btn.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        
                        // Determine which tab was clicked
                        let tab = 'quizzes';
                        if (this.textContent.toLowerCase().includes('assignment')) {
                            tab = 'assignments';
                        } else if (this.textContent.toLowerCase().includes('exam')) {
                            tab = 'exams';
                        }
                        
                        console.log(' Clicked assessment tab:', tab);
                        
                        // Hide all assessment content tabs
                        document.querySelectorAll('.assessment-tab-content').forEach(content => {
                            content.style.display = 'none';
                            content.classList.remove('active');
                        });
                        
                        // Reset all assessment tab buttons
                        document.querySelectorAll('.assessment-tab-btn').forEach(b => {
                            b.classList.remove('active');
                            b.style.background = 'none';
                            b.style.color = 'var(--text-secondary)';
                            b.style.boxShadow = 'none';
                        });
                        
                        // Show clicked tab content
                        const tabContent = document.getElementById(tab + '-assessment-tab');
                        if (tabContent) {
                            tabContent.style.display = 'block';
                            tabContent.classList.add('active');
                            console.log(' Showing tab:', tab);
                        } else {
                            console.error(' Tab content not found:', tab + '-assessment-tab');
                        }
                        
                        // Activate clicked button
                        this.classList.add('active');
                        this.style.background = 'var(--primary-gradient)';
                        this.style.color = 'var(--white)';
                        this.style.boxShadow = 'var(--shadow-sm)';
                    });
                });
                
                console.log(' Assessment tab switching ready!');
            }, 100); // Small delay to ensure DOM is fully loaded
        });
    </script>
    
    <script>
        // Global functions to ensure button functionality
        function openSubscriptionModal() {
            if (window.adminDashboard && window.adminDashboard.openSubscriptionModal) {
                window.adminDashboard.openSubscriptionModal();
            } else {
                // Fallback direct modal opening
                const modal = document.getElementById('subscription-modal');
                if (modal) {
                    modal.classList.add('active');
                    modal.style.display = 'flex';
                    modal.style.alignItems = 'center';
                    modal.style.justifyContent = 'center';
                    
                    const form = document.getElementById('subscription-form');
                    if (form) form.reset();
                    
                    const title = document.getElementById('subscription-modal-title');
                    if (title) title.textContent = 'Add New Subscription';
                }
            }
        }
        
        function closeSubscriptionModal() {
            if (window.adminDashboard && window.adminDashboard.closeSubscriptionModal) {
                window.adminDashboard.closeSubscriptionModal();
            } else {
                // Fallback direct modal closing
                const modal = document.getElementById('subscription-modal');
                if (modal) {
                    modal.classList.remove('active');
                    modal.style.display = 'none';
                    
                    const form = document.getElementById('subscription-form');
                    if (form) form.reset();
                }
            }
        }
        
        // Global function for opening content modal (Add Book/Video)
        function openContentModal(type = 'book') {
            console.log('Global openContentModal called for:', type);
            if (window.adminDashboard && window.adminDashboard.openContentModal) {
                window.adminDashboard.openContentModal(type);
            } else {
                // Fallback direct modal opening
                console.log('Using fallback modal opening');
                const modal = document.getElementById('content-modal');
                if (modal) {
                    modal.classList.add('active');
                    modal.style.display = 'flex';
                    modal.style.alignItems = 'center';
                    modal.style.justifyContent = 'center';
                    
                    const form = document.getElementById('content-form');
                    if (form) form.reset();
                    
                    const title = document.getElementById('content-modal-title');
                    if (title) title.textContent = `Add ${type === 'book' ? 'Book' : 'Video'}`;
                    
                    const contentType = document.getElementById('content-type');
                    if (contentType) contentType.value = type;
                    
                    // Show/hide appropriate fields
                    const bookLinkField = document.getElementById('book-link-field');
                    const videoLinkField = document.getElementById('video-link-field');
                    const videoDurationField = document.getElementById('video-duration-field');
                    
                    if (type === 'book') {
                        if (bookLinkField) bookLinkField.style.display = 'block';
                        if (videoLinkField) videoLinkField.style.display = 'none';
                        if (videoDurationField) videoDurationField.style.display = 'none';
                    } else {
                        if (bookLinkField) bookLinkField.style.display = 'none';
                        if (videoLinkField) videoLinkField.style.display = 'block';
                        if (videoDurationField) videoDurationField.style.display = 'block';
                    }
                } else {
                    console.error('Content modal not found!');
                    alert('Error: Modal not found. Please refresh the page.');
                }
            }
        }
        
        function closeContentModal() {
            if (window.adminDashboard && window.adminDashboard.closeContentModal) {
                window.adminDashboard.closeContentModal();
            } else {
                // Fallback direct modal closing
                const modal = document.getElementById('content-modal');
                if (modal) {
                    modal.classList.remove('active');
                    modal.style.display = 'none';
                    
                    const form = document.getElementById('content-form');
                    if (form) form.reset();
                }
            }
        }
        
        // Global function for updating content form fields
        function updateContentFormFields() {
            console.log('Global updateContentFormFields called');
            if (window.adminDashboard && window.adminDashboard.updateContentFormFields) {
                window.adminDashboard.updateContentFormFields();
            } else {
                // Fallback implementation
                const type = document.getElementById('content-type')?.value;
                const bookLinkField = document.getElementById('book-link-field');
                const videoLinkField = document.getElementById('video-link-field');
                const videoDurationField = document.getElementById('video-duration-field');
                
                if (type === 'book') {
                    if (bookLinkField) bookLinkField.style.display = 'block';
                    if (videoLinkField) videoLinkField.style.display = 'none';
                    if (videoDurationField) videoDurationField.style.display = 'none';
                } else {
                    if (bookLinkField) bookLinkField.style.display = 'none';
                    if (videoLinkField) videoLinkField.style.display = 'block';
                    if (videoDurationField) videoDurationField.style.display = 'block';
                }
            }
        }
        
        // Global functions for book actions
        function viewBook(id) {
            console.log('Global viewBook called for ID:', id);
            if (window.adminDashboard && window.adminDashboard.viewBook) {
                window.adminDashboard.viewBook(id);
            } else {
                // Fallback implementation
                const books = JSON.parse(localStorage.getItem('brainwave_books') || '[]');
                const book = books.find(b => b.id === id);
                if (book && book.link) {
                    window.open(book.link, '_blank');
                } else {
                    alert('Book link not available');
                }
            }
        }
        
        function editBook(id) {
            console.log('Global editBook called for ID:', id);
            if (window.adminDashboard && window.adminDashboard.editBook) {
                window.adminDashboard.editBook(id);
            } else {
                // Fallback implementation
                const books = JSON.parse(localStorage.getItem('brainwave_books') || '[]');
                const book = books.find(b => b.id === id);
                if (!book) {
                    alert('Book not found');
                    return;
                }
                
                // Open modal and populate with book data
                openContentModal('book');
                
                setTimeout(() => {
                    document.getElementById('content-modal-title').textContent = 'Edit Book';
                    document.getElementById('content-title').value = book.title;
                    document.getElementById('content-description').value = book.description;
                    document.getElementById('content-class').value = book.classLevel;
                    document.getElementById('content-subject').value = book.subject;
                    document.getElementById('book-link').value = book.link;
                    
                    // Store the ID for updating
                    window.editingBookId = id;
                }, 100);
            }
        }
        
        function deleteBook(id) {
            console.log('Global deleteBook called for ID:', id);
            if (window.adminDashboard && window.adminDashboard.deleteBook) {
                window.adminDashboard.deleteBook(id);
            } else {
                // Fallback implementation
                const books = JSON.parse(localStorage.getItem('brainwave_books') || '[]');
                const book = books.find(b => b.id === id);
                
                if (!book) {
                    alert('Book not found');
                    return;
                }
                
                if (confirm(`Are you sure you want to delete "${book.title}"? This action cannot be undone.`)) {
                    const updatedBooks = books.filter(b => b.id !== id);
                    localStorage.setItem('brainwave_books', JSON.stringify(updatedBooks));
                    
                    // Remove the book card from DOM without reloading
                    const bookCard = document.querySelector(`[data-book-id="${id}"]`);
                    if (bookCard) {
                        bookCard.style.transition = 'opacity 0.3s ease';
                        bookCard.style.opacity = '0';
                        setTimeout(() => bookCard.remove(), 300);
                    }
                    
                    // Show success message using toast if available
                    if (window.adminDashboard && window.adminDashboard.showToast) {
                        window.adminDashboard.showToast('Book deleted successfully!', 'success');
                    } else {
                        alert('Book deleted successfully!');
                    }
                }
            }
        }
        
        // Global functions for video actions
        function viewVideo(id) {
            console.log('Global viewVideo called for ID:', id);
            if (window.adminDashboard && window.adminDashboard.viewVideo) {
                window.adminDashboard.viewVideo(id);
            } else {
                // Fallback implementation
                const videos = JSON.parse(localStorage.getItem('brainwave_videos') || '[]');
                const video = videos.find(v => v.id === id);
                if (video && video.link) {
                    window.open(video.link, '_blank');
                } else {
                    alert('Video link not available');
                }
            }
        }
        
        function editVideo(id) {
            console.log('Global editVideo called for ID:', id);
            if (window.adminDashboard && window.adminDashboard.editVideo) {
                window.adminDashboard.editVideo(id);
            } else {
                // Fallback implementation
                const videos = JSON.parse(localStorage.getItem('brainwave_videos') || '[]');
                const video = videos.find(v => v.id === id);
                if (!video) {
                    alert('Video not found');
                    return;
                }
                
                // Open modal and populate with video data
                openContentModal('video');
                
                setTimeout(() => {
                    document.getElementById('content-modal-title').textContent = 'Edit Video';
                    document.getElementById('content-title').value = video.title;
                    document.getElementById('content-description').value = video.description;
                    document.getElementById('content-class').value = video.classLevel;
                    document.getElementById('content-subject').value = video.subject;
                    document.getElementById('video-link').value = video.link;
                    document.getElementById('video-duration').value = video.duration || '';
                    
                    // Store the ID for updating
                    window.editingVideoId = id;
                }, 100);
            }
        }
        
        function deleteVideo(id) {
            console.log('Global deleteVideo called for ID:', id);
            if (window.adminDashboard && window.adminDashboard.deleteVideo) {
                window.adminDashboard.deleteVideo(id);
            } else {
                // Fallback implementation
                const videos = JSON.parse(localStorage.getItem('brainwave_videos') || '[]');
                const video = videos.find(v => v.id === id);
                
                if (!video) {
                    alert('Video not found');
                    return;
                }
                
                if (confirm(`Are you sure you want to delete "${video.title}"? This action cannot be undone.`)) {
                    const updatedVideos = videos.filter(v => v.id !== id);
                    localStorage.setItem('brainwave_videos', JSON.stringify(updatedVideos));
                    
                    // Remove the video card from DOM without reloading
                    const videoCard = document.querySelector(`[data-video-id="${id}"]`);
                    if (videoCard) {
                        videoCard.style.transition = 'opacity 0.3s ease';
                        videoCard.style.opacity = '0';
                        setTimeout(() => videoCard.remove(), 300);
                    }
                    
                    // Show success message using toast if available
                    if (window.adminDashboard && window.adminDashboard.showToast) {
                        window.adminDashboard.showToast('Video deleted successfully!', 'success');
                    } else {
                        alert('Video deleted successfully!');
                    }
                }
            }
        }
        
        // Global function for saving content (Add Book/Video)
        function saveContent(event) {
            event.preventDefault();
            console.log('Global saveContent called');
            
            if (window.adminDashboard && window.adminDashboard.saveContent) {
                window.adminDashboard.saveContent(event);
            } else {
                // Fallback save implementation
                console.log('Using fallback save implementation');
                
                const type = document.getElementById('content-type')?.value;
                const title = document.getElementById('content-title')?.value;
                const description = document.getElementById('content-description')?.value;
                const classLevel = document.getElementById('content-class')?.value;
                const subject = document.getElementById('content-subject')?.value;
                
                if (!title || !description || !classLevel || !subject) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                if (type === 'book') {
                    const link = document.getElementById('book-link')?.value;
                    if (!link) {
                        alert('Please provide a Google Drive link');
                        return;
                    }
                    
                    // Get existing books
                    const books = JSON.parse(localStorage.getItem('brainwave_books') || '[]');
                    
                    // Add new book
                    const newBook = {
                        id: Date.now(),
                        title,
                        description,
                        classLevel,
                        subject,
                        link,
                        createdAt: new Date().toISOString()
                    };
                    
                    books.push(newBook);
                    localStorage.setItem('brainwave_books', JSON.stringify(books));
                    
                    console.log('Book saved (fallback):', newBook);
                    
                    closeContentModal();
                    
                    // Trigger re-render if adminDashboard is available, otherwise add to DOM directly
                    if (window.adminDashboard && window.adminDashboard.renderBooks) {
                        window.adminDashboard.books = books;
                        window.adminDashboard.renderBooks();
                        window.adminDashboard.showToast('Book added successfully!', 'success');
                    } else {
                        alert('Book added successfully!');
                        // Fallback: trigger a re-render by dispatching a custom event
                        window.dispatchEvent(new CustomEvent('booksUpdated'));
                    }
                } else {
                    const link = document.getElementById('video-link')?.value;
                    const duration = document.getElementById('video-duration')?.value || '';
                    
                    if (!link) {
                        alert('Please provide a YouTube link');
                        return;
                    }
                    
                    // Get existing videos
                    const videos = JSON.parse(localStorage.getItem('brainwave_videos') || '[]');
                    
                    // Add new video
                    const newVideo = {
                        id: Date.now(),
                        title,
                        description,
                        classLevel,
                        subject,
                        link,
                        duration,
                        createdAt: new Date().toISOString()
                    };
                    
                    videos.push(newVideo);
                    localStorage.setItem('brainwave_videos', JSON.stringify(videos));
                    
                    console.log('Video saved (fallback):', newVideo);
                    
                    closeContentModal();
                    
                    // Trigger re-render if adminDashboard is available, otherwise add to DOM directly
                    if (window.adminDashboard && window.adminDashboard.renderVideos) {
                        window.adminDashboard.videos = videos;
                        window.adminDashboard.renderVideos();
                        window.adminDashboard.showToast('Video added successfully!', 'success');
                    } else {
                        alert('Video added successfully!');
                        // Fallback: trigger a re-render by dispatching a custom event
                        window.dispatchEvent(new CustomEvent('videosUpdated'));
                    }
                }
            }
        }
        
        function saveSubscription(event) {
            event.preventDefault();
            
            if (window.adminDashboard && window.adminDashboard.saveSubscription) {
                window.adminDashboard.saveSubscription(event);
            } else {
                // Complete fallback implementation
                console.log('Using fallback saveSubscription');
                
                const email = document.getElementById('subscription-email').value;
                const name = document.getElementById('subscription-name').value;
                const role = document.getElementById('subscription-role').value;
                const plan = document.getElementById('subscription-plan').value;
                const planType = document.getElementById('subscription-plan-type').value;
                const paymentStatus = document.getElementById('subscription-payment-status').value;
                const expiry = document.getElementById('subscription-expiry').value;
                const locked = document.getElementById('subscription-locked').checked;
                
                // Validate required fields
                if (!email || !name || !role || !plan || !planType || !paymentStatus) {
                    alert('Please fill in all required fields!');
                    return;
                }
                
                // Calculate expiry date based on plan and payment status
                let expiryDate = expiry;
                
                // Determine if user is paid
                const isPaid = paymentStatus === 'paid';
                
                if (!expiry) {
                    if (isPaid) {
                        // Paid members: No expiry
                        expiryDate = null;
                    } else if (plan === 'bootcamp') {
                        // Bootcamp: 7 days from now
                        const date = new Date();
                        date.setDate(date.getDate() + 7);
                        expiryDate = date.toISOString().split('T')[0];
                    } else {
                        // Time-based plans: Calculate based on days
                        const days = parseInt(plan);
                        const date = new Date();
                        date.setDate(date.getDate() + days);
                        expiryDate = date.toISOString().split('T')[0];
                    }
                }
                
                const subscription = {
                    id: Date.now(),
                    email: email,
                    name: name,
                    role: role,
                    plan: plan,
                    planType: planType,
                    status: plan === 'bootcamp' ? 'bootcamp' : 'active',
                    paymentStatus: paymentStatus,
                    isPaid: isPaid,
                    paidDate: isPaid ? new Date().toISOString().split('T')[0] : null,
                    expiry: expiryDate,
                    expiryDate: expiryDate,
                    locked: locked,
                    accountLocked: locked,
                    joinDate: new Date().toISOString().split('T')[0],
                    bootcampStartDate: plan === 'bootcamp' ? new Date().toISOString().split('T')[0] : null,
                    planHistory: [{
                        from: null,
                        to: plan,
                        changedAt: new Date().toISOString(),
                        changedBy: 'admin'
                    }]
                };
                
                // Save to both localStorage locations
                let users = JSON.parse(localStorage.getItem('users') || '[]');
                users.push(subscription);
                localStorage.setItem('users', JSON.stringify(users));
                localStorage.setItem('brainwave_users', JSON.stringify(users));
                
                // Update tables
                updateUsersTable(users);
                updateSubscriptionTable(users);
                
                // Close modal and show success
                closeSubscriptionModal();
                alert(`Subscription added successfully!\nExpiry date: ${expiryDate || 'No expiry (Paid member)'}`);
            }
        }
        
        function updateUsersTable(users) {
            console.log('updateUsersTable called with:', users.length, 'users');
            const tbody = document.getElementById('users-table-body');
            if (!tbody) {
                console.error('Table body not found!');
                return;
            }
            
            if (users.length === 0) {
                console.log('No users, showing empty state');
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" style="padding: 3rem; text-align: center; color: var(--text-secondary);">
                            <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 0.5rem; display: block; color: var(--border-color);"></i>
                            No users found
                        </td>
                    </tr>
                `;
                return;
            }
            
            console.log('Rendering table with users:', users);
            tbody.innerHTML = users.map(user => createUserRowHTML(user)).join('');
            console.log('Table updated successfully');
        }
        
        function createUserRowHTML(user) {
            const statusBadge = getStatusBadgeHTML(user);
            const bootcampInfo = getBootcampInfoHTML(user);
            const paymentStatusBadge = getPaymentStatusBadgeHTML(user);
            const roleBadge = getRoleBadgeHTML(user);
            
            return `
                <tr style="border-bottom: 1px solid var(--border-color);">
                    <td style="padding: 0.75rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-user"></i>
                            <span style="font-weight: 600;">${user.name}</span>
                        </div>
                    </td>
                    <td style="padding: 0.75rem; color: var(--text-secondary);">${user.email}</td>
                    <td style="padding: 0.75rem; text-align: center;">${roleBadge}</td>
                    <td style="padding: 0.75rem; text-align: center;">${statusBadge}</td>
                    <td style="padding: 0.75rem; text-align: center;">
                        <select onchange="editUserPaymentStatus(${user.id}, this.value)" 
                                style="padding: 0.25rem 0.5rem; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.75rem; background: white;">
                            <option value="bootcamp" ${(!user.paymentStatus || user.paymentStatus === 'bootcamp') ? 'selected' : ''}>Bootcamp</option>
                            <option value="paid" ${user.paymentStatus === 'paid' ? 'selected' : ''}>Paid</option>
                        </select>
                        ${paymentStatusBadge}
                    </td>
                    <td style="padding: 0.75rem; text-align: center;">
                        <select onchange="editUserPlan(${user.id}, this.value)" 
                                style="padding: 0.25rem 0.5rem; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.75rem; background: white;">
                            <option value="bootcamp" ${user.plan === 'bootcamp' ? 'selected' : ''}>7-Day Bootcamp</option>
                            <option value="30" ${user.plan === '30' ? 'selected' : ''}>30-Day Plan</option>
                            <option value="60" ${user.plan === '60' ? 'selected' : ''}>60-Day Plan</option>
                            <option value="90" ${user.plan === '90' ? 'selected' : ''}>90-Day Plan</option>
                        </select>
                        ${bootcampInfo}
                    </td>
                    <td style="padding: 0.75rem; text-align: center;">
                        <select onchange="editUserPlanType(${user.id}, this.value)" 
                                style="padding: 0.25rem 0.5rem; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.75rem; background: white;">
                            <option value="Individual" ${(!user.planType || user.planType === 'Individual') ? 'selected' : ''}>Individual</option>
                            <option value="Family" ${user.planType === 'Family' ? 'selected' : ''}>Family</option>
                        </select>
                    </td>
                    <td style="padding: 0.75rem; text-align: center;">
                        ${getExpiryDisplayHTML(user)}
                    </td>
                    <td style="padding: 0.75rem; text-align: center;">
                        <label class="toggle-switch">
                            <input type="checkbox" ${user.locked ? 'checked' : ''} 
                                   onchange="toggleUserLock(${user.id})">
                            <span class="toggle-slider"></span>
                        </label>
                        <div style="font-size: 0.6rem; margin-top: 2px; color: var(--text-secondary);">
                            ${user.locked ? 'Locked' : 'Active'}
                        </div>
                    </td>
                </tr>
            `;
        }
        
        function getStatusBadgeHTML(user) {
            if (user.locked) {
                return '<span style="background: #ef4444; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-lock"></i> Locked</span>';
            }
            
            if (user.status === 'bootcamp') {
                const bootcampDays = getBootcampRemainingDays(user);
                const bootcampColor = bootcampDays <= 2 ? '#f59e0b' : '#10b981';
                return `<span style="background: ${bootcampColor}; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-gift"></i> Bootcamp (${bootcampDays}d left)</span>`;
            }
            
            if (user.status === 'active') {
                return '<span style="background: #3b82f6; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-check-circle"></i> Active</span>';
            }
            
            return '<span style="background: #6b7280; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-times-circle"></i> Expired</span>';
        }
        
        function getBootcampRemainingDays(user) {
            if (!user.bootcampStartDate) return 7;
            
            const startDate = new Date(user.bootcampStartDate);
            const today = new Date();
            const daysPassed = Math.floor((today - startDate) / (1000 * 60 * 60 * 24));
            return Math.max(0, 7 - daysPassed);
        }
        
        function getBootcampInfoHTML(user) {
            if (user.plan !== 'bootcamp') return '';
            
            const remainingDays = getBootcampRemainingDays(user);
            const planChanges = user.planHistory ? user.planHistory.length - 1 : 0;
            
            let infoHtml = `<div style="font-size: 0.65rem; margin-top: 0.25rem; color: var(--text-secondary);">`;
            
            if (remainingDays > 0) {
                const color = remainingDays <= 2 ? '#f59e0b' : '#10b981';
                infoHtml += `<div style="color: ${color}; font-weight: 600;"><i class="fas fa-clock"></i> ${remainingDays} days left</div>`;
            } else {
                infoHtml += `<div style="color: #ef4444; font-weight: 600;"><i class="fas fa-exclamation-triangle"></i> Expired</div>`;
            }
            
            if (planChanges > 0) {
                infoHtml += `<div style="color: #6b7280; margin-top: 0.125rem;"><i class="fas fa-exchange-alt"></i> ${planChanges} plan change${planChanges > 1 ? 's' : ''}</div>`;
            }
            
            infoHtml += `</div>`;
            return infoHtml;
        }
        
        function getPaymentStatusBadgeHTML(user) {
            const isPaid = user.isPaid || user.paymentStatus === 'paid';
            
            if (isPaid) {
                return '<div style="font-size: 0.65rem; margin-top: 0.25rem;"><span style="background: #10b981; color: white; padding: 0.15rem 0.5rem; border-radius: 8px; font-weight: 600;"><i class="fas fa-check-circle"></i> Paid</span></div>';
            } else {
                return '<div style="font-size: 0.65rem; margin-top: 0.25rem;"><span style="background: #f59e0b; color: white; padding: 0.15rem 0.5rem; border-radius: 8px; font-weight: 600;"><i class="fas fa-graduation-cap"></i> Bootcamp</span></div>';
            }
        }
        
        function getRoleBadgeHTML(user) {
            const role = user.role || 'student';
            
            if (role === 'student') {
                return '<span style="background: #3b82f6; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-user-graduate"></i> Student</span>';
            } else if (role === 'parent') {
                return '<span style="background: #8b5cf6; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-users"></i> Parent</span>';
            } else if (role === 'admin') {
                return '<span style="background: #ef4444; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-user-shield"></i> Admin</span>';
            } else {
                return '<span style="background: #6b7280; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-user"></i> User</span>';
            }
        }
        
        function getExpiryDisplayHTML(user) {
            // Paid members have no expiry
            if (user.paymentStatus === 'paid' || user.isPaid) {
                return '<span style="color: #10b981; font-size: 0.75rem; font-weight: 600;"><i class="fas fa-infinity"></i> No Expiry (Paid)</span>';
            }
            
            const expiryDate = user.expiry || user.expiryDate;
            
            if (!expiryDate) {
                return '<span style="color: #ef4444; font-size: 0.75rem;">No expiry set</span>';
            }
            
            // Calculate days remaining
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const expiry = new Date(expiryDate);
            expiry.setHours(0, 0, 0, 0);
            const daysRemaining = Math.floor((expiry - today) / (1000 * 60 * 60 * 24));
            
            let daysColor = '#10b981'; // green
            let daysIcon = 'fa-check-circle';
            
            if (daysRemaining < 0) {
                daysColor = '#ef4444'; // red
                daysIcon = 'fa-times-circle';
            } else if (daysRemaining <= 2) {
                daysColor = '#ef4444'; // red
                daysIcon = 'fa-exclamation-circle';
            } else if (daysRemaining <= 7) {
                daysColor = '#f59e0b'; // orange
                daysIcon = 'fa-clock';
            }
            
            const daysText = daysRemaining < 0 ? `Expired ${Math.abs(daysRemaining)} day${Math.abs(daysRemaining) !== 1 ? 's' : ''} ago` :
                            daysRemaining === 0 ? 'Expires today' :
                            `${daysRemaining} day${daysRemaining !== 1 ? 's' : ''} left`;
            
            return `
                <div style="display: flex; flex-direction: column; align-items: center; gap: 0.25rem;">
                    <input type="date" value="${expiryDate}" 
                           onchange="editUserExpiry(${user.id}, this.value)"
                           style="padding: 0.25rem; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.75rem; width: 120px;">
                    <span style="color: ${daysColor}; font-size: 0.65rem; font-weight: 600;">
                        <i class="fas ${daysIcon}"></i> ${daysText}
                    </span>
                </div>
            `;
        }
        
        // Global functions for table functionality
        function editUserPaymentStatus(userId, newPaymentStatus) {
            let users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
            const userIndex = users.findIndex(u => u.id == userId);
            
            if (userIndex !== -1) {
                const user = users[userIndex];
                user.paymentStatus = newPaymentStatus;
                user.isPaid = newPaymentStatus === 'paid';
                user.paidDate = newPaymentStatus === 'paid' ? new Date().toISOString().split('T')[0] : null;
                
                // Automatically set expiry date based on payment status
                if (newPaymentStatus === 'paid') {
                    // Paid members: No expiry (set to null or far future)
                    user.expiry = null;
                    user.expiryDate = null;
                    user.status = 'active';
                    user.plan = user.plan === 'bootcamp' ? '365' : user.plan; // Upgrade from bootcamp to yearly
                } else if (newPaymentStatus === 'bootcamp') {
                    // Bootcamp: 7 days from now
                    const bootcampExpiry = new Date();
                    bootcampExpiry.setDate(bootcampExpiry.getDate() + 7);
                    user.expiry = bootcampExpiry.toISOString().split('T')[0];
                    user.expiryDate = bootcampExpiry.toISOString().split('T')[0];
                    user.status = 'bootcamp';
                    user.plan = 'bootcamp';
                    user.bootcampStartDate = new Date().toISOString().split('T')[0];
                }
                
                // Update in both storage locations
                localStorage.setItem('brainwave_users', JSON.stringify(users));
                localStorage.setItem('users', JSON.stringify(users));
                
                // Force reload users from storage to ensure fresh data
                const updatedUsers = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
                updateUsersTable(updatedUsers);
                updateSubscriptionTable(updatedUsers);
                
                console.log(` Payment status updated for user ${userId} to ${newPaymentStatus}`);
                console.log(` Expiry date set to: ${user.expiry || 'No expiry (Paid member)'}`);
            }
        }
        
        function editUserPlan(userId, newPlan) {
            if (window.adminDashboard && window.adminDashboard.editUserPlan) {
                window.adminDashboard.editUserPlan(userId, newPlan);
            } else {
                // Fallback implementation
                let users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
                const userIndex = users.findIndex(u => u.id == userId);
                if (userIndex !== -1) {
                    const user = users[userIndex];
                    const oldPlan = user.plan;
                    
                    // Track plan changes
                    if (!user.planHistory) {
                        user.planHistory = [];
                    }
                    
                    user.planHistory.push({
                        from: oldPlan,
                        to: newPlan,
                        changedAt: new Date().toISOString(),
                        changedBy: 'admin'
                    });
                    
                    user.plan = newPlan;
                    
                    // Update status and expiry based on plan
                    if (newPlan === 'bootcamp') {
                        user.status = 'bootcamp';
                        user.paymentStatus = 'bootcamp';
                        user.isPaid = false;
                        // Set bootcamp expiry to 7 days from now
                        const bootcampExpiry = new Date();
                        bootcampExpiry.setDate(bootcampExpiry.getDate() + 7);
                        user.expiry = bootcampExpiry.toISOString().split('T')[0];
                        user.expiryDate = bootcampExpiry.toISOString().split('T')[0];
                        if (!user.bootcampStartDate) {
                            user.bootcampStartDate = new Date().toISOString().split('T')[0];
                        }
                    } else {
                        user.status = 'active';
                        const days = parseInt(newPlan);
                        const date = new Date();
                        date.setDate(date.getDate() + days);
                        user.expiry = date.toISOString().split('T')[0];
                        user.expiryDate = date.toISOString().split('T')[0];
                        user.bootcampStartDate = null;
                    }
                    
                    // Update both storage locations
                    localStorage.setItem('users', JSON.stringify(users));
                    localStorage.setItem('brainwave_users', JSON.stringify(users));
                    
                    // Force reload users from storage to ensure fresh data
                    const updatedUsers = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
                    updateUsersTable(updatedUsers);
                    updateSubscriptionTable(updatedUsers);
                    
                    console.log(` Plan changed for user ${userId}:`, {
                        oldPlan: oldPlan,
                        newPlan: newPlan,
                        expiry: user.expiry,
                        expiryDate: user.expiryDate
                    });
                    
                    alert(`Plan changed from ${oldPlan === 'bootcamp' ? '7-Day Bootcamp' : oldPlan + '-Day Plan'} to ${newPlan === 'bootcamp' ? '7-Day Bootcamp' : newPlan + '-Day Plan'}!\nExpiry date: ${user.expiry}`);
                }
            }
        }
        
        function editUserExpiry(userId, newExpiry) {
            if (window.adminDashboard && window.adminDashboard.editUserExpiry) {
                window.adminDashboard.editUserExpiry(userId, newExpiry);
            } else {
                // Fallback implementation
                let users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
                const userIndex = users.findIndex(u => u.id == userId);
                if (userIndex !== -1) {
                    const user = users[userIndex];
                    user.expiry = newExpiry;
                    user.expiryDate = newExpiry;
                    
                    // Update status based on expiry
                    const today = new Date().toISOString().split('T')[0];
                    if (newExpiry && newExpiry < today) {
                        user.status = 'expired';
                    } else if (user.plan !== 'bootcamp') {
                        user.status = 'active';
                    }
                    
                    // Update both storage locations
                    localStorage.setItem('users', JSON.stringify(users));
                    localStorage.setItem('brainwave_users', JSON.stringify(users));
                    updateUsersTable(users);
                    updateSubscriptionTable(users);
                    alert('Expiry date updated successfully!');
                }
            }
        }
        
        function editUserPlanType(userId, newPlanType) {
            if (window.adminDashboard && window.adminDashboard.editUserPlanType) {
                window.adminDashboard.editUserPlanType(userId, newPlanType);
            } else {
                // Fallback implementation
                let users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
                const userIndex = users.findIndex(u => u.id == userId);
                if (userIndex !== -1) {
                    users[userIndex].planType = newPlanType;
                    localStorage.setItem('users', JSON.stringify(users));
                    localStorage.setItem('brainwave_users', JSON.stringify(users));
                    updateUsersTable(users);
                    updateSubscriptionTable(users);
                    alert(`Plan type updated to ${newPlanType} successfully!`);
                }
            }
        }
        
        function toggleUserLock(userId) {
            if (window.adminDashboard && window.adminDashboard.toggleUserLock) {
                window.adminDashboard.toggleUserLock(userId);
            } else {
                // Fallback implementation
                let users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
                const userIndex = users.findIndex(u => u.id == userId);
                if (userIndex !== -1) {
                    users[userIndex].locked = !users[userIndex].locked;
                    users[userIndex].accountLocked = users[userIndex].locked;
                    localStorage.setItem('users', JSON.stringify(users));
                    localStorage.setItem('brainwave_users', JSON.stringify(users));
                    updateUsersTable(users);
                    updateSubscriptionTable(users);
                    alert(`Account ${users[userIndex].locked ? 'locked' : 'unlocked'} successfully!`);
                }
            }
        }
        
        function deleteUser(userId) {
            if (window.adminDashboard && window.adminDashboard.deleteUser) {
                window.adminDashboard.deleteUser(userId);
            } else {
                // Fallback implementation
                let users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
                const user = users.find(u => u.id == userId);
                if (user && confirm(`Are you sure you want to delete ${user.name}?`)) {
                    users = users.filter(u => u.id != userId);
                    localStorage.setItem('users', JSON.stringify(users));
                    localStorage.setItem('brainwave_users', JSON.stringify(users));
                    updateUsersTable(users);
                    updateSubscriptionTable(users);
                    alert('User deleted successfully!');
                }
            }
        }
        
        function viewPlanHistory(userId) {
            if (window.adminDashboard && window.adminDashboard.viewPlanHistory) {
                window.adminDashboard.viewPlanHistory(userId);
            } else {
                // Fallback implementation
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const user = users.find(u => u.id === userId);
                if (user) {
                    const planHistory = user.planHistory || [];
                    let historyText = `Plan History for ${user.name}:\n\n`;
                    
                    if (planHistory.length === 0) {
                        historyText += 'No plan changes recorded.';
                    } else {
                        planHistory.forEach((change, index) => {
                            const fromPlan = change.from === null ? 'New User' : 
                                           change.from === 'bootcamp' ? '7-Day Bootcamp' : `${change.from}-Day Plan`;
                            const toPlan = change.to === 'bootcamp' ? '7-Day Bootcamp' : `${change.to}-Day Plan`;
                            const date = new Date(change.changedAt).toLocaleString();
                            
                            historyText += `${index + 1}. ${fromPlan}  ${toPlan}\n`;
                            historyText += `   Date: ${date}\n`;
                            historyText += `   Changed by: ${change.changedBy}\n\n`;
                        });
                    }
                    
                    alert(historyText);
                }
            }
        }
        

        // Sync users function - syncs from signup to both Users and Subscription sections
        function syncUsers() {
            console.log(' syncUsers() called - Syncing from signup to dashboard');
            
            // Get users from signup localStorage (key: 'users')
            const signupUsers = JSON.parse(localStorage.getItem('users') || '[]');
            console.log(' Found', signupUsers.length, 'users from signup');
            
            // Get existing dashboard users (key: 'brainwave_users')
            let dashboardUsers = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
            console.log(' Existing dashboard users:', dashboardUsers.length);
            
            // Merge users - add new ones from signup
            let addedCount = 0;
            signupUsers.forEach(signupUser => {
                // Check if user already exists in dashboard
                const exists = dashboardUsers.find(u => u.email === signupUser.email);
                
                if (!exists) {
                    // Add new user to dashboard
                    dashboardUsers.push(signupUser);
                    addedCount++;
                    console.log(' Added new user:', signupUser.name, signupUser.email);
                }
            });
            
            // Save merged users to dashboard localStorage
            localStorage.setItem('brainwave_users', JSON.stringify(dashboardUsers));
            console.log(' Synced! Added', addedCount, 'new users. Total:', dashboardUsers.length);
            
            // Update both tables
            return forceUpdateTable();
        }


        // Force immediate table update
        function forceUpdateTable() {
            const users = JSON.parse(localStorage.getItem('brainwave_users') || '[]');
            console.log(' Force updating tables with', users.length, 'users');
            
            // Update admin dashboard object
            if (window.adminDashboard) {
                window.adminDashboard.users = users;
                if (window.adminDashboard.renderUsers) {
                    window.adminDashboard.renderUsers();
                }
            }
            
            // Update Users section table
            updateUsersTable(users);
            
            // Update Subscription Management table
            const subscriptionTableBody = document.getElementById('subscription-table-body');
            if (subscriptionTableBody) {
                updateSubscriptionTable(users);
                console.log(' Subscription table updated');
            }
            
            return users;
        }
        
        // Update subscription table
        function updateSubscriptionTable(users) {
            const tbody = document.getElementById('subscription-table-body');
            if (!tbody) return;
            
            if (users.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" style="padding: 3rem; text-align: center; color: var(--text-secondary);">
                            <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 0.5rem; display: block; color: var(--border-color);"></i>
                            No users found. Click "Sync Users" to load users from signups.
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = users.map(user => createUserRowHTML(user)).join('');
            console.log(' Subscription table rendered with', users.length, 'users');
        }

        // Manual refresh function
        function refreshUsersTable() {
            // Show feedback immediately
            const refreshBtn = document.querySelector('button[onclick="refreshUsersTable()"]');
            const originalHTML = refreshBtn.innerHTML;
            refreshBtn.innerHTML = '<i class="fas fa-sync-alt fa-spin"></i> Syncing...';
            refreshBtn.disabled = true;
            
            // Get counts before sync
            const beforeCount = JSON.parse(localStorage.getItem('brainwave_users') || '[]').length;
            
            // Perform sync
            const users = syncUsers();
            const afterCount = users.length;
            const addedCount = afterCount - beforeCount;
            
            setTimeout(() => {
                if (addedCount > 0) {
                    refreshBtn.innerHTML = `<i class="fas fa-check"></i> Added ${addedCount} user${addedCount > 1 ? 's' : ''}`;
                } else {
                    refreshBtn.innerHTML = '<i class="fas fa-check"></i> Already up to date';
                }
                refreshBtn.style.background = '#10b981';
                
                setTimeout(() => {
                    refreshBtn.innerHTML = originalHTML;
                    refreshBtn.style.background = '';
                    refreshBtn.disabled = false;
                }, 2000);
            }, 500);
            
            console.log(' Users synced:', addedCount, 'new users added. Total:', users.length);
        }

        // Filter functionality
        function filterUsers() {
            if (window.adminDashboard && window.adminDashboard.filterUsers) {
                window.adminDashboard.filterUsers();
            } else {
                // Fallback implementation
                const searchTerm = document.getElementById('users-search').value.toLowerCase();
                const statusFilter = document.getElementById('users-status-filter').value;
                const planFilter = document.getElementById('users-plan-filter').value;
                
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                
                const filtered = users.filter(user => {
                    const matchesSearch = !searchTerm || 
                                        user.name.toLowerCase().includes(searchTerm) || 
                                        user.email.toLowerCase().includes(searchTerm);
                    
                    const matchesStatus = !statusFilter || 
                                        (statusFilter === 'bootcamp' && user.status === 'bootcamp') ||
                                        (statusFilter === 'active' && user.status === 'active') ||
                                        (statusFilter === 'expired' && (user.status === 'expired' || user.locked));
                    
                    const matchesPlan = !planFilter || 
                                      (planFilter === 'none' && user.plan === 'bootcamp') ||
                                      (user.plan && user.plan.toString() === planFilter);
                    
                    return matchesSearch && matchesStatus && matchesPlan;
                });
                
                updateUsersTable(filtered);
            }
        }

        // Load and display existing users on page load
        window.addEventListener('load', function() {
            // Immediate update
            forceUpdateTable();
            
            // Wait a bit for the page to fully load and update again
            setTimeout(() => {
                const users = forceUpdateTable();
                console.log('Admin dashboard loaded, force updated users:', users);
                lastUserCount = users.length;
            }, 500);
        });
        
        // Listen for storage changes (new signups from other tabs/windows)
        window.addEventListener('storage', function(e) {
            if (e.key === 'users') {
                const users = JSON.parse(e.newValue || '[]');
                updateUsersTable(users);
                console.log('Users table updated due to new signup');
            }
        });
        
        // Store the last known user count
        let lastUserCount = 0;
        
        // Listen for navigation to settings section
        document.addEventListener('click', function(e) {
            if (e.target.closest('[data-page="settings"]')) {
                console.log('Navigating to settings section');
                setTimeout(() => {
                    const users = syncUsers();
                    console.log('Settings section loaded, synced users:', users.length);
                }, 100);
            }
        });

        // Periodically sync users (in case storage event doesn't fire)
        setInterval(function() {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const currentUserCount = users.length;
            
            // If user count changed, sync users
            if (currentUserCount !== lastUserCount) {
                console.log('User count changed from', lastUserCount, 'to', currentUserCount);
                syncUsers();
                lastUserCount = currentUserCount;
                console.log('Users auto-synced - found new users');
            }
        }, 2000); // Check every 2 seconds
    </script>
    
    <!-- Direct Tab Switching Fix -->
    <script>
        console.log(' Tab Switch Fix Loading...');
        
        // Override onclick handlers with direct event listeners
        window.addEventListener('DOMContentLoaded', function() {
            const tabButtons = document.querySelectorAll('.content-tab-btn');
            console.log('Found', tabButtons.length, 'tab buttons');
            
            tabButtons.forEach((btn) => {
                // Remove onclick attribute
                btn.removeAttribute('onclick');
                
                // Add direct click handler
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const isVideosTab = this.textContent.toLowerCase().includes('video');
                    const tab = isVideosTab ? 'videos' : 'books';
                    
                    console.log(' Clicked tab:', tab);
                    
                    // Hide all tabs
                    document.querySelectorAll('.content-tab-content').forEach(content => {
                        content.style.display = 'none';
                        content.classList.remove('active');
                    });
                    
                    // Reset all buttons
                    document.querySelectorAll('.content-tab-btn').forEach(b => {
                        b.classList.remove('active');
                        b.style.background = 'none';
                        b.style.color = 'var(--text-secondary)';
                        b.style.boxShadow = 'none';
                    });
                    
                    // Show clicked tab
                    const tabContent = document.getElementById(tab + '-content-tab');
                    if (tabContent) {
                        tabContent.style.display = 'block';
                        tabContent.classList.add('active');
                        console.log(' Showing tab:', tab);
                    } else {
                        console.error(' Tab content not found:', tab + '-content-tab');
                    }
                    
                    // Activate clicked button
                    this.classList.add('active');
                    this.style.background = 'var(--primary-gradient)';
                    this.style.color = 'var(--white)';
                    this.style.boxShadow = 'var(--shadow-sm)';
                });
            });
            
            console.log(' Tab switching ready!');
        });
    </script>
    
    <!-- EMERGENCY FALLBACK FOR ASSESSMENT MODAL BUTTONS -->
    <script>
        console.log(' Loading emergency fallback for assessment buttons...');
        
        // Direct fallback function that doesn't rely on AdminDashboard
        window.openAssessmentModalFallback = function(type) {
            console.log(' FALLBACK: Opening assessment modal for:', type);
            
            const modal = document.getElementById('assessment-modal');
            const modalTitle = document.getElementById('assessment-modal-title');
            const assessmentType = document.getElementById('assessment-type');
            const form = document.getElementById('assessment-form');
            const questionsContainer = document.getElementById('questions-container');
            
            if (!modal) {
                alert('Error: Modal not found in HTML!');
                console.error(' assessment-modal element not found');
                return;
            }
            
            const titles = {
                quiz: 'Create Quiz',
                assignment: 'Create Assignment',
                exam: 'Create Mock Exam'
            };
            
            // Show modal
            modal.classList.add('active');
            modal.style.display = 'flex';
            modal.style.alignItems = 'center';
            modal.style.justifyContent = 'center';
            modal.style.position = 'fixed';
            modal.style.top = '0';
            modal.style.left = '0';
            modal.style.width = '100%';
            modal.style.height = '100%';
            modal.style.background = 'rgba(0, 0, 0, 0.5)';
            modal.style.zIndex = '10000';
            
            if (modalTitle) modalTitle.textContent = titles[type] || 'Create Assessment';
            if (assessmentType) assessmentType.value = type;
            if (form) form.reset();
            if (questionsContainer) {
                questionsContainer.innerHTML = '<p style="text-align: center; color: var(--text-secondary); margin: 0;">No questions added yet. Click "Add Question" to start.</p>';
            }
            
            console.log(' FALLBACK: Modal opened successfully');
        };
        
        // Override the global function to use fallback if AdminDashboard not ready
        const originalOpenAssessmentModal = window.openAssessmentModal;
        window.openAssessmentModal = function(type) {
            console.log(' openAssessmentModal called for:', type);
            
            if (window.adminDashboard && typeof window.adminDashboard.openAssessmentModal === 'function') {
                console.log(' Using AdminDashboard method');
                window.adminDashboard.openAssessmentModal(type);
            } else {
                console.warn(' AdminDashboard not ready, using fallback');
                window.openAssessmentModalFallback(type);
            }
        };
        
        // Ensure function is available immediately
        console.log(' Emergency fallback loaded and ready');
        console.log(' openAssessmentModal type:', typeof window.openAssessmentModal);
    </script>
</body>
</html>